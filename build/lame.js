function lamejs(){function P(d){return new Int32Array(d)}function G(d){return new Float32Array(d)}function V(d){if(1==d.length)return G(d[0]);var l=d[0];d=d.slice(1);for(var t=[],v=0;v<l;v++)t.push(V(d));return t}function Ba(d){if(1==d.length)return P(d[0]);var l=d[0];d=d.slice(1);for(var t=[],v=0;v<l;v++)t.push(Ba(d));return t}function ma(d){if(1==d.length)return new Int16Array(d[0]);var l=d[0];d=d.slice(1);for(var t=[],v=0;v<l;v++)t.push(ma(d));return t}function Nb(d){if(1==d.length)return Array(d[0]);
var l=d[0];d=d.slice(1);for(var t=[],v=0;v<l;v++)t.push(Nb(d));return t}function ya(d){this.ordinal=d}function C(d){this.ordinal=d}function da(d){this.ordinal=function(){return d}}function kc(){this.getLameVersion=function(){return"3.98.4"};this.getLameShortVersion=function(){return"3.98.4"};this.getLameVeryShortVersion=function(){return"LAME3.98r"};this.getPsyVersion=function(){return"0.93"};this.getLameUrl=function(){return"http://www.mp3dev.org/"};this.getLameOsBitness=function(){return"32bits"}}
function cb(){function v(a){this.bits=0|a}function l(a,c,n,b,e,h){c=.5946/c;for(a>>=1;0!=a--;)e[h++]=c>n[b++]?0:1,e[h++]=c>n[b++]?0:1}function t(a,c,n,b,e,h){a>>=1;var g=a%2;for(a>>=1;0!=a--;){var p=n[b++]*c;var x=n[b++]*c;var k=0|p;var f=n[b++]*c;var I=0|x;var d=n[b++]*c;var E=0|f;p+=B.adj43[k];k=0|d;x+=B.adj43[I];e[h++]=0|p;f+=B.adj43[E];e[h++]=0|x;d+=B.adj43[k];e[h++]=0|f;e[h++]=0|d}0!=g&&(p=n[b++]*c,x=n[b++]*c,p+=B.adj43[0|p],x+=B.adj43[0|x],e[h++]=0|p,e[h++]=0|x)}function W(a,c,b,e){var n,p=
c,g=n=0;do{var h=a[p++],k=a[p++];n<h&&(n=h);g<k&&(g=k)}while(p<b);n<g&&(n=g);switch(n){case 0:return n;case 1:p=c;c=0;n=w.ht[1].hlen;do g=2*a[p+0]+a[p+1],p+=2,c+=n[g];while(p<b);e.bits+=c;return 1;case 2:case 3:p=c;c=f[n-1];n=0;g=w.ht[c].xlen;h=2==c?w.table23:w.table56;do k=a[p+0]*g+a[p+1],p+=2,n+=h[k];while(p<b);a=n&65535;n>>=16;n>a&&(n=a,c++);e.bits+=n;return c;case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:p=c;c=f[n-1];h=g=n=0;k=w.ht[c].xlen;var d=w.ht[c].hlen,
E=w.ht[c+1].hlen,q=w.ht[c+2].hlen;do{var m=a[p+0]*k+a[p+1];p+=2;n+=d[m];g+=E[m];h+=q[m]}while(p<b);a=c;n>g&&(n=g,a++);n>h&&(n=h,a=c+2);e.bits+=n;return a;default:if(n>oa.IXMAX_VAL)return e.bits=oa.LARGE_BITS,-1;n-=15;for(p=24;32>p&&!(w.ht[p].linmax>=n);p++);for(g=p-8;24>g&&!(w.ht[g].linmax>=n);g++);n=g;h=65536*w.ht[n].xlen+w.ht[p].xlen;g=0;do k=a[c++],d=a[c++],0!=k&&(14<k&&(k=15,g+=h),k*=16),0!=d&&(14<d&&(d=15,g+=h),k+=d),g+=w.largetbl[k];while(c<b);a=g&65535;g>>=16;g>a&&(g=a,n=p);e.bits+=g;return n}}
function F(a,c,n,b,e,h,g,k){for(var p=c.big_values,x=2;x<d.SBMAX_l+1;x++){var f=a.scalefac_band.l[x];if(f>=p)break;var u=e[x-2]+c.count1bits;if(n.part2_3_length<=u)break;u=new v(u);f=W(b,f,p,u);u=u.bits;n.part2_3_length<=u||(n.assign(c),n.part2_3_length=u,n.region0_count=h[x-2],n.region1_count=x-2-h[x-2],n.table_select[0]=g[x-2],n.table_select[1]=k[x-2],n.table_select[2]=f)}}var B=null;this.qupvt=null;this.setModules=function(a){B=this.qupvt=a};var fa=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,
1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]],f=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];this.noquant_count_bits=function(a,c,n){var b=c.l3_enc,e=Math.min(576,c.max_nonzero_coeff+2>>1<<1);null!=n&&(n.sfb_count1=0);for(;1<e&&0==(b[e-1]|b[e-2]);e-=2);c.count1=e;for(var h=0,g=0;3<e&&!(1<((b[e-1]|b[e-2]|b[e-3]|b[e-4])&2147483647));e-=4){var k=2*(2*(2*b[e-4]+b[e-3])+b[e-2])+b[e-1];h+=w.t32l[k];g+=w.t33l[k]}k=h;c.count1table_select=0;h>g&&(k=g,c.count1table_select=
1);c.count1bits=k;c.big_values=e;if(0==e)return k;c.block_type==d.SHORT_TYPE?(h=3*a.scalefac_band.s[3],h>c.big_values&&(h=c.big_values),g=c.big_values):c.block_type==d.NORM_TYPE?(h=c.region0_count=a.bv_scf[e-2],g=c.region1_count=a.bv_scf[e-1],g=a.scalefac_band.l[h+g+2],h=a.scalefac_band.l[h+1],g<e&&(k=new v(k),c.table_select[2]=W(b,g,e,k),k=k.bits)):(c.region0_count=7,c.region1_count=d.SBMAX_l-1-7-1,h=a.scalefac_band.l[8],g=e,h>g&&(h=g));h=Math.min(h,e);g=Math.min(g,e);0<h&&(k=new v(k),c.table_select[0]=
W(b,0,h,k),k=k.bits);h<g&&(k=new v(k),c.table_select[1]=W(b,h,g,k),k=k.bits);2==a.use_best_huffman&&(c.part2_3_length=k,best_huffman_divide(a,c),k=c.part2_3_length);if(null!=n&&c.block_type==d.NORM_TYPE){for(b=0;a.scalefac_band.l[b]<c.big_values;)b++;n.sfb_count1=b}return k};this.count_bits=function(a,c,b,e){var n=b.l3_enc,h=oa.IXMAX_VAL/B.IPOW20(b.global_gain);if(b.xrpow_max>h)return oa.LARGE_BITS;h=B.IPOW20(b.global_gain);var g,k=0,p=0,f=0,q=0,m=0,E=n,r=0,D=c,H=0;var M=null!=e&&b.global_gain==e.global_gain;
var Q=b.block_type==d.SHORT_TYPE?38:21;for(g=0;g<=Q;g++){var z=-1;if(M||b.block_type==d.NORM_TYPE)z=b.global_gain-(b.scalefac[g]+(0!=b.preflag?B.pretab[g]:0)<<b.scalefac_scale+1)-8*b.subblock_gain[b.window[g]];if(M&&e.step[g]==z)0!=p&&(t(p,h,D,H,E,r),p=0),0!=f&&(l(f,h,D,H,E,r),f=0);else{var J=b.width[g];k+b.width[g]>b.max_nonzero_coeff&&(g=b.max_nonzero_coeff-k+1,La.fill(n,b.max_nonzero_coeff,576,0),J=g,0>J&&(J=0),g=Q+1);0==p&&0==f&&(E=n,r=m,D=c,H=q);null!=e&&0<e.sfb_count1&&g>=e.sfb_count1&&0<e.step[g]&&
z>=e.step[g]?(0!=p&&(t(p,h,D,H,E,r),p=0,E=n,r=m,D=c,H=q),f+=J):(0!=f&&(l(f,h,D,H,E,r),f=0,E=n,r=m,D=c,H=q),p+=J);if(0>=J){0!=f&&(l(f,h,D,H,E,r),f=0);0!=p&&(t(p,h,D,H,E,r),p=0);break}}g<=Q&&(m+=b.width[g],q+=b.width[g],k+=b.width[g])}0!=p&&t(p,h,D,H,E,r);0!=f&&l(f,h,D,H,E,r);if(0!=(a.substep_shaping&2))for(h=0,Q=.634521682242439/B.IPOW20(b.global_gain+b.scalefac_scale),k=0;k<b.sfbmax;k++)if(M=b.width[k],0==a.pseudohalf[k])h+=M;else for(p=h,h+=M;p<h;++p)n[p]=c[p]>=Q?n[p]:0;return this.noquant_count_bits(a,
b,e)};this.best_huffman_divide=function(a,c){var b=new rb,e=c.l3_enc,h=P(23),k=P(23),g=P(23),f=P(23);if(c.block_type!=d.SHORT_TYPE||1!=a.mode_gr){b.assign(c);if(c.block_type==d.NORM_TYPE){for(var y=c.big_values,q=0;22>=q;q++)h[q]=oa.LARGE_BITS;for(q=0;16>q;q++){var m=a.scalefac_band.l[q+1];if(m>=y)break;var E=0,r=new v(E),l=W(e,0,m,r);E=r.bits;for(var D=0;8>D;D++){var H=a.scalefac_band.l[q+D+2];if(H>=y)break;r=E;r=new v(r);H=W(e,m,H,r);r=r.bits;h[q+D]>r&&(h[q+D]=r,k[q+D]=q,g[q+D]=l,f[q+D]=H)}}F(a,
b,c,e,h,k,g,f)}y=b.big_values;if(!(0==y||1<(e[y-2]|e[y-1])||(y=c.count1+2,576<y))){b.assign(c);b.count1=y;for(m=q=0;y>b.big_values;y-=4)E=2*(2*(2*e[y-4]+e[y-3])+e[y-2])+e[y-1],q+=w.t32l[E],m+=w.t33l[E];b.big_values=y;b.count1table_select=0;q>m&&(q=m,b.count1table_select=1);b.count1bits=q;b.block_type==d.NORM_TYPE?F(a,b,c,e,h,k,g,f):(b.part2_3_length=q,q=a.scalefac_band.l[8],q>y&&(q=y),0<q&&(h=new v(b.part2_3_length),b.table_select[0]=W(e,0,q,h),b.part2_3_length=h.bits),y>q&&(h=new v(b.part2_3_length),
b.table_select[1]=W(e,q,y,h),b.part2_3_length=h.bits),c.part2_3_length>b.part2_3_length&&c.assign(b))}}};var b=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],q=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],a=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],m=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];cb.slen1_tab=a;cb.slen2_tab=m;this.best_scalefac_store=function(c,e,h,k){var n=k.tt[e][h],p,g,f=0;for(p=g=0;p<n.sfbmax;p++){var y=n.width[p];g+=y;for(y=-y;0>y&&0==n.l3_enc[y+g];y++);0==y&&(n.scalefac[p]=f=-2)}if(0==n.scalefac_scale&&0==n.preflag){for(p=
g=0;p<n.sfbmax;p++)0<n.scalefac[p]&&(g|=n.scalefac[p]);if(0==(g&1)&&0!=g){for(p=0;p<n.sfbmax;p++)0<n.scalefac[p]&&(n.scalefac[p]>>=1);n.scalefac_scale=f=1}}if(0==n.preflag&&n.block_type!=d.SHORT_TYPE&&2==c.mode_gr){for(p=11;p<d.SBPSY_l&&!(n.scalefac[p]<B.pretab[p]&&-2!=n.scalefac[p]);p++);if(p==d.SBPSY_l){for(p=11;p<d.SBPSY_l;p++)0<n.scalefac[p]&&(n.scalefac[p]-=B.pretab[p]);n.preflag=f=1}}for(p=0;4>p;p++)k.scfsi[h][p]=0;if(2==c.mode_gr&&1==e&&k.tt[0][h].block_type!=d.SHORT_TYPE&&k.tt[1][h].block_type!=
d.SHORT_TYPE){e=k.tt[1][h];g=k.tt[0][h];for(f=0;f<w.scfsi_band.length-1;f++){for(p=w.scfsi_band[f];p<w.scfsi_band[f+1]&&!(g.scalefac[p]!=e.scalefac[p]&&0<=e.scalefac[p]);p++);if(p==w.scfsi_band[f+1]){for(p=w.scfsi_band[f];p<w.scfsi_band[f+1];p++)e.scalefac[p]=-1;k.scfsi[h][f]=1}}for(p=k=h=0;11>p;p++)-1!=e.scalefac[p]&&(k++,h<e.scalefac[p]&&(h=e.scalefac[p]));for(y=g=0;p<d.SBPSY_l;p++)-1!=e.scalefac[p]&&(y++,g<e.scalefac[p]&&(g=e.scalefac[p]));for(f=0;16>f;f++)h<b[f]&&g<q[f]&&(p=a[f]*k+m[f]*y,e.part2_length>
p&&(e.part2_length=p,e.scalefac_compress=f));f=0}for(p=0;p<n.sfbmax;p++)-2==n.scalefac[p]&&(n.scalefac[p]=0);0!=f&&(2==c.mode_gr?this.scale_bitcount(n):this.scale_bitcount_lsf(c,n))};var z=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],e=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],h=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(a){var c,n=0,p=0,k=a.scalefac;if(a.block_type==d.SHORT_TYPE){var f=z;0!=a.mixed_block_flag&&(f=e)}else if(f=h,0==a.preflag){for(c=
11;c<d.SBPSY_l&&!(k[c]<B.pretab[c]);c++);if(c==d.SBPSY_l)for(a.preflag=1,c=11;c<d.SBPSY_l;c++)k[c]-=B.pretab[c]}for(c=0;c<a.sfbdivide;c++)n<k[c]&&(n=k[c]);for(;c<a.sfbmax;c++)p<k[c]&&(p=k[c]);a.part2_length=oa.LARGE_BITS;for(c=0;16>c;c++)n<b[c]&&p<q[c]&&a.part2_length>f[c]&&(a.part2_length=f[c],a.scalefac_compress=c);return a.part2_length==oa.LARGE_BITS};var c=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(a,b){var e,h,f,q,g=P(4),u=b.scalefac;
var y=0!=b.preflag?2:0;for(f=0;4>f;f++)g[f]=0;if(b.block_type==d.SHORT_TYPE){var m=1;var r=B.nr_of_sfb_block[y][m];for(e=q=0;4>e;e++){var E=r[e]/3;for(f=0;f<E;f++,q++)for(h=0;3>h;h++)u[3*q+h]>g[e]&&(g[e]=u[3*q+h])}}else for(m=0,r=B.nr_of_sfb_block[y][m],e=q=0;4>e;e++)for(E=r[e],f=0;f<E;f++,q++)u[q]>g[e]&&(g[e]=u[q]);E=!1;for(e=0;4>e;e++)g[e]>c[y][e]&&(E=!0);if(!E){b.sfb_partition_table=B.nr_of_sfb_block[y][m];for(e=0;4>e;e++)b.slen[e]=k[g[e]];m=b.slen[0];e=b.slen[1];g=b.slen[2];h=b.slen[3];switch(y){case 0:b.scalefac_compress=
(5*m+e<<4)+(g<<2)+h;break;case 1:b.scalefac_compress=400+(5*m+e<<2)+g;break;case 2:b.scalefac_compress=500+3*m+e;break;default:U.err.printf("intensity stereo not implemented yet\n")}}if(!E)for(e=b.part2_length=0;4>e;e++)b.part2_length+=b.slen[e]*b.sfb_partition_table[e];return E};var k=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(a){for(var c=2;576>=c;c+=2){for(var e=0,b;a.scalefac_band.l[++e]<c;);for(b=fa[e][0];a.scalefac_band.l[b+1]>c;)b--;0>b&&(b=fa[e][0]);a.bv_scf[c-2]=b;for(b=
fa[e][1];a.scalefac_band.l[b+a.bv_scf[c-2]+2]>c;)b--;0>b&&(b=fa[e][1]);a.bv_scf[c-1]=b}}}function ca(){function d(f,b,d,a,m,l){for(;0!=m--;)d[a]=1E-10+f[b+0]*l[0]-d[a-1]*l[1]+f[b-1]*l[2]-d[a-2]*l[3]+f[b-2]*l[4]-d[a-3]*l[5]+f[b-3]*l[6]-d[a-4]*l[7]+f[b-4]*l[8]-d[a-5]*l[9]+f[b-5]*l[10]-d[a-6]*l[11]+f[b-6]*l[12]-d[a-7]*l[13]+f[b-7]*l[14]-d[a-8]*l[15]+f[b-8]*l[16]-d[a-9]*l[17]+f[b-9]*l[18]-d[a-10]*l[19]+f[b-10]*l[20],++a,++b}function l(f,b,d,a,m,l){for(;0!=m--;)d[a]=f[b+0]*l[0]-d[a-1]*l[1]+f[b-1]*l[2]-
d[a-2]*l[3]+f[b-2]*l[4],++a,++b}function t(f){return f*f}var W=ca.RMS_WINDOW_TIME_NUMERATOR,F=ca.RMS_WINDOW_TIME_DENOMINATOR,B=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9.291677959E-5,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,1.2025322027E-4,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,
-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,
1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-8.28086748E-6,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],
[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,
-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,
-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,
.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],w=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,
.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];this.InitGainAnalysis=function(f,b){var d;
a:{for(d=0;d<MAX_ORDER;d++)f.linprebuf[d]=f.lstepbuf[d]=f.loutbuf[d]=f.rinprebuf[d]=f.rstepbuf[d]=f.routbuf[d]=0;switch(0|b){case 48E3:f.reqindex=0;break;case 44100:f.reqindex=1;break;case 32E3:f.reqindex=2;break;case 24E3:f.reqindex=3;break;case 22050:f.reqindex=4;break;case 16E3:f.reqindex=5;break;case 12E3:f.reqindex=6;break;case 11025:f.reqindex=7;break;case 8E3:f.reqindex=8;break;default:d=INIT_GAIN_ANALYSIS_ERROR;break a}f.sampleWindow=0|(b*W+F-1)/F;f.lsum=0;f.rsum=0;f.totsamp=0;La.ill(f.A,
0);d=INIT_GAIN_ANALYSIS_OK}if(d!=INIT_GAIN_ANALYSIS_OK)return INIT_GAIN_ANALYSIS_ERROR;f.linpre=MAX_ORDER;f.rinpre=MAX_ORDER;f.lstep=MAX_ORDER;f.rstep=MAX_ORDER;f.lout=MAX_ORDER;f.rout=MAX_ORDER;La.fill(f.B,0);return INIT_GAIN_ANALYSIS_OK};this.AnalyzeSamples=function(f,b,q,a,m,z,e){if(0==z)return GAIN_ANALYSIS_OK;var h=0;var c=z;switch(e){case 1:a=b;m=q;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}z<MAX_ORDER?(U.arraycopy(b,q,f.linprebuf,MAX_ORDER,z),U.arraycopy(a,m,f.rinprebuf,MAX_ORDER,
z)):(U.arraycopy(b,q,f.linprebuf,MAX_ORDER,MAX_ORDER),U.arraycopy(a,m,f.rinprebuf,MAX_ORDER,MAX_ORDER));for(;0<c;){var k=c>f.sampleWindow-f.totsamp?f.sampleWindow-f.totsamp:c;if(h<MAX_ORDER){e=f.linpre+h;var r=f.linprebuf;var E=f.rinpre+h;var n=f.rinprebuf;k>MAX_ORDER-h&&(k=MAX_ORDER-h)}else e=q+h,r=b,E=m+h,n=a;d(r,e,f.lstepbuf,f.lstep+f.totsamp,k,B[f.reqindex]);d(n,E,f.rstepbuf,f.rstep+f.totsamp,k,B[f.reqindex]);l(f.lstepbuf,f.lstep+f.totsamp,f.loutbuf,f.lout+f.totsamp,k,w[f.reqindex]);l(f.rstepbuf,
f.rstep+f.totsamp,f.routbuf,f.rout+f.totsamp,k,w[f.reqindex]);e=f.lout+f.totsamp;r=f.loutbuf;E=f.rout+f.totsamp;n=f.routbuf;for(var p=k%8;0!=p--;)f.lsum+=t(r[e++]),f.rsum+=t(n[E++]);for(p=k/8;0!=p--;)f.lsum+=t(r[e+0])+t(r[e+1])+t(r[e+2])+t(r[e+3])+t(r[e+4])+t(r[e+5])+t(r[e+6])+t(r[e+7]),e+=8,f.rsum+=t(n[E+0])+t(n[E+1])+t(n[E+2])+t(n[E+3])+t(n[E+4])+t(n[E+5])+t(n[E+6])+t(n[E+7]),E+=8;c-=k;h+=k;f.totsamp+=k;f.totsamp==f.sampleWindow&&(e=10*ca.STEPS_per_dB*Math.log10((f.lsum+f.rsum)/f.totsamp*.5+1E-37),
e=0>=e?0:0|e,e>=f.A.length&&(e=f.A.length-1),f.A[e]++,f.lsum=f.rsum=0,U.arraycopy(f.loutbuf,f.totsamp,f.loutbuf,0,MAX_ORDER),U.arraycopy(f.routbuf,f.totsamp,f.routbuf,0,MAX_ORDER),U.arraycopy(f.lstepbuf,f.totsamp,f.lstepbuf,0,MAX_ORDER),U.arraycopy(f.rstepbuf,f.totsamp,f.rstepbuf,0,MAX_ORDER),f.totsamp=0);if(f.totsamp>f.sampleWindow)return GAIN_ANALYSIS_ERROR}z<MAX_ORDER?(U.arraycopy(f.linprebuf,z,f.linprebuf,0,MAX_ORDER-z),U.arraycopy(f.rinprebuf,z,f.rinprebuf,0,MAX_ORDER-z),U.arraycopy(b,q,f.linprebuf,
MAX_ORDER-z,z),U.arraycopy(a,m,f.rinprebuf,MAX_ORDER-z,z)):(U.arraycopy(b,q+z-MAX_ORDER,f.linprebuf,0,MAX_ORDER),U.arraycopy(a,m+z-MAX_ORDER,f.rinprebuf,0,MAX_ORDER));return GAIN_ANALYSIS_OK};this.GetTitleGain=function(f){var b=f.A;var d=f.A.length,a,m=0;for(a=0;a<d;a++)m+=b[a];if(0==m)b=GAIN_NOT_ENOUGH_SAMPLES;else{m=0|Math.ceil(m*(1-.95));for(a=d;0<a--&&!(0>=(m-=b[a])););b=64.82-a/ca.STEPS_per_dB}for(d=0;d<f.A.length;d++)f.B[d]+=f.A[d],f.A[d]=0;for(d=0;d<MAX_ORDER;d++)f.linprebuf[d]=f.lstepbuf[d]=
f.loutbuf[d]=f.rinprebuf[d]=f.rstepbuf[d]=f.routbuf[d]=0;f.totsamp=0;f.lsum=f.rsum=0;return b}}function xc(){function d(b,f,a,d,l,e,h,c,k,r,E,n,p,x,I){this.vbr_q=b;this.quant_comp=f;this.quant_comp_s=a;this.expY=d;this.st_lrm=l;this.st_s=e;this.masking_adj=h;this.masking_adj_short=c;this.ath_lower=k;this.ath_curve=r;this.ath_sensitivity=E;this.interch=n;this.safejoint=p;this.sfb21mod=x;this.msfix=I}function l(b,f,a,d,l,e,h,c,k,r,E,n,p,x){this.quant_comp=f;this.quant_comp_s=a;this.safejoint=d;this.nsmsfix=
l;this.st_lrm=e;this.st_s=h;this.nsbass=c;this.scale=k;this.masking_adj=r;this.ath_lower=E;this.ath_curve=n;this.interch=p;this.sfscale=x}function t(b,f,a){var d=b.VBR==C.vbr_rh?B:w,q=b.VBR_q_frac,e=d[f];d=d[f+1];e.st_lrm+=q*(d.st_lrm-e.st_lrm);e.st_s+=q*(d.st_s-e.st_s);e.masking_adj+=q*(d.masking_adj-e.masking_adj);e.masking_adj_short+=q*(d.masking_adj_short-e.masking_adj_short);e.ath_lower+=q*(d.ath_lower-e.ath_lower);e.ath_curve+=q*(d.ath_curve-e.ath_curve);e.ath_sensitivity+=q*(d.ath_sensitivity-
e.ath_sensitivity);e.interch+=q*(d.interch-e.interch);e.msfix+=q*(d.msfix-e.msfix);d=e.vbr_q;0>d&&(d=0);9<d&&(d=9);b.VBR_q=d;b.VBR_q_frac=0;0!=a?b.quant_comp=e.quant_comp:0<Math.abs(b.quant_comp- -1)||(b.quant_comp=e.quant_comp);0!=a?b.quant_comp_short=e.quant_comp_s:0<Math.abs(b.quant_comp_short- -1)||(b.quant_comp_short=e.quant_comp_s);0!=e.expY&&(b.experimentalY=0!=e.expY);0!=a?b.internal_flags.nsPsy.attackthre=e.st_lrm:0<Math.abs(b.internal_flags.nsPsy.attackthre- -1)||(b.internal_flags.nsPsy.attackthre=
e.st_lrm);0!=a?b.internal_flags.nsPsy.attackthre_s=e.st_s:0<Math.abs(b.internal_flags.nsPsy.attackthre_s- -1)||(b.internal_flags.nsPsy.attackthre_s=e.st_s);0!=a?b.maskingadjust=e.masking_adj:0<Math.abs(b.maskingadjust-0)||(b.maskingadjust=e.masking_adj);0!=a?b.maskingadjust_short=e.masking_adj_short:0<Math.abs(b.maskingadjust_short-0)||(b.maskingadjust_short=e.masking_adj_short);0!=a?b.ATHlower=-e.ath_lower/10:0<Math.abs(10*-b.ATHlower)||(b.ATHlower=-e.ath_lower/10);0!=a?b.ATHcurve=e.ath_curve:0<
Math.abs(b.ATHcurve- -1)||(b.ATHcurve=e.ath_curve);0!=a?b.athaa_sensitivity=e.ath_sensitivity:0<Math.abs(b.athaa_sensitivity- -1)||(b.athaa_sensitivity=e.ath_sensitivity);0<e.interch&&(0!=a?b.interChRatio=e.interch:0<Math.abs(b.interChRatio- -1)||(b.interChRatio=e.interch));0<e.safejoint&&(b.exp_nspsytune|=e.safejoint);0<e.sfb21mod&&(b.exp_nspsytune|=e.sfb21mod<<20);0!=a?b.msfix=e.msfix:0<Math.abs(b.msfix- -1)||(b.msfix=e.msfix);0==a&&(b.VBR_q=f,b.VBR_q_frac=q)}function W(b,d,a){var m=F.nearestBitrateFullIndex(d);
b.VBR=C.vbr_abr;b.VBR_mean_bitrate_kbps=d;b.VBR_mean_bitrate_kbps=Math.min(b.VBR_mean_bitrate_kbps,320);b.VBR_mean_bitrate_kbps=Math.max(b.VBR_mean_bitrate_kbps,8);b.brate=b.VBR_mean_bitrate_kbps;320<b.VBR_mean_bitrate_kbps&&(b.disable_reservoir=!0);0<f[m].safejoint&&(b.exp_nspsytune|=2);0<f[m].sfscale&&(b.internal_flags.noise_shaping=2);if(0<Math.abs(f[m].nsbass)){var q=int(4*f[m].nsbass);0>q&&(q+=64);b.exp_nspsytune|=q<<2}0!=a?b.quant_comp=f[m].quant_comp:0<Math.abs(b.quant_comp- -1)||(b.quant_comp=
f[m].quant_comp);0!=a?b.quant_comp_short=f[m].quant_comp_s:0<Math.abs(b.quant_comp_short- -1)||(b.quant_comp_short=f[m].quant_comp_s);0!=a?b.msfix=f[m].nsmsfix:0<Math.abs(b.msfix- -1)||(b.msfix=f[m].nsmsfix);0!=a?b.internal_flags.nsPsy.attackthre=f[m].st_lrm:0<Math.abs(b.internal_flags.nsPsy.attackthre- -1)||(b.internal_flags.nsPsy.attackthre=f[m].st_lrm);0!=a?b.internal_flags.nsPsy.attackthre_s=f[m].st_s:0<Math.abs(b.internal_flags.nsPsy.attackthre_s- -1)||(b.internal_flags.nsPsy.attackthre_s=f[m].st_s);
0!=a?b.scale=f[m].scale:0<Math.abs(b.scale- -1)||(b.scale=f[m].scale);0!=a?b.maskingadjust=f[m].masking_adj:0<Math.abs(b.maskingadjust-0)||(b.maskingadjust=f[m].masking_adj);0<f[m].masking_adj?0!=a?b.maskingadjust_short=.9*f[m].masking_adj:0<Math.abs(b.maskingadjust_short-0)||(b.maskingadjust_short=.9*f[m].masking_adj):0!=a?b.maskingadjust_short=1.1*f[m].masking_adj:0<Math.abs(b.maskingadjust_short-0)||(b.maskingadjust_short=1.1*f[m].masking_adj);0!=a?b.ATHlower=-f[m].ath_lower/10:0<Math.abs(10*-b.ATHlower)||
(b.ATHlower=-f[m].ath_lower/10);0!=a?b.ATHcurve=f[m].ath_curve:0<Math.abs(b.ATHcurve- -1)||(b.ATHcurve=f[m].ath_curve);0!=a?b.interChRatio=f[m].interch:0<Math.abs(b.interChRatio- -1)||(b.interChRatio=f[m].interch);return d}var F;this.setModules=function(b){F=b};var B=[new d(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new d(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new d(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new d(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new d(4,9,9,1,6,135,
-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new d(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2E-4,0,0,1.95),new d(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4E-4,0,0,2.3),new d(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6E-4,0,0,2.7),new d(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7E-4,0,0,0),new d(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8E-4,0,0,0),new d(10,9,9,1,6.6,145,2,2,-36,12,-25,8E-4,0,0,0)],w=[new d(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new d(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new d(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,
2,18,1.49),new d(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new d(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new d(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2E-4,0,0,1.95),new d(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4E-4,0,0,2),new d(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6E-4,0,0,2),new d(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7E-4,0,0,2),new d(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8E-4,0,0,2),new d(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8E-4,0,0,2)],f=[new l(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new l(16,9,9,0,0,6.6,
145,0,.95,0,-25,11,.001,1),new l(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new l(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new l(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9E-4,1),new l(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9E-4,1),new l(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8E-4,1),new l(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8E-4,1),new l(80,9,9,0,0,6.6,145,0,.95,0,0,8,7E-4,1),new l(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6E-4,1),new l(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5E-4,1),new l(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2E-4,
1),new l(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new l(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new l(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new l(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new l(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];this.apply_preset=function(b,d,a){switch(d){case X.R3MIX:d=X.V3;b.VBR=C.vbr_mtrh;break;case X.MEDIUM:d=X.V4;b.VBR=C.vbr_rh;break;case X.MEDIUM_FAST:d=X.V4;b.VBR=C.vbr_mtrh;break;case X.STANDARD:d=X.V2;b.VBR=C.vbr_rh;break;case X.STANDARD_FAST:d=X.V2;b.VBR=C.vbr_mtrh;
break;case X.EXTREME:d=X.V0;b.VBR=C.vbr_rh;break;case X.EXTREME_FAST:d=X.V0;b.VBR=C.vbr_mtrh;break;case X.INSANE:return d=320,b.preset=d,W(b,d,a),b.VBR=C.vbr_off,d}b.preset=d;switch(d){case X.V9:return t(b,9,a),d;case X.V8:return t(b,8,a),d;case X.V7:return t(b,7,a),d;case X.V6:return t(b,6,a),d;case X.V5:return t(b,5,a),d;case X.V4:return t(b,4,a),d;case X.V3:return t(b,3,a),d;case X.V2:return t(b,2,a),d;case X.V1:return t(b,1,a),d;case X.V0:return t(b,0,a),d}if(8<=d&&320>=d)return W(b,d,a);b.preset=
0;return d}}function yc(){var d;this.setModules=function(l){d=l};this.ResvFrameBegin=function(l,t){var v=l.internal_flags,F=v.l3_side,B=d.getframebits(l);t.bits=(B-8*v.sideinfo_len)/v.mode_gr;var w=2048*v.mode_gr-8;if(320<l.brate)var f=8*int(1E3*l.brate/(l.out_samplerate/1152)/8+.5);else f=11520,l.strict_ISO&&(f=8*int(32E4/(l.out_samplerate/1152)/8+.5));v.ResvMax=f-B;v.ResvMax>w&&(v.ResvMax=w);if(0>v.ResvMax||l.disable_reservoir)v.ResvMax=0;B=t.bits*v.mode_gr+Math.min(v.ResvSize,v.ResvMax);B>f&&(B=
f);F.resvDrain_pre=0;null!=v.pinfo&&(v.pinfo.mean_bits=t.bits/2,v.pinfo.resvsize=v.ResvSize);return B};this.ResvMaxBits=function(d,t,v,F){var l=d.internal_flags,w=l.ResvSize,f=l.ResvMax;0!=F&&(w+=t);0!=(l.substep_shaping&1)&&(f*=.9);v.bits=t;10*w>9*f?(F=w-9*f/10,v.bits+=F,l.substep_shaping|=128):(F=0,l.substep_shaping&=127,d.disable_reservoir||0!=(l.substep_shaping&1)||(v.bits-=.1*t));d=w<6*l.ResvMax/10?w:6*l.ResvMax/10;d-=F;0>d&&(d=0);return d};this.ResvAdjust=function(d,t){d.ResvSize-=t.part2_3_length+
t.part2_length};this.ResvFrameEnd=function(d,t){var l,v=d.l3_side;d.ResvSize+=t*d.mode_gr;var B=0;v.resvDrain_post=0;v.resvDrain_pre=0;0!=(l=d.ResvSize%8)&&(B+=l);l=d.ResvSize-B-d.ResvMax;0<l&&(B+=l);l=Math.min(8*v.main_data_begin,B)/8;v.resvDrain_pre+=8*l;B-=8*l;d.ResvSize-=8*l;v.main_data_begin-=l;v.resvDrain_post+=B;d.ResvSize-=B}}function sb(){function d(a,b){var c=a[b+0]&255;c=c<<8|a[b+1]&255;c=c<<8|a[b+2]&255;return c=c<<8|a[b+3]&255}function l(a,b,c){a[b+0]=c>>24&255;a[b+1]=c>>16&255;a[b+2]=
c>>8&255;a[b+3]=c&255}function t(a,b,c){a[b+0]=c>>8&255;a[b+1]=c&255}function W(a,b,c){return 255&(a<<b|c&~(-1<<b))}function F(a,b){var c=a.internal_flags;b[0]=W(b[0],8,255);b[1]=W(b[1],3,7);b[1]=W(b[1],1,16E3>a.out_samplerate?0:1);b[1]=W(b[1],1,a.version);b[1]=W(b[1],2,1);b[1]=W(b[1],1,a.error_protection?0:1);b[2]=W(b[2],4,c.bitrate_index);b[2]=W(b[2],2,c.samplerate_index);b[2]=W(b[2],1,0);b[2]=W(b[2],1,a.extension);b[3]=W(b[3],2,a.mode.ordinal());b[3]=W(b[3],2,c.mode_ext);b[3]=W(b[3],1,a.copyright);
b[3]=W(b[3],1,a.original);b[3]=W(b[3],2,a.emphasis);b[0]=255;c=b[1]&241;var e=1==a.version?128:16E3>a.out_samplerate?32:64;a.VBR==C.vbr_off&&(e=a.brate);e=a.free_format?0:255&16*G.BitrateIndex(e,a.version,a.out_samplerate);b[1]=1==a.version?255&(c|10):255&(c|2);c=b[2]&13;b[2]=255&(e|c)}function B(a,b){return b=b>>8^z[(b^a)&255]}var G,f,b;this.setModules=function(a,d,c){G=a;f=d;b=c};var q=sb.NUMTOCENTRIES,a=sb.MAXFRAMESIZE,m=q+4+4+4+4+4+9+1+1+8+1+1+3+1+1+2+4+2+2,z=[0,49345,49537,320,49921,960,640,
49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8E3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16E3,65089,64001,15040,15232,64321,14592,63937,63617,14400,
10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32E3,48577,48257,31808,46081,29888,30080,46401,30464,
47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];this.addVbrFrame=function(a){var b=a.internal_flags;
var c=b.VBR_seek_table;a=w.bitrate_table[a.version][b.bitrate_index];c.nVbrNumFrames++;c.sum+=a;c.seen++;if(!(c.seen<c.want)&&(c.pos<c.size&&(c.bag[c.pos]=c.sum,c.pos++,c.seen=0),c.pos==c.size)){for(a=1;a<c.size;a+=2)c.bag[a/2]=c.bag[a];c.want*=2;c.pos/=2}};this.getVbrTag=function(a){var b=new VBRTagData,c=0;b.flags=0;var e=a[c+1]>>3&1,f=a[c+2]>>2&3,m=a[c+3]>>6&3,n=a[c+2]>>4&15;n=w.bitrate_table[e][n];b.samprate=14==a[c+1]>>4?w.samplerate_table[2][f]:w.samplerate_table[e][f];f=c=0!=e?3!=m?c+36:c+
21:3!=m?c+21:c+13;if(!(new String(a,f,4(),null)).equals("Xing")&&!(new String(a,f,4(),null)).equals("Info"))return null;c+=4;b.hId=e;f=b.flags=d(a,c);c+=4;0!=(f&1)&&(b.frames=d(a,c),c+=4);0!=(f&2)&&(b.bytes=d(a,c),c+=4);if(0!=(f&4)){if(null!=b.toc)for(m=0;m<q;m++)b.toc[m]=a[c+m];c+=q}b.vbrScale=-1;0!=(f&8)&&(b.vbrScale=d(a,c),c+=4);b.headersize=72E3*(e+1)*n/b.samprate;c+=21;e=a[c+0]<<4;e+=a[c+1]>>4;n=(a[c+1]&15)<<8;n+=a[c+2]&255;if(0>e||3E3<e)e=-1;if(0>n||3E3<n)n=-1;b.encDelay=e;b.encPadding=n;return b};
this.InitVbrTag=function(b){var e=b.internal_flags;var c=1==b.version?128:16E3>b.out_samplerate?32:64;b.VBR==C.vbr_off&&(c=b.brate);c=72E3*(b.version+1)*c/b.out_samplerate;var d=e.sideinfo_len+m;e.VBR_seek_table.TotalFrameSize=c;if(c<d||c>a)b.bWriteVbrTag=!1;else for(e.VBR_seek_table.nVbrNumFrames=0,e.VBR_seek_table.nBytesWritten=0,e.VBR_seek_table.sum=0,e.VBR_seek_table.seen=0,e.VBR_seek_table.want=1,e.VBR_seek_table.pos=0,null==e.VBR_seek_table.bag&&(e.VBR_seek_table.bag=new int[400],e.VBR_seek_table.size=
400),c=new Int8Array(a),F(b,c),e=e.VBR_seek_table.TotalFrameSize,d=0;d<e;++d)f.add_dummy_byte(b,c[d]&255,1)};this.updateMusicCRC=function(a,b,c,d){for(var e=0;e<d;++e)a[0]=B(b[c+e],a[0])};this.getLameTagFrame=function(a,d){var c=a.internal_flags;if(!a.bWriteVbrTag||c.Class_ID!=X.LAME_ID||0>=c.VBR_seek_table.pos)return 0;if(d.length<c.VBR_seek_table.TotalFrameSize)return c.VBR_seek_table.TotalFrameSize;La.fill(d,0,c.VBR_seek_table.TotalFrameSize,0);F(a,d);var e=new Int8Array(q);if(a.free_format)for(var h=
1;h<q;++h)e[h]=255&255*h/100;else{var m=c.VBR_seek_table;if(!(0>=m.pos))for(h=1;h<q;++h){var n=0|Math.floor(h/q*m.pos);n>m.pos-1&&(n=m.pos-1);n=0|256*m.bag[n]/m.sum;255<n&&(n=255);e[h]=255&n}}n=c.sideinfo_len;a.error_protection&&(n-=2);d[n++]=0;d[n++]=0;d[n++]=0;d[n++]=0;l(d,n,15);n+=4;l(d,n,c.VBR_seek_table.nVbrNumFrames);n+=4;m=c.VBR_seek_table.nBytesWritten+c.VBR_seek_table.TotalFrameSize;l(d,n,0|m);n+=4;U.arraycopy(e,0,d,n,e.length);n+=e.length;a.error_protection&&f.CRC_writeheader(c,d);var p=
0;for(h=0;h<n;h++)p=B(d[h],p);e=n;h=p;var x=a.internal_flags;n=0;p=a.encoder_delay;var I=a.encoder_padding,g=100-10*a.VBR_q-a.quality,u=b.getLameVeryShortVersion();var y=[1,5,3,2,4,0,3];var A=0|(255<a.lowpassfreq/100+.5?255:a.lowpassfreq/100+.5),T=0,v=0,z=a.internal_flags.noise_shaping,w=0,D,H=0!=(a.exp_nspsytune&1);var M=0!=(a.exp_nspsytune&2);var Q=D=!1,na=a.internal_flags.nogap_total,J=a.internal_flags.nogap_current,aa=a.ATHtype;switch(a.VBR){case vbr_abr:var W=a.VBR_mean_bitrate_kbps;break;case vbr_off:W=
a.brate;break;default:W=a.VBR_min_bitrate_kbps}y=0+(a.VBR.ordinal()<y.length?y[a.VBR.ordinal()]:0);x.findReplayGain&&(510<x.RadioGain&&(x.RadioGain=510),-510>x.RadioGain&&(x.RadioGain=-510),v=11264,v=0<=x.RadioGain?v|x.RadioGain:v|512|-x.RadioGain);x.findPeakSample&&(T=Math.abs(0|x.PeakSample/32767*Math.pow(2,23)+.5));-1!=na&&(0<J&&(Q=!0),J<na-1&&(D=!0));H=aa+((H?1:0)<<4)+((M?1:0)<<5)+((D?1:0)<<6)+((Q?1:0)<<7);0>g&&(g=0);switch(a.mode){case MONO:M=0;break;case STEREO:M=1;break;case DUAL_CHANNEL:M=
2;break;case JOINT_STEREO:M=a.force_ms?4:3;break;default:M=7}D=32E3>=a.in_samplerate?0:48E3==a.in_samplerate?2:48E3<a.in_samplerate?3:1;if(a.short_blocks==ya.short_block_forced||a.short_blocks==ya.short_block_dispensed||-1==a.lowpassfreq&&-1==a.highpassfreq||a.scale_left<a.scale_right||a.scale_left>a.scale_right||a.disable_reservoir&&320>a.brate||a.noATH||a.ATHonly||0==aa||32E3>=a.in_samplerate)w=1;z=z+(M<<2)+(w<<5)+(D<<6);x=x.nMusicCRC;l(d,e+n,g);n+=4;for(g=0;9>g;g++)d[e+n+g]=255&u.charAt(g);n+=
9;d[e+n]=255&y;n++;d[e+n]=255&A;n++;l(d,e+n,T);n+=4;t(d,e+n,v);n+=2;t(d,e+n,0);n+=2;d[e+n]=255&H;n++;d[e+n]=255<=W?255:255&W;n++;d[e+n]=255&p>>4;d[e+n+1]=255&(p<<4)+(I>>8);d[e+n+2]=255&I;n+=3;d[e+n]=255&z;n++;d[e+n++]=0;t(d,e+n,a.preset);n+=2;l(d,e+n,m);n+=4;t(d,e+n,x);n+=2;for(m=0;m<n;m++)h=B(d[e+m],h);t(d,e+n,h);return c.VBR_seek_table.TotalFrameSize};this.putVbrTag=function(b,d){if(0>=b.internal_flags.VBR_seek_table.pos)return-1;d.seek(d.length());if(0==d.length())return-1;d.seek(0);var c=new Int8Array(10);
d.readFully(c);c=(new String(c,"ISO-8859-1")).startsWith("ID3")?0:((c[6]&127)<<21|(c[7]&127)<<14|(c[8]&127)<<7|c[9]&127)+c.length;d.seek(c);c=new Int8Array(a);var e=getLameTagFrame(b,c);if(e>c.length)return-1;if(1>e)return 0;d.write(c,0,e);return 0}}function ra(){function v(a,b,d){for(;0<d;){if(0==E){E=8;r++;if(a.header[a.w_ptr].write_timing==k){var e=a;U.arraycopy(e.header[e.w_ptr].buf,0,c,r,e.sideinfo_len);r+=e.sideinfo_len;k+=8*e.sideinfo_len;e.w_ptr=e.w_ptr+1&Y.MAX_HEADER_BUF-1}c[r]=0}e=Math.min(d,
E);d-=e;E-=e;c[r]|=b>>d<<E;k+=e}}function l(a,c){var b=a.internal_flags,d;8<=c&&(v(b,76,8),c-=8);8<=c&&(v(b,65,8),c-=8);8<=c&&(v(b,77,8),c-=8);8<=c&&(v(b,69,8),c-=8);if(32<=c){var g=e.getLameShortVersion();if(32<=c)for(d=0;d<g.length&&8<=c;++d)c-=8,v(b,g.charAt(d),8)}for(;1<=c;--c)v(b,b.ancillary_flag,1),b.ancillary_flag^=a.disable_reservoir?0:1}function t(a,c,b){for(var d=a.header[a.h_ptr].ptr;0<b;){var g=Math.min(b,8-(d&7));b-=g;a.header[a.h_ptr].buf[d>>3]|=c>>b<<8-(d&7)-g;d+=g}a.header[a.h_ptr].ptr=
d}function W(a,c){a<<=8;for(var b=0;8>b;b++)a<<=1,c<<=1,0!=((c^a)&65536)&&(c^=32773);return c}function F(a,c){var b=w.ht[c.count1table_select+32],d,g=0,e=c.big_values,f=c.big_values;for(d=(c.count1-c.big_values)/4;0<d;--d){var n=0,k=0;var p=c.l3_enc[e+0];0!=p&&(k+=8,0>c.xr[f+0]&&n++);p=c.l3_enc[e+1];0!=p&&(k+=4,n*=2,0>c.xr[f+1]&&n++);p=c.l3_enc[e+2];0!=p&&(k+=2,n*=2,0>c.xr[f+2]&&n++);p=c.l3_enc[e+3];0!=p&&(k++,n*=2,0>c.xr[f+3]&&n++);e+=4;f+=4;v(a,n+b.table[k],b.hlen[k]);g+=b.hlen[k]}return g}function B(a,
c,b,d,g){var e=w.ht[c],f=0;if(0==c)return f;for(;b<d;b+=2){var n=0,k=0,p=e.xlen,h=e.xlen,m=0,D=g.l3_enc[b],x=g.l3_enc[b+1];0!=D&&(0>g.xr[b]&&m++,n--);15<c&&(14<D&&(m|=D-15<<1,k=p,D=15),14<x&&(h=x-15,m<<=p,m|=h,k+=p,x=15),h=16);0!=x&&(m<<=1,0>g.xr[b+1]&&m++,n--);D=D*h+x;k-=n;n+=e.hlen[D];v(a,e.table[D],n);v(a,m,k);f+=n+k}return f}function G(a,c){var b=3*a.scalefac_band.s[3];b>c.big_values&&(b=c.big_values);var d=B(a,c.table_select[0],0,b,c);return d+=B(a,c.table_select[1],b,c.big_values,c)}function f(a,
c){var b=c.big_values;var d=c.region0_count+1;var g=a.scalefac_band.l[d];d+=c.region1_count+1;var e=a.scalefac_band.l[d];g>b&&(g=b);e>b&&(e=b);d=B(a,c.table_select[0],0,g,c);d+=B(a,c.table_select[1],g,e,c);return d+=B(a,c.table_select[2],e,b,c)}function b(){this.total=0}function q(c,b){var d=c.internal_flags;var e=d.w_ptr;var g=d.h_ptr-1;-1==g&&(g=Y.MAX_HEADER_BUF-1);var f=d.header[g].write_timing-k;b.total=f;if(0<=f){var n=1+g-e;g<e&&(n=1+g-e+Y.MAX_HEADER_BUF);f-=8*n*d.sideinfo_len}d=a.getframebits(c);
f+=d;b.total+=d;b.total=0!=b.total%8?1+b.total/8:b.total/8;b.total+=r+1;0>f&&U.err.println("strange error flushing buffer ... \n");return f}var a=this,m=null,z=null,e=null,h=null;this.setModules=function(a,c,b,d){m=a;z=c;e=b;h=d};var c=null,k=0,r=0,E=0;this.getframebits=function(a){var c=a.internal_flags;return 8*(0|72E3*(a.version+1)*(0!=c.bitrate_index?w.bitrate_table[a.version][c.bitrate_index]:a.brate)/a.out_samplerate+c.padding)};this.CRC_writeheader=function(a,c){var b=W(c[2]&255,65535);b=W(c[3]&
255,b);for(var d=6;d<a.sideinfo_len;d++)b=W(c[d]&255,b);c[4]=byte(b>>8);c[5]=byte(b&255)};this.flush_bitstream=function(a){var c=a.internal_flags,d;var e=c.l3_side;0>(d=q(a,new b))||(l(a,d),c.ResvSize=0,e.main_data_begin=0,c.findReplayGain&&(e=m.GetTitleGain(c.rgdata),c.RadioGain=Math.floor(10*e+.5)|0),c.findPeakSample&&(c.noclipGainChange=Math.ceil(200*Math.log10(c.PeakSample/32767))|0,0<c.noclipGainChange?EQ(a.scale,1)||EQ(a.scale,0)?c.noclipScale=Math.floor(32767/c.PeakSample*100)/100:c.noclipScale=
-1:c.noclipScale=-1))};this.add_dummy_byte=function(a,b,d){a=a.internal_flags;for(var e;0<d--;){e=b;for(var g=8;0<g;){0==E&&(E=8,r++,c[r]=0);var f=Math.min(g,E);g-=f;E-=f;c[r]|=e>>g<<E;k+=f}for(e=0;e<Y.MAX_HEADER_BUF;++e)a.header[e].write_timing+=8}};this.format_bitstream=function(a){var c=a.internal_flags;var e=c.l3_side;var n=this.getframebits(a);l(a,e.resvDrain_pre);var g=a.internal_flags,h,y;var m=g.l3_side;g.header[g.h_ptr].ptr=0;La.fill(g.header[g.h_ptr].buf,0,g.sideinfo_len,0);16E3>a.out_samplerate?
t(g,4094,12):t(g,4095,12);t(g,a.version,1);t(g,1,2);t(g,a.error_protection?0:1,1);t(g,g.bitrate_index,4);t(g,g.samplerate_index,2);t(g,g.padding,1);t(g,a.extension,1);t(g,a.mode.ordinal(),2);t(g,g.mode_ext,2);t(g,a.copyright,1);t(g,a.original,1);t(g,a.emphasis,2);a.error_protection&&t(g,0,16);if(1==a.version){t(g,m.main_data_begin,9);2==g.channels_out?t(g,m.private_bits,3):t(g,m.private_bits,5);for(y=0;y<g.channels_out;y++)for(h=0;4>h;h++)t(g,m.scfsi[y][h],1);for(h=0;2>h;h++)for(y=0;y<g.channels_out;y++){var r=
m.tt[h][y];t(g,r.part2_3_length+r.part2_length,12);t(g,r.big_values/2,9);t(g,r.global_gain,8);t(g,r.scalefac_compress,4);r.block_type!=d.NORM_TYPE?(t(g,1,1),t(g,r.block_type,2),t(g,r.mixed_block_flag,1),14==r.table_select[0]&&(r.table_select[0]=16),t(g,r.table_select[0],5),14==r.table_select[1]&&(r.table_select[1]=16),t(g,r.table_select[1],5),t(g,r.subblock_gain[0],3),t(g,r.subblock_gain[1],3),t(g,r.subblock_gain[2],3)):(t(g,0,1),14==r.table_select[0]&&(r.table_select[0]=16),t(g,r.table_select[0],
5),14==r.table_select[1]&&(r.table_select[1]=16),t(g,r.table_select[1],5),14==r.table_select[2]&&(r.table_select[2]=16),t(g,r.table_select[2],5),t(g,r.region0_count,4),t(g,r.region1_count,3));t(g,r.preflag,1);t(g,r.scalefac_scale,1);t(g,r.count1table_select,1)}}else for(t(g,m.main_data_begin,8),t(g,m.private_bits,g.channels_out),y=h=0;y<g.channels_out;y++)r=m.tt[h][y],t(g,r.part2_3_length+r.part2_length,12),t(g,r.big_values/2,9),t(g,r.global_gain,8),t(g,r.scalefac_compress,9),r.block_type!=d.NORM_TYPE?
(t(g,1,1),t(g,r.block_type,2),t(g,r.mixed_block_flag,1),14==r.table_select[0]&&(r.table_select[0]=16),t(g,r.table_select[0],5),14==r.table_select[1]&&(r.table_select[1]=16),t(g,r.table_select[1],5),t(g,r.subblock_gain[0],3),t(g,r.subblock_gain[1],3),t(g,r.subblock_gain[2],3)):(t(g,0,1),14==r.table_select[0]&&(r.table_select[0]=16),t(g,r.table_select[0],5),14==r.table_select[1]&&(r.table_select[1]=16),t(g,r.table_select[1],5),14==r.table_select[2]&&(r.table_select[2]=16),t(g,r.table_select[2],5),t(g,
r.region0_count,4),t(g,r.region1_count,3)),t(g,r.scalefac_scale,1),t(g,r.count1table_select,1);a.error_protection&&CRC_writeheader(g,g.header[g.h_ptr].buf);m=g.h_ptr;g.h_ptr=m+1&Y.MAX_HEADER_BUF-1;g.header[g.h_ptr].write_timing=g.header[m].write_timing+n;g.h_ptr==g.w_ptr&&U.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n");g=8*c.sideinfo_len;var E=0,z=a.internal_flags,B=z.l3_side;if(1==a.version)for(m=0;2>m;m++)for(y=0;y<z.channels_out;y++){var D=B.tt[m][y],H=cb.slen1_tab[D.scalefac_compress],
M=cb.slen2_tab[D.scalefac_compress];for(h=r=0;h<D.sfbdivide;h++)-1!=D.scalefac[h]&&(v(z,D.scalefac[h],H),r+=H);for(;h<D.sfbmax;h++)-1!=D.scalefac[h]&&(v(z,D.scalefac[h],M),r+=M);r=D.block_type==d.SHORT_TYPE?r+G(z,D):r+f(z,D);r+=F(z,D);E+=r}else for(y=m=0;y<z.channels_out;y++){D=B.tt[m][y];var Q=0;M=h=r=0;if(D.block_type==d.SHORT_TYPE){for(;4>M;M++){var w=D.sfb_partition_table[M]/3,J=D.slen[M];for(H=0;H<w;H++,h++)v(z,Math.max(D.scalefac[3*h],0),J),v(z,Math.max(D.scalefac[3*h+1],0),J),v(z,Math.max(D.scalefac[3*
h+2],0),J),Q+=3*J}r+=G(z,D)}else{for(;4>M;M++)for(w=D.sfb_partition_table[M],J=D.slen[M],H=0;H<w;H++,h++)v(z,Math.max(D.scalefac[h],0),J),Q+=J;r+=f(z,D)}r+=F(z,D);E+=Q+r}g+=E;l(a,e.resvDrain_post);g+=e.resvDrain_post;e.main_data_begin+=(n-g)/8;q(a,new b)!=c.ResvSize&&U.err.println("Internal buffer inconsistency. flushbits <> ResvSize");8*e.main_data_begin!=c.ResvSize&&(U.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",
8*e.main_data_begin,c.ResvSize,e.resvDrain_post,e.resvDrain_pre,8*c.sideinfo_len,g-e.resvDrain_post-8*c.sideinfo_len,g,g%8,n),U.err.println("This is a fatal error.  It has several possible causes:"),U.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),U.err.println(" 9%%  Your system is overclocked"),U.err.println(" 1%%  bug in LAME encoding library"),c.ResvSize=8*e.main_data_begin);if(1E9<k){for(a=0;a<Y.MAX_HEADER_BUF;++a)c.header[a].write_timing-=k;k=0}return 0};
this.copy_buffer=function(a,b,d,e,g){var f=r+1;if(0>=f)return 0;if(0!=e&&f>e)return-1;U.arraycopy(c,0,b,d,f);r=-1;E=0;if(0!=g&&(e=P(1),e[0]=a.nMusicCRC,h.updateMusicCRC(e,b,d,f),a.nMusicCRC=e[0],0<f&&(a.VBR_seek_table.nBytesWritten+=f),a.decode_on_the_fly)){e=V([2,1152]);g=f;for(var k=-1,n;0!=k;)if(k=z.hip_decode1_unclipped(a.hip,b,d,g,e[0],e[1]),g=0,-1==k&&(k=0),0<k){if(a.findPeakSample){for(n=0;n<k;n++)e[0][n]>a.PeakSample?a.PeakSample=e[0][n]:-e[0][n]>a.PeakSample&&(a.PeakSample=-e[0][n]);if(1<
a.channels_out)for(n=0;n<k;n++)e[1][n]>a.PeakSample?a.PeakSample=e[1][n]:-e[1][n]>a.PeakSample&&(a.PeakSample=-e[1][n])}if(a.findReplayGain&&m.AnalyzeSamples(a.rgdata,e[0],0,e[1],0,k,a.channels_out)==ca.GAIN_ANALYSIS_ERROR)return-6}}return f};this.init_bit_stream_w=function(a){c=new Int8Array(X.LAME_MAXMP3BUFFER);a.h_ptr=a.w_ptr=0;a.header[a.h_ptr].write_timing=0;r=-1;k=E=0}}function Z(d,l,t,w){this.xlen=d;this.linmax=l;this.table=t;this.hlen=w}function Ma(d){this.bits=d}function Ob(){this.bits=this.over_SSD=
this.over_count=this.max_noise=this.tot_noise=this.over_noise=0}function zc(){this.setModules=function(d,l){}}function Ac(){this.floor=this.decay=this.adjustLimit=this.adjust=this.aaSensitivityP=this.useAdjust=0;this.l=G(d.SBMAX_l);this.s=G(d.SBMAX_s);this.psfb21=G(d.PSFB21);this.psfb12=G(d.PSFB12);this.cb_l=G(d.CBANDS);this.cb_s=G(d.CBANDS);this.eql_w=G(d.BLKSIZE/2)}function Bc(){this.scale_right=this.scale_left=this.scale=this.out_samplerate=this.in_samplerate=this.num_channels=this.num_samples=
this.class_id=0;this.decode_only=this.bWriteVbrTag=this.analysis=!1;this.quality=0;this.mode=da.STEREO;this.write_id3tag_automatic=this.decode_on_the_fly=this.findReplayGain=this.free_format=this.force_ms=!1;this.error_protection=this.emphasis=this.extension=this.original=this.copyright=this.compression_ratio=this.brate=0;this.disable_reservoir=this.strict_ISO=!1;this.quant_comp_short=this.quant_comp=0;this.experimentalY=!1;this.preset=this.exp_nspsytune=this.experimentalZ=0;this.VBR=null;this.maskingadjust_short=
this.maskingadjust=this.highpasswidth=this.lowpasswidth=this.highpassfreq=this.lowpassfreq=this.VBR_hard_min=this.VBR_max_bitrate_kbps=this.VBR_min_bitrate_kbps=this.VBR_mean_bitrate_kbps=this.VBR_q=this.VBR_q_frac=0;this.noATH=this.ATHshort=this.ATHonly=!1;this.athaa_sensitivity=this.athaa_loudapprox=this.athaa_type=this.ATHlower=this.ATHcurve=this.ATHtype=0;this.short_blocks=null;this.useTemporal=!1;this.msfix=this.interChRatio=0;this.tune=!1;this.lame_allocated_gfp=this.frameNum=this.framesize=
this.encoder_padding=this.encoder_delay=this.version=this.tune_value_a=0;this.internal_flags=null}function Cc(v){this.quantize=v;this.iteration_loop=function(l,t,v,w){var B=l.internal_flags,F=G(ta.SFBMAX),f=G(576),b=P(2),q=B.l3_side;var a=new Ma(0);this.quantize.rv.ResvFrameBegin(l,a);a=a.bits;for(var m=0;m<B.mode_gr;m++){var z=this.quantize.qupvt.on_pe(l,t,b,a,m,m);B.mode_ext==d.MPG_MD_MS_LR&&(this.quantize.ms_convert(B.l3_side,m),this.quantize.qupvt.reduce_side(b,v[m],a,z));for(z=0;z<B.channels_out;z++){var e=
q.tt[m][z];if(e.block_type!=d.SHORT_TYPE){var h=0;h=B.PSY.mask_adjust-h}else h=0,h=B.PSY.mask_adjust_short-h;B.masking_lower=Math.pow(10,.1*h);this.quantize.init_outer_loop(B,e);this.quantize.init_xrpow(B,e,f)&&(this.quantize.qupvt.calc_xmin(l,w[m][z],e,F),this.quantize.outer_loop(l,e,F,f,z,b[z]));this.quantize.iteration_finish_one(B,m,z)}}this.quantize.rv.ResvFrameEnd(B,a)}}function Dc(){this.linprebuf=G(2*ca.MAX_ORDER);this.linpre=0;this.lstepbuf=G(ca.MAX_SAMPLES_PER_WINDOW+ca.MAX_ORDER);this.lstep=
0;this.loutbuf=G(ca.MAX_SAMPLES_PER_WINDOW+ca.MAX_ORDER);this.lout=0;this.rinprebuf=G(2*ca.MAX_ORDER);this.rinpre=0;this.rstepbuf=G(ca.MAX_SAMPLES_PER_WINDOW+ca.MAX_ORDER);this.rstep=0;this.routbuf=G(ca.MAX_SAMPLES_PER_WINDOW+ca.MAX_ORDER);this.first=this.freqindex=this.rsum=this.lsum=this.totsamp=this.sampleWindow=this.rout=0;this.A=P(0|ca.STEPS_per_dB*ca.MAX_dB);this.B=P(0|ca.STEPS_per_dB*ca.MAX_dB)}function sa(v,l,t,w){this.l=P(1+d.SBMAX_l);this.s=P(1+d.SBMAX_s);this.psfb21=P(1+d.PSFB21);this.psfb12=
P(1+d.PSFB12);var F=this.l,B=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],U.arraycopy(this.arrL,0,F,0,Math.min(this.arrL.length,this.l.length)),U.arraycopy(this.arrS,0,B,0,Math.min(this.arrS.length,this.s.length)),U.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),U.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function oa(){function v(a,b){var c=
F.ATHformula(b,a);return c=Math.pow(10,(c-100)/10+a.ATHlower)}function l(a){this.s=a}var t=null,w=null,F=null;this.setModules=function(a,b,c){t=a;w=b;F=c};this.IPOW20=function(b){return a[b]};var B=oa.IXMAX_VAL+2,fa=oa.Q_MAX,f=oa.Q_MAX2;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var b=[0,0,0,0,0,0,0,0,0,0,0,1,
1,1,1,2,2,3,3,3,2,0];this.pretab=b;this.sfBandIndex=[new sa([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new sa([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new sa([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,
134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new sa([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new sa([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new sa([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,
0,0,0,0,0,0],[0,0,0,0,0,0,0]),new sa([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new sa([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new sa([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,
0,0,0,0,0,0],[0,0,0,0,0,0,0])];var q=G(fa+f+1),a=G(fa),m=G(B),z=G(B);this.adj43=z;this.iteration_init=function(b){var e=b.internal_flags,c=e.l3_side;if(0==e.iteration_init_init){e.iteration_init_init=1;c.main_data_begin=0;c=b.internal_flags.ATH.l;for(var k=b.internal_flags.ATH.psfb21,r=b.internal_flags.ATH.s,l=b.internal_flags.ATH.psfb12,n=b.internal_flags,p=b.out_samplerate,x=0;x<d.SBMAX_l;x++){var I=n.scalefac_band.l[x],g=n.scalefac_band.l[x+1];for(c[x]=Ya.MAX_VALUE;I<g;I++){var u=I*p/1152;u=v(b,
u);c[x]=Math.min(c[x],u)}}for(x=0;x<d.PSFB21;x++)for(I=n.scalefac_band.psfb21[x],g=n.scalefac_band.psfb21[x+1],k[x]=Ya.MAX_VALUE;I<g;I++)u=I*p/1152,u=v(b,u),k[x]=Math.min(k[x],u);for(x=0;x<d.SBMAX_s;x++){I=n.scalefac_band.s[x];g=n.scalefac_band.s[x+1];for(r[x]=Ya.MAX_VALUE;I<g;I++)u=I*p/384,u=v(b,u),r[x]=Math.min(r[x],u);r[x]*=n.scalefac_band.s[x+1]-n.scalefac_band.s[x]}for(x=0;x<d.PSFB12;x++){I=n.scalefac_band.psfb12[x];g=n.scalefac_band.psfb12[x+1];for(l[x]=Ya.MAX_VALUE;I<g;I++)u=I*p/384,u=v(b,
u),l[x]=Math.min(l[x],u);l[x]*=n.scalefac_band.s[13]-n.scalefac_band.s[12]}if(b.noATH){for(x=0;x<d.SBMAX_l;x++)c[x]=1E-20;for(x=0;x<d.PSFB21;x++)k[x]=1E-20;for(x=0;x<d.SBMAX_s;x++)r[x]=1E-20;for(x=0;x<d.PSFB12;x++)l[x]=1E-20}n.ATH.floor=10*Math.log10(v(b,-1));m[0]=0;for(c=1;c<B;c++)m[c]=Math.pow(c,4/3);for(c=0;c<B-1;c++)z[c]=c+1-Math.pow(.5*(m[c]+m[c+1]),.75);z[c]=.5;for(c=0;c<fa;c++)a[c]=Math.pow(2,-.1875*(c-210));for(c=0;c<=fa+f;c++)q[c]=Math.pow(2,.25*(c-210-f));t.huffman_init(e);c=b.exp_nspsytune>>
2&63;32<=c&&(c-=64);k=Math.pow(10,c/4/10);c=b.exp_nspsytune>>8&63;32<=c&&(c-=64);r=Math.pow(10,c/4/10);c=b.exp_nspsytune>>14&63;32<=c&&(c-=64);l=Math.pow(10,c/4/10);c=b.exp_nspsytune>>20&63;32<=c&&(c-=64);b=l*Math.pow(10,c/4/10);for(c=0;c<d.SBMAX_l;c++)n=6>=c?k:13>=c?r:20>=c?l:b,e.nsPsy.longfact[c]=n;for(c=0;c<d.SBMAX_s;c++)n=5>=c?k:10>=c?r:11>=c?l:b,e.nsPsy.shortfact[c]=n}};this.on_pe=function(a,b,c,d,f,m){var e=a.internal_flags,k=0,h=P(2),r;k=new Ma(k);a=w.ResvMaxBits(a,d,k,m);k=k.bits;var g=k+
a;g>Y.MAX_BITS_PER_GRANULE&&(g=Y.MAX_BITS_PER_GRANULE);for(r=m=0;r<e.channels_out;++r)c[r]=Math.min(Y.MAX_BITS_PER_CHANNEL,k/e.channels_out),h[r]=0|c[r]*b[f][r]/700-c[r],h[r]>3*d/4&&(h[r]=3*d/4),0>h[r]&&(h[r]=0),h[r]+c[r]>Y.MAX_BITS_PER_CHANNEL&&(h[r]=Math.max(0,Y.MAX_BITS_PER_CHANNEL-c[r])),m+=h[r];if(m>a)for(r=0;r<e.channels_out;++r)h[r]=a*h[r]/m;for(r=0;r<e.channels_out;++r)c[r]+=h[r],a-=h[r];for(r=m=0;r<e.channels_out;++r)m+=c[r];if(m>Y.MAX_BITS_PER_GRANULE)for(r=0;r<e.channels_out;++r)c[r]*=
Y.MAX_BITS_PER_GRANULE,c[r]/=m;return g};this.reduce_side=function(a,b,c,d){b=.33*(.5-b)/.5;0>b&&(b=0);.5<b&&(b=.5);b=0|.5*b*(a[0]+a[1]);b>Y.MAX_BITS_PER_CHANNEL-a[0]&&(b=Y.MAX_BITS_PER_CHANNEL-a[0]);0>b&&(b=0);125<=a[1]&&(125<a[1]-b?(a[0]<c&&(a[0]+=b),a[1]-=b):(a[0]+=a[1]-125,a[1]=125));b=a[0]+a[1];b>d&&(a[0]=d*a[0]/b,a[1]=d*a[1]/b)};this.athAdjust=function(a,b,c){b=ba.FAST_LOG10_X(b,10);a*=a;var d=0;b-=c;1E-20<a&&(d=1+ba.FAST_LOG10_X(a,10/90.30873362));0>d&&(d=0);return Math.pow(10,.1*(b*d+(c+90.30873362-
94.82444863)))};this.calc_xmin=function(a,b,c,f){var e=0,k=a.internal_flags,h,p=0,m=0,q=k.ATH,g=c.xr,u=a.VBR==C.vbr_mtrh?1:0,y=k.masking_lower;if(a.VBR==C.vbr_mtrh||a.VBR==C.vbr_mt)y=1;for(h=0;h<c.psy_lmax;h++){var l=a.VBR==C.vbr_rh||a.VBR==C.vbr_mtrh?athAdjust(q.adjust,q.l[h],q.floor):q.adjust*q.l[h];var t=c.width[h];var z=l/t;var v=2.220446049250313E-16;var B=t>>1;var D=0;do{var H=g[p]*g[p];D+=H;v+=H<z?H:z;p++;H=g[p]*g[p];D+=H;v+=H<z?H:z;p++}while(0<--B);D>l&&m++;h==d.SBPSY_l&&(z=l*k.nsPsy.longfact[h],
v<z&&(v=z));0!=u&&(l=v);a.ATHonly||(v=b.en.l[h],0<v&&(z=D*b.thm.l[h]*y/v,0!=u&&(z*=k.nsPsy.longfact[h]),l<z&&(l=z)));0!=u?f[e++]=l:f[e++]=l*k.nsPsy.longfact[h]}D=575;if(c.block_type!=d.SHORT_TYPE)for(l=576;0!=l--&&ra.EQ(g[l],0);)D=l;c.max_nonzero_coeff=D;for(var M=c.sfb_smin;h<c.psymax;M++,h+=3){var Q;var w=a.VBR==C.vbr_rh||a.VBR==C.vbr_mtrh?athAdjust(q.adjust,q.s[M],q.floor):q.adjust*q.s[M];t=c.width[h];for(Q=0;3>Q;Q++){D=0;B=t>>1;z=w/t;v=2.220446049250313E-16;do H=g[p]*g[p],D+=H,v+=H<z?H:z,p++,
H=g[p]*g[p],D+=H,v+=H<z?H:z,p++;while(0<--B);D>w&&m++;M==d.SBPSY_s&&(z=w*k.nsPsy.shortfact[M],v<z&&(v=z));l=0!=u?v:w;a.ATHonly||a.ATHshort||(v=b.en.s[M][Q],0<v&&(z=D*b.thm.s[M][Q]*y/v,0!=u&&(z*=k.nsPsy.shortfact[M]),l<z&&(l=z)));0!=u?f[e++]=l:f[e++]=l*k.nsPsy.shortfact[M]}a.useTemporal&&(f[e-3]>f[e-3+1]&&(f[e-3+1]+=(f[e-3]-f[e-3+1])*k.decay),f[e-3+1]>f[e-3+2]&&(f[e-3+2]+=(f[e-3+1]-f[e-3+2])*k.decay))}return m};this.calc_noise_core=function(a,b,c,d){var e=0,f=b.s,k=a.l3_enc;if(f>a.count1)for(;0!=c--;){var h=
a.xr[f];f++;e+=h*h;h=a.xr[f];f++;e+=h*h}else if(f>a.big_values){var q=G(2);q[0]=0;for(q[1]=d;0!=c--;)h=Math.abs(a.xr[f])-q[k[f]],f++,e+=h*h,h=Math.abs(a.xr[f])-q[k[f]],f++,e+=h*h}else for(;0!=c--;)h=Math.abs(a.xr[f])-m[k[f]]*d,f++,e+=h*h,h=Math.abs(a.xr[f])-m[k[f]]*d,f++,e+=h*h;b.s=f;return e};this.calc_noise=function(a,d,c,f,m){var e=0,k=0,h,r=0,z=0,g=0,u=-20,y=0,A=a.scalefac,t=0;for(h=f.over_SSD=0;h<a.psymax;h++){var v=a.global_gain-(A[t++]+(0!=a.preflag?b[h]:0)<<a.scalefac_scale+1)-8*a.subblock_gain[a.window[h]];
if(null!=m&&m.step[h]==v){var B=m.noise[h];y+=a.width[h];c[e++]=B/d[k++];B=m.noise_log[h]}else{B=q[v+oa.Q_MAX2];var w=a.width[h]>>1;y+a.width[h]>a.max_nonzero_coeff&&(w=a.max_nonzero_coeff-y+1,w=0<w?w>>1:0);y=new l(y);B=this.calc_noise_core(a,y,w,B);y=y.s;null!=m&&(m.step[h]=v,m.noise[h]=B);B=c[e++]=B/d[k++];B=ba.FAST_LOG10(Math.max(B,1E-20));null!=m&&(m.noise_log[h]=B)}null!=m&&(m.global_gain=a.global_gain);g+=B;0<B&&(v=Math.max(0|10*B+.5,1),f.over_SSD+=v*v,r++,z+=B);u=Math.max(u,B)}f.over_count=
r;f.tot_noise=g;f.over_noise=z;f.max_noise=u;return r};this.set_pinfo=function(a,f,c,k,m){var e=a.internal_flags,h,p,r=0==f.scalefac_scale?.5:1,q=f.scalefac,g=G(ta.SFBMAX),l=G(ta.SFBMAX),y=new Ob;calc_xmin(a,c,f,g);calc_noise(f,g,l,y,null);var z=0;var v=f.sfb_lmax;f.block_type!=d.SHORT_TYPE&&0==f.mixed_block_flag&&(v=22);for(h=0;h<v;h++){var t=e.scalefac_band.l[h],B=e.scalefac_band.l[h+1],w=B-t;for(p=0;z<B;z++)p+=f.xr[z]*f.xr[z];p/=w;var D=1E15;e.pinfo.en[k][m][h]=D*p;e.pinfo.xfsf[k][m][h]=D*g[h]*
l[h]/w;p=0<c.en.l[h]&&!a.ATHonly?p/c.en.l[h]:0;e.pinfo.thr[k][m][h]=D*Math.max(p*c.thm.l[h],e.ATH.l[h]);e.pinfo.LAMEsfb[k][m][h]=0;0!=f.preflag&&11<=h&&(e.pinfo.LAMEsfb[k][m][h]=-r*b[h]);h<d.SBPSY_l&&(e.pinfo.LAMEsfb[k][m][h]-=r*q[h])}if(f.block_type==d.SHORT_TYPE)for(v=h,h=f.sfb_smin;h<d.SBMAX_s;h++){t=e.scalefac_band.s[h];B=e.scalefac_band.s[h+1];w=B-t;for(var H=0;3>H;H++){p=0;for(D=t;D<B;D++)p+=f.xr[z]*f.xr[z],z++;p=Math.max(p/w,1E-20);D=1E15;e.pinfo.en_s[k][m][3*h+H]=D*p;e.pinfo.xfsf_s[k][m][3*
h+H]=D*g[v]*l[v]/w;p=0<c.en.s[h][H]?p/c.en.s[h][H]:0;if(a.ATHonly||a.ATHshort)p=0;e.pinfo.thr_s[k][m][3*h+H]=D*Math.max(p*c.thm.s[h][H],e.ATH.s[h]);e.pinfo.LAMEsfb_s[k][m][3*h+H]=-2*f.subblock_gain[H];h<d.SBPSY_s&&(e.pinfo.LAMEsfb_s[k][m][3*h+H]-=r*q[v]);v++}}e.pinfo.LAMEqss[k][m]=f.global_gain;e.pinfo.LAMEmainbits[k][m]=f.part2_3_length+f.part2_length;e.pinfo.LAMEsfbits[k][m]=f.part2_length;e.pinfo.over[k][m]=y.over_count;e.pinfo.max_noise[k][m]=10*y.max_noise;e.pinfo.over_noise[k][m]=10*y.over_noise;
e.pinfo.tot_noise[k][m]=10*y.tot_noise;e.pinfo.over_SSD[k][m]=y.over_SSD}}function Ec(){this.sfb_count1=this.global_gain=0;this.step=P(39);this.noise=G(39);this.noise_log=G(39)}function rb(){this.xr=G(576);this.l3_enc=P(576);this.scalefac=P(ta.SFBMAX);this.mixed_block_flag=this.block_type=this.scalefac_compress=this.global_gain=this.count1=this.big_values=this.part2_3_length=this.xrpow_max=0;this.table_select=P(3);this.subblock_gain=P(4);this.sfbdivide=this.psymax=this.sfbmax=this.psy_lmax=this.sfb_smin=
this.sfb_lmax=this.part2_length=this.count1table_select=this.scalefac_scale=this.preflag=this.region1_count=this.region0_count=0;this.width=P(ta.SFBMAX);this.window=P(ta.SFBMAX);this.count1bits=0;this.sfb_partition_table=null;this.slen=P(4);this.max_nonzero_coeff=0;var d=this;this.assign=function(l){d.xr=new Float32Array(l.xr);d.l3_enc=new Int32Array(l.l3_enc);d.scalefac=new Int32Array(l.scalefac);d.xrpow_max=l.xrpow_max;d.part2_3_length=l.part2_3_length;d.big_values=l.big_values;d.count1=l.count1;
d.global_gain=l.global_gain;d.scalefac_compress=l.scalefac_compress;d.block_type=l.block_type;d.mixed_block_flag=l.mixed_block_flag;d.table_select=new Int32Array(l.table_select);d.subblock_gain=new Int32Array(l.subblock_gain);d.region0_count=l.region0_count;d.region1_count=l.region1_count;d.preflag=l.preflag;d.scalefac_scale=l.scalefac_scale;d.count1table_select=l.count1table_select;d.part2_length=l.part2_length;d.sfb_lmax=l.sfb_lmax;d.sfb_smin=l.sfb_smin;d.psy_lmax=l.psy_lmax;d.sfbmax=l.sfbmax;d.psymax=
l.psymax;d.sfbdivide=l.sfbdivide;d.width=new Int32Array(l.width);d.window=new Int32Array(l.window);d.count1bits=l.count1bits;d.sfb_partition_table=l.sfb_partition_table.slice(0);d.slen=new Int32Array(l.slen);d.max_nonzero_coeff=l.max_nonzero_coeff}}function Fc(){function v(d){this.ordinal=d}function l(d){for(var b=0;b<d.sfbmax;b++)if(0==d.scalefac[b]+d.subblock_gain[d.window[b]])return!1;return!0}var t;this.rv=null;var w;this.qupvt=null;var F,B=new zc,fa;this.setModules=function(d,b,q,a){t=d;this.rv=
w=b;this.qupvt=F=q;fa=a;B.setModules(F,fa)};this.ms_convert=function(d,b){for(var f=0;576>f;++f){var a=d.tt[b][0].xr[f],m=d.tt[b][1].xr[f];d.tt[b][0].xr[f]=.5*(a+m)*ba.SQRT2;d.tt[b][1].xr[f]=.5*(a-m)*ba.SQRT2}};this.init_xrpow=function(d,b,l){var a=0|b.max_nonzero_coeff;b.xrpow_max=0;La.fill(l,a,576,0);for(var f,q=f=0;q<=a;++q){var e=Math.abs(b.xr[q]);f+=e;l[q]=Math.sqrt(e*Math.sqrt(e));l[q]>b.xrpow_max&&(b.xrpow_max=l[q])}if(1E-20<f){l=0;0!=(d.substep_shaping&2)&&(l=1);for(a=0;a<b.psymax;a++)d.pseudohalf[a]=
l;return!0}La.fill(b.l3_enc,0,576,0);return!1};this.init_outer_loop=function(f,b){b.part2_3_length=0;b.big_values=0;b.count1=0;b.global_gain=210;b.scalefac_compress=0;b.table_select[0]=0;b.table_select[1]=0;b.table_select[2]=0;b.subblock_gain[0]=0;b.subblock_gain[1]=0;b.subblock_gain[2]=0;b.subblock_gain[3]=0;b.region0_count=0;b.region1_count=0;b.preflag=0;b.scalefac_scale=0;b.count1table_select=0;b.part2_length=0;b.sfb_lmax=d.SBPSY_l;b.sfb_smin=d.SBPSY_s;b.psy_lmax=f.sfb21_extra?d.SBMAX_l:d.SBPSY_l;
b.psymax=b.psy_lmax;b.sfbmax=b.sfb_lmax;b.sfbdivide=11;for(var l=0;l<d.SBMAX_l;l++)b.width[l]=f.scalefac_band.l[l+1]-f.scalefac_band.l[l],b.window[l]=3;if(b.block_type==d.SHORT_TYPE){var a=G(576);b.sfb_smin=0;b.sfb_lmax=0;0!=b.mixed_block_flag&&(b.sfb_smin=3,b.sfb_lmax=2*f.mode_gr+4);b.psymax=b.sfb_lmax+3*((f.sfb21_extra?d.SBMAX_s:d.SBPSY_s)-b.sfb_smin);b.sfbmax=b.sfb_lmax+3*(d.SBPSY_s-b.sfb_smin);b.sfbdivide=b.sfbmax-18;b.psy_lmax=b.sfb_lmax;var m=f.scalefac_band.l[b.sfb_lmax];U.arraycopy(b.xr,0,
a,0,576);for(l=b.sfb_smin;l<d.SBMAX_s;l++)for(var t=f.scalefac_band.s[l],e=f.scalefac_band.s[l+1],h=0;3>h;h++)for(var c=t;c<e;c++)b.xr[m++]=a[3*c+h];a=b.sfb_lmax;for(l=b.sfb_smin;l<d.SBMAX_s;l++)b.width[a]=b.width[a+1]=b.width[a+2]=f.scalefac_band.s[l+1]-f.scalefac_band.s[l],b.window[a]=0,b.window[a+1]=1,b.window[a+2]=2,a+=3}b.count1bits=0;b.sfb_partition_table=F.nr_of_sfb_block[0][0];b.slen[0]=0;b.slen[1]=0;b.slen[2]=0;b.slen[3]=0;b.max_nonzero_coeff=575;La.fill(b.scalefac,0);l=f.ATH;a=b.xr;if(b.block_type!=
d.SHORT_TYPE)for(m=!1,t=d.PSFB21-1;0<=t&&!m;t--)for(e=f.scalefac_band.psfb21[t],h=f.scalefac_band.psfb21[t+1],c=F.athAdjust(l.adjust,l.psfb21[t],l.floor),1E-12<f.nsPsy.longfact[21]&&(c*=f.nsPsy.longfact[21]),--h;h>=e;h--)if(Math.abs(a[h])<c)a[h]=0;else{m=!0;break}else for(c=0;3>c;c++)for(m=!1,t=d.PSFB12-1;0<=t&&!m;t--){e=3*f.scalefac_band.s[12]+(f.scalefac_band.s[13]-f.scalefac_band.s[12])*c+(f.scalefac_band.psfb12[t]-f.scalefac_band.psfb12[0]);h=e+(f.scalefac_band.psfb12[t+1]-f.scalefac_band.psfb12[t]);
var k=F.athAdjust(l.adjust,l.psfb12[t],l.floor);1E-12<f.nsPsy.shortfact[12]&&(k*=f.nsPsy.shortfact[12]);for(--h;h>=e;h--)if(Math.abs(a[h])<k)a[h]=0;else{m=!0;break}}};v.BINSEARCH_NONE=new v(0);v.BINSEARCH_UP=new v(1);v.BINSEARCH_DOWN=new v(2);this.trancate_smallspectrums=function(f,b,l,a){var m=G(ta.SFBMAX);if((0!=(f.substep_shaping&4)||b.block_type!=d.SHORT_TYPE)&&0==(f.substep_shaping&128)){F.calc_noise(b,l,m,new Ob,null);for(var q=0;576>q;q++){var e=0;0!=b.l3_enc[q]&&(e=Math.abs(b.xr[q]));a[q]=
e}q=0;e=8;b.block_type==d.SHORT_TYPE&&(e=6);do{var h,c,k=b.width[e];q+=k;if(!(1<=m[e]||(La.sort(a,q-k,k),ra.EQ(a[q-1],0)))){var r=(1-m[e])*l[e];var t=h=0;do{for(c=1;t+c<k&&!ra.NEQ(a[t+q-k],a[t+q+c-k]);c++);var n=a[t+q-k]*a[t+q-k]*c;if(r<n){0!=t&&(h=a[t+q-k-1]);break}r-=n;t+=c}while(t<k);if(!ra.EQ(h,0)){do Math.abs(b.xr[q-k])<=h&&(b.l3_enc[q-k]=0);while(0<--k)}}}while(++e<b.psymax);b.part2_3_length=fa.noquant_count_bits(f,b,null)}};this.outer_loop=function(f,b,q,a,m,t){var e=f.internal_flags,h=new rb,
c=G(576),k=G(ta.SFBMAX),r=new Ob,B=new Ec,n=9999999,p=!1,x=!1,z=0,g,u=e.CurrentStep[m],y=!1,A=e.OldValue[m];var w=v.BINSEARCH_NONE;b.global_gain=A;for(g=t-b.part2_length;;){var L=fa.count_bits(e,a,b,null);if(1==u||L==g)break;L>g?(w==v.BINSEARCH_DOWN&&(y=!0),y&&(u/=2),w=v.BINSEARCH_UP,L=u):(w==v.BINSEARCH_UP&&(y=!0),y&&(u/=2),w=v.BINSEARCH_DOWN,L=-u);b.global_gain+=L;0>b.global_gain&&(b.global_gain=0,y=!0);255<b.global_gain&&(b.global_gain=255,y=!0)}for(;L>g&&255>b.global_gain;)b.global_gain++,L=fa.count_bits(e,
a,b,null);e.CurrentStep[m]=4<=A-b.global_gain?4:2;e.OldValue[m]=b.global_gain;b.part2_3_length=L;if(0==e.noise_shaping)return 100;F.calc_noise(b,q,k,r,B);r.bits=b.part2_3_length;h.assign(b);m=0;for(U.arraycopy(a,0,c,0,576);!p;){do{g=new Ob;y=255;u=0!=(e.substep_shaping&2)?20:3;if(e.sfb21_extra){if(1<k[h.sfbmax])break;if(h.block_type==d.SHORT_TYPE&&(1<k[h.sfbmax+1]||1<k[h.sfbmax+2]))break}A=h;L=a;w=f.internal_flags;var S=A,ja=k,D=L,H=f.internal_flags;var M=0==S.scalefac_scale?1.2968395546510096:1.6817928305074292;
for(var Q=0,na=0;na<S.sfbmax;na++)Q<ja[na]&&(Q=ja[na]);na=H.noise_shaping_amp;3==na&&(na=x?2:1);switch(na){case 2:break;case 1:Q=1<Q?Math.pow(Q,.5):.95*Q;break;default:Q=1<Q?1:.95*Q}var J=0;for(na=0;na<S.sfbmax;na++){var aa=S.width[na];J+=aa;if(!(ja[na]<Q)){if(0!=(H.substep_shaping&2)&&(H.pseudohalf[na]=0==H.pseudohalf[na]?1:0,0==H.pseudohalf[na]&&2==H.noise_shaping_amp))break;S.scalefac[na]++;for(aa=-aa;0>aa;aa++)D[J+aa]*=M,D[J+aa]>S.xrpow_max&&(S.xrpow_max=D[J+aa]);if(2==H.noise_shaping_amp)break}}if(M=
l(A))A=!1;else if(M=2==w.mode_gr?fa.scale_bitcount(A):fa.scale_bitcount_lsf(w,A)){if(1<w.noise_shaping)if(La.fill(w.pseudohalf,0),0==A.scalefac_scale){M=A;for(ja=S=0;ja<M.sfbmax;ja++){H=M.width[ja];D=M.scalefac[ja];0!=M.preflag&&(D+=F.pretab[ja]);S+=H;if(0!=(D&1))for(D++,H=-H;0>H;H++)L[S+H]*=1.2968395546510096,L[S+H]>M.xrpow_max&&(M.xrpow_max=L[S+H]);M.scalefac[ja]=D>>1}M.preflag=0;M.scalefac_scale=1;M=!1}else if(A.block_type==d.SHORT_TYPE&&0<w.subblock_gain){b:{M=w;S=A;ja=L;D=S.scalefac;for(L=0;L<
S.sfb_lmax;L++)if(16<=D[L]){L=!0;break b}for(H=0;3>H;H++){na=Q=0;for(L=S.sfb_lmax+H;L<S.sfbdivide;L+=3)Q<D[L]&&(Q=D[L]);for(;L<S.sfbmax;L+=3)na<D[L]&&(na=D[L]);if(!(16>Q&&8>na)){if(7<=S.subblock_gain[H]){L=!0;break b}S.subblock_gain[H]++;Q=M.scalefac_band.l[S.sfb_lmax];for(L=S.sfb_lmax+H;L<S.sfbmax;L+=3)if(na=S.width[L],J=D[L],J-=4>>S.scalefac_scale,0<=J)D[L]=J,Q+=3*na;else{D[L]=0;J=F.IPOW20(210+(J<<S.scalefac_scale+1));Q+=na*(H+1);for(aa=-na;0>aa;aa++)ja[Q+aa]*=J,ja[Q+aa]>S.xrpow_max&&(S.xrpow_max=
ja[Q+aa]);Q+=na*(3-H-1)}J=F.IPOW20(202);Q+=S.width[L]*(H+1);for(aa=-S.width[L];0>aa;aa++)ja[Q+aa]*=J,ja[Q+aa]>S.xrpow_max&&(S.xrpow_max=ja[Q+aa])}}L=!1}M=L||l(A)}M||(M=2==w.mode_gr?fa.scale_bitcount(A):fa.scale_bitcount_lsf(w,A));A=!M}else A=!0;if(!A)break;0!=h.scalefac_scale&&(y=254);A=t-h.part2_length;if(0>=A)break;for(;(h.part2_3_length=fa.count_bits(e,a,h,B))>A&&h.global_gain<=y;)h.global_gain++;if(h.global_gain>y)break;if(0==r.over_count){for(;(h.part2_3_length=fa.count_bits(e,a,h,B))>n&&h.global_gain<=
y;)h.global_gain++;if(h.global_gain>y)break}F.calc_noise(h,q,k,g,B);g.bits=h.part2_3_length;w=b.block_type!=d.SHORT_TYPE?f.quant_comp:f.quant_comp_short;y=r;A=g;M=h;L=k;switch(w){default:case 9:0<y.over_count?(w=A.over_SSD<=y.over_SSD,A.over_SSD==y.over_SSD&&(w=A.bits<y.bits)):w=0>A.max_noise&&10*A.max_noise+A.bits<=10*y.max_noise+y.bits;break;case 0:w=A.over_count<y.over_count||A.over_count==y.over_count&&A.over_noise<y.over_noise||A.over_count==y.over_count&&ra.EQ(A.over_noise,y.over_noise)&&A.tot_noise<
y.tot_noise;break;case 8:w=A;ja=1E-37;for(S=0;S<M.psymax;S++)D=L[S],D=ba.FAST_LOG10(.368+.632*D*D*D),ja+=D;w.max_noise=Math.max(1E-20,ja);case 1:w=A.max_noise<y.max_noise;break;case 2:w=A.tot_noise<y.tot_noise;break;case 3:w=A.tot_noise<y.tot_noise&&A.max_noise<y.max_noise;break;case 4:w=0>=A.max_noise&&.2<y.max_noise||0>=A.max_noise&&0>y.max_noise&&y.max_noise>A.max_noise-.2&&A.tot_noise<y.tot_noise||0>=A.max_noise&&0<y.max_noise&&y.max_noise>A.max_noise-.2&&A.tot_noise<y.tot_noise+y.over_noise||
0<A.max_noise&&-.05<y.max_noise&&y.max_noise>A.max_noise-.1&&A.tot_noise+A.over_noise<y.tot_noise+y.over_noise||0<A.max_noise&&-.1<y.max_noise&&y.max_noise>A.max_noise-.15&&A.tot_noise+A.over_noise+A.over_noise<y.tot_noise+y.over_noise+y.over_noise;break;case 5:w=A.over_noise<y.over_noise||ra.EQ(A.over_noise,y.over_noise)&&A.tot_noise<y.tot_noise;break;case 6:w=A.over_noise<y.over_noise||ra.EQ(A.over_noise,y.over_noise)&&(A.max_noise<y.max_noise||ra.EQ(A.max_noise,y.max_noise)&&A.tot_noise<=y.tot_noise);
break;case 7:w=A.over_count<y.over_count||A.over_noise<y.over_noise}0==y.over_count&&(w=w&&A.bits<y.bits);w=w?1:0;if(0!=w)n=b.part2_3_length,r=g,b.assign(h),m=0,U.arraycopy(a,0,c,0,576);else if(0==e.full_outer_loop){if(++m>u&&0==r.over_count)break;if(3==e.noise_shaping_amp&&x&&30<m)break;if(3==e.noise_shaping_amp&&x&&15<h.global_gain-z)break}}while(255>h.global_gain+h.scalefac_scale);3==e.noise_shaping_amp?x?p=!0:(h.assign(b),U.arraycopy(c,0,a,0,576),m=0,z=h.global_gain,x=!0):p=!0}f.VBR==C.vbr_rh||
f.VBR==C.vbr_mtrh?U.arraycopy(c,0,a,0,576):0!=(e.substep_shaping&1)&&trancate_smallspectrums(e,b,q,a);return r.over_count};this.iteration_finish_one=function(d,b,l){var a=d.l3_side,f=a.tt[b][l];fa.best_scalefac_store(d,b,l,a);1==d.use_best_huffman&&fa.best_huffman_divide(d,f);w.ResvAdjust(d,f)};this.VBR_encode_granule=function(d,b,l,a,m,t,e){var f=d.internal_flags,c=new rb,k=G(576),r=e,q=(e+t)/2,n=0,p=f.sfb21_extra;La.fill(c.l3_enc,0);do{f.sfb21_extra=q>r-42?!1:p;var x=outer_loop(d,b,l,a,m,q);0>=
x?(n=1,e=b.part2_3_length,c.assign(b),U.arraycopy(a,0,k,0,576),e-=32,x=e-t,q=(e+t)/2):(t=q+32,x=e-t,q=(e+t)/2,0!=n&&(n=2,b.assign(c),U.arraycopy(k,0,a,0,576)))}while(12<x);f.sfb21_extra=p;2==n&&U.arraycopy(c.l3_enc,0,b.l3_enc,0,576)};this.get_framebits=function(d,b){var f=d.internal_flags;f.bitrate_index=f.VBR_min_bitrate;t.getframebits(d);f.bitrate_index=1;var a=t.getframebits(d);for(var m=1;m<=f.VBR_max_bitrate;m++)f.bitrate_index=m,a=new Ma(a),b[m]=w.ResvFrameBegin(d,a),a=a.bits};this.VBR_old_prepare=
function(f,b,l,a,m,t,e,h,c){var k=f.internal_flags,r=1,q=0;k.bitrate_index=k.VBR_max_bitrate;var n=w.ResvFrameBegin(f,new Ma(0))/k.mode_gr;get_framebits(f,t);for(var p=0;p<k.mode_gr;p++){var x=F.on_pe(f,b,h[p],n,p,0);k.mode_ext==d.MPG_MD_MS_LR&&(ms_convert(k.l3_side,p),F.reduce_side(h[p],l[p],n,x));for(x=0;x<k.channels_out;++x){var B=k.l3_side.tt[p][x];if(B.block_type!=d.SHORT_TYPE){var g=1.28/(1+Math.exp(3.5-b[p][x]/300))-.05;g=k.PSY.mask_adjust-g}else g=2.56/(1+Math.exp(3.5-b[p][x]/300))-.14,g=
k.PSY.mask_adjust_short-g;k.masking_lower=Math.pow(10,.1*g);init_outer_loop(k,B);c[p][x]=F.calc_xmin(f,a[p][x],B,m[p][x]);0!=c[p][x]&&(r=0);e[p][x]=126;q+=h[p][x]}}for(p=0;p<k.mode_gr;p++)for(x=0;x<k.channels_out;x++)q>t[k.VBR_max_bitrate]&&(h[p][x]*=t[k.VBR_max_bitrate],h[p][x]/=q),e[p][x]>h[p][x]&&(e[p][x]=h[p][x]);return r};this.bitpressure_strategy=function(f,b,l,a){for(var m=0;m<f.mode_gr;m++)for(var q=0;q<f.channels_out;q++){for(var e=f.l3_side.tt[m][q],h=b[m][q],c=0,k=0;k<e.psy_lmax;k++)h[c++]*=
1+.029*k*k/d.SBMAX_l/d.SBMAX_l;if(e.block_type==d.SHORT_TYPE)for(k=e.sfb_smin;k<d.SBMAX_s;k++)h[c++]*=1+.029*k*k/d.SBMAX_s/d.SBMAX_s,h[c++]*=1+.029*k*k/d.SBMAX_s/d.SBMAX_s,h[c++]*=1+.029*k*k/d.SBMAX_s/d.SBMAX_s;a[m][q]=0|Math.max(l[m][q],.9*a[m][q])}};this.VBR_new_prepare=function(f,b,l,a,m,t){var e=f.internal_flags,h=1,c=0,k=0;if(f.free_format){e.bitrate_index=0;c=new Ma(c);var r=w.ResvFrameBegin(f,c);c=c.bits;m[0]=r}else e.bitrate_index=e.VBR_max_bitrate,c=new Ma(c),w.ResvFrameBegin(f,c),c=c.bits,
get_framebits(f,m),r=m[e.VBR_max_bitrate];for(m=0;m<e.mode_gr;m++){F.on_pe(f,b,t[m],c,m,0);e.mode_ext==d.MPG_MD_MS_LR&&ms_convert(e.l3_side,m);for(var q=0;q<e.channels_out;++q){var n=e.l3_side.tt[m][q];e.masking_lower=Math.pow(10,.1*e.PSY.mask_adjust);init_outer_loop(e,n);0!=F.calc_xmin(f,l[m][q],n,a[m][q])&&(h=0);k+=t[m][q]}}for(m=0;m<e.mode_gr;m++)for(q=0;q<e.channels_out;q++)k>r&&(t[m][q]*=r,t[m][q]/=k);return h};this.calc_target_bits=function(f,b,l,a,m,B){var e=f.internal_flags,h=e.l3_side;e.bitrate_index=
e.VBR_max_bitrate;var c=new Ma(0);B[0]=w.ResvFrameBegin(f,c);e.bitrate_index=1;c=t.getframebits(f)-8*e.sideinfo_len;m[0]=c/(e.mode_gr*e.channels_out);c=f.VBR_mean_bitrate_kbps*f.framesize*1E3;0!=(e.substep_shaping&1)&&(c*=1.09);c/=f.out_samplerate;c-=8*e.sideinfo_len;c/=e.mode_gr*e.channels_out;var k=.93+.07*(11-f.compression_ratio)/5.5;.9>k&&(k=.9);1<k&&(k=1);for(f=0;f<e.mode_gr;f++){var r=0;for(m=0;m<e.channels_out;m++){a[f][m]=int(k*c);if(700<b[f][m]){var q=int((b[f][m]-700)/1.4),n=h.tt[f][m];
a[f][m]=int(k*c);n.block_type==d.SHORT_TYPE&&q<c/2&&(q=c/2);q>3*c/2?q=3*c/2:0>q&&(q=0);a[f][m]+=q}a[f][m]>Y.MAX_BITS_PER_CHANNEL&&(a[f][m]=Y.MAX_BITS_PER_CHANNEL);r+=a[f][m]}if(r>Y.MAX_BITS_PER_GRANULE)for(m=0;m<e.channels_out;++m)a[f][m]*=Y.MAX_BITS_PER_GRANULE,a[f][m]/=r}if(e.mode_ext==d.MPG_MD_MS_LR)for(f=0;f<e.mode_gr;f++)F.reduce_side(a[f],l[f],c*e.channels_out,Y.MAX_BITS_PER_GRANULE);for(f=b=0;f<e.mode_gr;f++)for(m=0;m<e.channels_out;m++)a[f][m]>Y.MAX_BITS_PER_CHANNEL&&(a[f][m]=Y.MAX_BITS_PER_CHANNEL),
b+=a[f][m];if(b>B[0])for(f=0;f<e.mode_gr;f++)for(m=0;m<e.channels_out;m++)a[f][m]*=B[0],a[f][m]/=b}}function Gc(){function w(b,d,a){for(var f=10,q=d+238-14-286,e=-15;0>e;e++){var h=l[f+-10];var c=b[q+-224]*h;var k=b[d+224]*h;h=l[f+-9];c+=b[q+-160]*h;k+=b[d+160]*h;h=l[f+-8];c+=b[q+-96]*h;k+=b[d+96]*h;h=l[f+-7];c+=b[q+-32]*h;k+=b[d+32]*h;h=l[f+-6];c+=b[q+32]*h;k+=b[d+-32]*h;h=l[f+-5];c+=b[q+96]*h;k+=b[d+-96]*h;h=l[f+-4];c+=b[q+160]*h;k+=b[d+-160]*h;h=l[f+-3];c+=b[q+224]*h;k+=b[d+-224]*h;h=l[f+-2];c+=
b[d+-256]*h;k-=b[q+256]*h;h=l[f+-1];c+=b[d+-192]*h;k-=b[q+192]*h;h=l[f+0];c+=b[d+-128]*h;k-=b[q+128]*h;h=l[f+1];c+=b[d+-64]*h;k-=b[q+64]*h;h=l[f+2];c+=b[d+0]*h;k-=b[q+0]*h;h=l[f+3];c+=b[d+64]*h;k-=b[q+-64]*h;h=l[f+4];c+=b[d+128]*h;k-=b[q+-128]*h;h=l[f+5];c+=b[d+192]*h;k-=b[q+-192]*h;c*=l[f+6];h=k-c;a[30+2*e]=k+c;a[31+2*e]=l[f+7]*h;f+=18;d--;q++}k=b[d+-16]*l[f+-10];c=b[d+-32]*l[f+-2];k+=(b[d+-48]-b[d+16])*l[f+-9];c+=b[d+-96]*l[f+-1];k+=(b[d+-80]+b[d+48])*l[f+-8];c+=b[d+-160]*l[f+0];k+=(b[d+-112]-b[d+
80])*l[f+-7];c+=b[d+-224]*l[f+1];k+=(b[d+-144]+b[d+112])*l[f+-6];c-=b[d+32]*l[f+2];k+=(b[d+-176]-b[d+144])*l[f+-5];c-=b[d+96]*l[f+3];k+=(b[d+-208]+b[d+176])*l[f+-4];c-=b[d+160]*l[f+4];k+=(b[d+-240]-b[d+208])*l[f+-3];c-=b[d+224];b=c-k;d=c+k;k=a[14];c=a[15]-k;a[31]=d+k;a[30]=b+c;a[15]=b-c;a[14]=d-k;c=a[28]-a[0];a[0]+=a[28];a[28]=c*l[f+-36+7];c=a[29]-a[1];a[1]+=a[29];a[29]=c*l[f+-36+7];c=a[26]-a[2];a[2]+=a[26];a[26]=c*l[f+-72+7];c=a[27]-a[3];a[3]+=a[27];a[27]=c*l[f+-72+7];c=a[24]-a[4];a[4]+=a[24];a[24]=
c*l[f+-108+7];c=a[25]-a[5];a[5]+=a[25];a[25]=c*l[f+-108+7];c=a[22]-a[6];a[6]+=a[22];a[22]=c*ba.SQRT2;c=a[23]-a[7];a[7]+=a[23];a[23]=c*ba.SQRT2-a[7];a[7]-=a[6];a[22]-=a[7];a[23]-=a[22];c=a[6];a[6]=a[31]-c;a[31]+=c;c=a[7];a[7]=a[30]-c;a[30]+=c;c=a[22];a[22]=a[15]-c;a[15]+=c;c=a[23];a[23]=a[14]-c;a[14]+=c;c=a[20]-a[8];a[8]+=a[20];a[20]=c*l[f+-180+7];c=a[21]-a[9];a[9]+=a[21];a[21]=c*l[f+-180+7];c=a[18]-a[10];a[10]+=a[18];a[18]=c*l[f+-216+7];c=a[19]-a[11];a[11]+=a[19];a[19]=c*l[f+-216+7];c=a[16]-a[12];
a[12]+=a[16];a[16]=c*l[f+-252+7];c=a[17]-a[13];a[13]+=a[17];a[17]=c*l[f+-252+7];c=-a[20]+a[24];a[20]+=a[24];a[24]=c*l[f+-216+7];c=-a[21]+a[25];a[21]+=a[25];a[25]=c*l[f+-216+7];c=a[4]-a[8];a[4]+=a[8];a[8]=c*l[f+-216+7];c=a[5]-a[9];a[5]+=a[9];a[9]=c*l[f+-216+7];c=a[0]-a[12];a[0]+=a[12];a[12]=c*l[f+-72+7];c=a[1]-a[13];a[1]+=a[13];a[13]=c*l[f+-72+7];c=a[16]-a[28];a[16]+=a[28];a[28]=c*l[f+-72+7];c=-a[17]+a[29];a[17]+=a[29];a[29]=c*l[f+-72+7];c=ba.SQRT2*(a[2]-a[10]);a[2]+=a[10];a[10]=c;c=ba.SQRT2*(a[3]-
a[11]);a[3]+=a[11];a[11]=c;c=ba.SQRT2*(-a[18]+a[26]);a[18]+=a[26];a[26]=c-a[18];c=ba.SQRT2*(-a[19]+a[27]);a[19]+=a[27];a[27]=c-a[19];c=a[2];a[19]-=a[3];a[3]-=c;a[2]=a[31]-c;a[31]+=c;c=a[3];a[11]-=a[19];a[18]-=c;a[3]=a[30]-c;a[30]+=c;c=a[18];a[27]-=a[11];a[19]-=c;a[18]=a[15]-c;a[15]+=c;c=a[19];a[10]-=c;a[19]=a[14]-c;a[14]+=c;c=a[10];a[11]-=c;a[10]=a[23]-c;a[23]+=c;c=a[11];a[26]-=c;a[11]=a[22]-c;a[22]+=c;c=a[26];a[27]-=c;a[26]=a[7]-c;a[7]+=c;c=a[27];a[27]=a[6]-c;a[6]+=c;c=ba.SQRT2*(a[0]-a[4]);a[0]+=
a[4];a[4]=c;c=ba.SQRT2*(a[1]-a[5]);a[1]+=a[5];a[5]=c;c=ba.SQRT2*(a[16]-a[20]);a[16]+=a[20];a[20]=c;c=ba.SQRT2*(a[17]-a[21]);a[17]+=a[21];a[21]=c;c=-ba.SQRT2*(a[8]-a[12]);a[8]+=a[12];a[12]=c-a[8];c=-ba.SQRT2*(a[9]-a[13]);a[9]+=a[13];a[13]=c-a[9];c=-ba.SQRT2*(a[25]-a[29]);a[25]+=a[29];a[29]=c-a[25];c=-ba.SQRT2*(a[24]+a[28]);a[24]-=a[28];a[28]=c-a[24];c=a[24]-a[16];a[24]=c;c=a[20]-c;a[20]=c;c=a[28]-c;a[28]=c;c=a[25]-a[17];a[25]=c;c=a[21]-c;a[21]=c;c=a[29]-c;a[29]=c;c=a[17]-a[1];a[17]=c;c=a[9]-c;a[9]=
c;c=a[25]-c;a[25]=c;c=a[5]-c;a[5]=c;c=a[21]-c;a[21]=c;c=a[13]-c;a[13]=c;c=a[29]-c;a[29]=c;c=a[1]-a[0];a[1]=c;c=a[16]-c;a[16]=c;c=a[17]-c;a[17]=c;c=a[8]-c;a[8]=c;c=a[9]-c;a[9]=c;c=a[24]-c;a[24]=c;c=a[25]-c;a[25]=c;c=a[4]-c;a[4]=c;c=a[5]-c;a[5]=c;c=a[20]-c;a[20]=c;c=a[21]-c;a[21]=c;c=a[12]-c;a[12]=c;c=a[13]-c;a[13]=c;c=a[28]-c;a[28]=c;c=a[29]-c;a[29]=c;c=a[0];a[0]+=a[31];a[31]-=c;c=a[1];a[1]+=a[30];a[30]-=c;c=a[16];a[16]+=a[15];a[15]-=c;c=a[17];a[17]+=a[14];a[14]-=c;c=a[8];a[8]+=a[23];a[23]-=c;c=a[9];
a[9]+=a[22];a[22]-=c;c=a[24];a[24]+=a[7];a[7]-=c;c=a[25];a[25]+=a[6];a[6]-=c;c=a[4];a[4]+=a[27];a[27]-=c;c=a[5];a[5]+=a[26];a[26]-=c;c=a[20];a[20]+=a[11];a[11]-=c;c=a[21];a[21]+=a[10];a[10]-=c;c=a[12];a[12]+=a[19];a[19]-=c;c=a[13];a[13]+=a[18];a[18]-=c;c=a[28];a[28]+=a[3];a[3]-=c;c=a[29];a[29]+=a[2];a[2]-=c}var l=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,
709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,
304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,
5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,
289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,
4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,
241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,
3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,
155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,
2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,
36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.0178904535*ba.SQRT2/2.384E-6,.008938074*ba.SQRT2/2.384E-6,.0015673635*ba.SQRT2/2.384E-6,.001228571*ba.SQRT2/2.384E-6,4.856585E-4*ba.SQRT2/2.384E-6,1.09434E-4*ba.SQRT2/2.384E-6,5.0783E-5*ba.SQRT2/2.384E-6,
6.914E-6*ba.SQRT2/2.384E-6,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=[[2.382191739347913E-13,6.423305872147834E-13,9.400849094049688E-13,1.122435026096556E-12,1.183840321267481E-12,1.122435026096556E-12,9.40084909404969E-13,6.423305872147839E-13,2.382191739347918E-13,5.456116108943412E-12,4.878985199565852E-12,4.240448995017367E-12,3.559909094758252E-12,2.858043359288075E-12,2.156177623817898E-12,1.475637723558783E-12,
8.371015190102974E-13,2.599706096327376E-13,-5.456116108943412E-12,-4.878985199565852E-12,-4.240448995017367E-12,-3.559909094758252E-12,-2.858043359288076E-12,-2.156177623817898E-12,-1.475637723558783E-12,-8.371015190102975E-13,-2.599706096327376E-13,-2.382191739347923E-13,-6.423305872147843E-13,-9.400849094049696E-13,-1.122435026096556E-12,-1.183840321267481E-12,-1.122435026096556E-12,-9.400849094049694E-13,-6.42330587214784E-13,-2.382191739347918E-13],[2.382191739347913E-13,6.423305872147834E-13,
9.400849094049688E-13,1.122435026096556E-12,1.183840321267481E-12,1.122435026096556E-12,9.400849094049688E-13,6.423305872147841E-13,2.382191739347918E-13,5.456116108943413E-12,4.878985199565852E-12,4.240448995017367E-12,3.559909094758253E-12,2.858043359288075E-12,2.156177623817898E-12,1.475637723558782E-12,8.371015190102975E-13,2.599706096327376E-13,-5.461314069809755E-12,-4.921085770524055E-12,-4.343405037091838E-12,-3.732668368707687E-12,-3.093523840190885E-12,-2.430835727329465E-12,-1.734679010007751E-12,
-9.74825365660928E-13,-2.797435120168326E-13,0,0,0,0,0,0,-2.283748241799531E-13,-4.037858874020686E-13,-2.146547464825323E-13],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,
-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2.283748241799531E-13,4.037858874020686E-13,2.146547464825323E-13,5.461314069809755E-12,4.921085770524055E-12,4.343405037091838E-12,3.732668368707687E-12,3.093523840190885E-12,2.430835727329466E-12,1.734679010007751E-12,9.74825365660928E-13,
2.797435120168326E-13,-5.456116108943413E-12,-4.878985199565852E-12,-4.240448995017367E-12,-3.559909094758253E-12,-2.858043359288075E-12,-2.156177623817898E-12,-1.475637723558782E-12,-8.371015190102975E-13,-2.599706096327376E-13,-2.382191739347913E-13,-6.423305872147834E-13,-9.400849094049688E-13,-1.122435026096556E-12,-1.183840321267481E-12,-1.122435026096556E-12,-9.400849094049688E-13,-6.423305872147841E-13,-2.382191739347918E-13]],W=t[d.SHORT_TYPE],F=t[d.SHORT_TYPE],B=t[d.SHORT_TYPE],C=t[d.SHORT_TYPE],
f=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];this.mdct_sub48=function(b,l,a){for(var m=286,q=0;q<b.channels_out;q++){for(var e=0;e<b.mode_gr;e++){for(var h,c=b.l3_side.tt[e][q],k=c.xr,r=0,v=b.sb_sample[q][1-e],n=0,p=0;9>p;p++)for(w(l,m,v[n]),w(l,m+32,v[n+1]),n+=2,m+=64,h=1;32>h;h+=2)v[n-1][h]*=-1;for(h=0;32>h;h++,r+=18){v=c.block_type;n=b.sb_sample[q][e];var x=b.sb_sample[q][1-e];0!=c.mixed_block_flag&&2>h&&(v=0);if(1E-12>b.amp_filter[h])La.fill(k,r+0,
r+18,0);else{if(1>b.amp_filter[h])for(p=0;18>p;p++)x[p][f[h]]*=b.amp_filter[h];if(v==d.SHORT_TYPE){for(p=-3;0>p;p++){var I=t[d.SHORT_TYPE][p+3];k[r+3*p+9]=n[9+p][f[h]]*I-n[8-p][f[h]];k[r+3*p+18]=n[14-p][f[h]]*I+n[15+p][f[h]];k[r+3*p+10]=n[15+p][f[h]]*I-n[14-p][f[h]];k[r+3*p+19]=x[2-p][f[h]]*I+x[3+p][f[h]];k[r+3*p+11]=x[3+p][f[h]]*I-x[2-p][f[h]];k[r+3*p+20]=x[8-p][f[h]]*I+x[9+p][f[h]]}p=k;n=r;for(I=0;3>I;I++){var g=p[n+6]*t[d.SHORT_TYPE][0]-p[n+15];x=p[n+0]*t[d.SHORT_TYPE][2]-p[n+9];var u=g+x;var y=
g-x;g=p[n+15]*t[d.SHORT_TYPE][0]+p[n+6];x=p[n+9]*t[d.SHORT_TYPE][2]+p[n+0];var A=g+x;var T=-g+x;x=2.069978111953089E-11*(p[n+3]*t[d.SHORT_TYPE][1]-p[n+12]);g=2.069978111953089E-11*(p[n+12]*t[d.SHORT_TYPE][1]+p[n+3]);p[n+0]=1.90752519173728E-11*u+x;p[n+15]=1.90752519173728E-11*-A+g;y*=1.6519652744032674E-11;A=9.537625958686404E-12*A+g;p[n+3]=y-A;p[n+6]=y+A;u=9.537625958686404E-12*u-x;T*=1.6519652744032674E-11;p[n+9]=u+T;p[n+12]=u-T;n++}}else{I=G(18);for(p=-9;0>p;p++)u=t[v][p+27]*x[p+9][f[h]]+t[v][p+
36]*x[8-p][f[h]],y=t[v][p+9]*n[p+9][f[h]]-t[v][p+18]*n[8-p][f[h]],I[p+9]=u-y*W[3+p+9],I[p+18]=u*W[3+p+9]+y;p=k;n=r;u=I;var L=u[17]-u[9];var S=u[15]-u[11];var ja=u[14]-u[12];T=u[0]+u[8];A=u[1]+u[7];g=u[2]+u[6];y=u[3]+u[5];p[n+17]=T+g-y-(A-u[4]);I=(T+g-y)*F[19]+(A-u[4]);x=(L-S-ja)*F[18];p[n+5]=x+I;p[n+6]=x-I;var D=(u[16]-u[10])*F[18];A=A*F[19]+u[4];x=L*F[12]+D+S*F[13]+ja*F[14];I=-T*F[16]+A-g*F[17]+y*F[15];p[n+1]=x+I;p[n+2]=x-I;x=L*F[13]-D-S*F[14]+ja*F[12];I=-T*F[17]+A-g*F[15]+y*F[16];p[n+9]=x+I;p[n+
10]=x-I;x=L*F[14]-D+S*F[12]-ja*F[13];I=T*F[15]-A+g*F[16]-y*F[17];p[n+13]=x+I;p[n+14]=x-I;L=u[8]-u[0];S=u[6]-u[2];ja=u[5]-u[3];T=u[17]+u[9];A=u[16]+u[10];g=u[15]+u[11];y=u[14]+u[12];p[n+0]=T+g+y+(A+u[13]);x=(T+g+y)*F[19]-(A+u[13]);I=(L-S+ja)*F[18];p[n+11]=x+I;p[n+12]=x-I;D=(u[7]-u[1])*F[18];A=u[13]-A*F[19];x=T*F[15]-A+g*F[16]+y*F[17];I=L*F[14]+D+S*F[12]+ja*F[13];p[n+3]=x+I;p[n+4]=x-I;x=-T*F[17]+A-g*F[15]-y*F[16];I=L*F[13]+D-S*F[14]-ja*F[12];p[n+7]=x+I;p[n+8]=x-I;x=-T*F[16]+A-g*F[17]-y*F[15];I=L*F[12]-
D+S*F[13]-ja*F[14];p[n+15]=x+I;p[n+16]=x-I}}if(v!=d.SHORT_TYPE&&0!=h)for(p=7;0<=p;--p)v=k[r+p]*B[20+p]+k[r+-1-p]*C[28+p],n=k[r+p]*C[28+p]-k[r+-1-p]*B[20+p],k[r+-1-p]=v,k[r+p]=n}}l=a;m=286;if(1==b.mode_gr)for(e=0;18>e;e++)U.arraycopy(b.sb_sample[q][1][e],0,b.sb_sample[q][0][e],0,32)}}}function Wa(){this.thm=new Wb;this.en=new Wb}function d(){var v=d.FFTOFFSET,l=d.MPG_MD_MS_LR,t=null,w=this.psy=null,F=null,B=null;this.setModules=function(d,b,l,a){t=d;w=this.psy=b;F=a;B=l};var fa=new Gc;this.lame_encode_mp3_frame=
function(f,b,q,a,m,z){var e=Nb([2,2]);e[0][0]=new Wa;e[0][1]=new Wa;e[1][0]=new Wa;e[1][1]=new Wa;var h=Nb([2,2]);h[0][0]=new Wa;h[0][1]=new Wa;h[1][0]=new Wa;h[1][1]=new Wa;var c=[null,null],k=f.internal_flags,r=V([2,4]),E=[.5,.5],n=[[0,0],[0,0]],p=[[0,0],[0,0]];c[0]=b;c[1]=q;if(0==k.lame_encode_frame_init){b=f.internal_flags;var x,I;if(0==b.lame_encode_frame_init){q=G(2014);var g=G(2014);b.lame_encode_frame_init=1;for(I=x=0;x<286+576*(1+b.mode_gr);++x)x<576*b.mode_gr?(q[x]=0,2==b.channels_out&&
(g[x]=0)):(q[x]=c[0][I],2==b.channels_out&&(g[x]=c[1][I]),++I);for(I=0;I<b.mode_gr;I++)for(x=0;x<b.channels_out;x++)b.l3_side.tt[I][x].block_type=d.SHORT_TYPE;fa.mdct_sub48(b,q,g)}}k.padding=0;0>(k.slot_lag-=k.frac_SpF)&&(k.slot_lag+=f.out_samplerate,k.padding=1);if(0!=k.psymodel)for(g=[null,null],x=0,I=P(2),q=0;q<k.mode_gr;q++){for(b=0;b<k.channels_out;b++)g[b]=c[b],x=576+576*q-d.FFTOFFSET;b=f.VBR==C.vbr_mtrh||f.VBR==C.vbr_mt?w.L3psycho_anal_vbr(f,g,x,q,e,h,n[q],p[q],r[q],I):w.L3psycho_anal_ns(f,
g,x,q,e,h,n[q],p[q],r[q],I);if(0!=b)return-4;f.mode==da.JOINT_STEREO&&(E[q]=r[q][2]+r[q][3],0<E[q]&&(E[q]=r[q][3]/E[q]));for(b=0;b<k.channels_out;b++){var u=k.l3_side.tt[q][b];u.block_type=I[b];u.mixed_block_flag=0}}else for(q=0;q<k.mode_gr;q++)for(b=0;b<k.channels_out;b++)k.l3_side.tt[q][b].block_type=d.NORM_TYPE,k.l3_side.tt[q][b].mixed_block_flag=0,p[q][b]=n[q][b]=700;0==k.ATH.useAdjust?k.ATH.adjust=1:(b=k.loudness_sq[0][0],r=k.loudness_sq[1][0],2==k.channels_out?(b+=k.loudness_sq[0][1],r+=k.loudness_sq[1][1]):
(b+=b,r+=r),2==k.mode_gr&&(b=Math.max(b,r)),b=.5*b*k.ATH.aaSensitivityP,.03125<b?(1<=k.ATH.adjust?k.ATH.adjust=1:k.ATH.adjust<k.ATH.adjustLimit&&(k.ATH.adjust=k.ATH.adjustLimit),k.ATH.adjustLimit=1):(r=31.98*b+6.25E-4,k.ATH.adjust>=r?(k.ATH.adjust*=.075*r+.925,k.ATH.adjust<r&&(k.ATH.adjust=r)):k.ATH.adjustLimit>=r?k.ATH.adjust=r:k.ATH.adjust<k.ATH.adjustLimit&&(k.ATH.adjust=k.ATH.adjustLimit),k.ATH.adjustLimit=r));fa.mdct_sub48(k,c[0],c[1]);k.mode_ext=d.MPG_MD_LR_LR;if(f.force_ms)k.mode_ext=d.MPG_MD_MS_LR;
else if(f.mode==da.JOINT_STEREO){for(q=g=r=0;q<k.mode_gr;q++)for(b=0;b<k.channels_out;b++)r+=p[q][b],g+=n[q][b];r<=1*g&&(r=k.l3_side.tt[0],b=k.l3_side.tt[k.mode_gr-1],r[0].block_type==r[1].block_type&&b[0].block_type==b[1].block_type&&(k.mode_ext=d.MPG_MD_MS_LR))}k.mode_ext==l&&(e=h,n=p);if(f.analysis&&null!=k.pinfo)for(q=0;q<k.mode_gr;q++)for(b=0;b<k.channels_out;b++)k.pinfo.ms_ratio[q]=k.ms_ratio[q],k.pinfo.ms_ener_ratio[q]=E[q],k.pinfo.blocktype[q][b]=k.l3_side.tt[q][b].block_type,k.pinfo.pe[q][b]=
n[q][b],U.arraycopy(k.l3_side.tt[q][b].xr,0,k.pinfo.xr[q][b],0,576),k.mode_ext==l&&(k.pinfo.ers[q][b]=k.pinfo.ers[q][b+2],U.arraycopy(k.pinfo.energy[q][b+2],0,k.pinfo.energy[q][b],0,k.pinfo.energy[q][b].length));if(f.VBR==C.vbr_off||f.VBR==C.vbr_abr){for(h=0;18>h;h++)k.nsPsy.pefirbuf[h]=k.nsPsy.pefirbuf[h+1];for(q=p=0;q<k.mode_gr;q++)for(b=0;b<k.channels_out;b++)p+=n[q][b];k.nsPsy.pefirbuf[18]=p;p=k.nsPsy.pefirbuf[9];for(h=0;9>h;h++)p+=(k.nsPsy.pefirbuf[h]+k.nsPsy.pefirbuf[18-h])*d.fircoef[h];p=3350*
k.mode_gr*k.channels_out/p;for(q=0;q<k.mode_gr;q++)for(b=0;b<k.channels_out;b++)n[q][b]*=p}k.iteration_loop.iteration_loop(f,n,E,e);t.format_bitstream(f);a=t.copy_buffer(k,a,m,z,1);f.bWriteVbrTag&&F.addVbrFrame(f);if(f.analysis&&null!=k.pinfo){for(b=0;b<k.channels_out;b++){for(m=0;m<v;m++)k.pinfo.pcmdata[b][m]=k.pinfo.pcmdata[b][m+f.framesize];for(m=v;1600>m;m++)k.pinfo.pcmdata[b][m]=c[b][m-v]}B.set_frame_pinfo(f,e)}k.bitrate_stereoMode_Hist[k.bitrate_index][4]++;k.bitrate_stereoMode_Hist[15][4]++;
2==k.channels_out&&(k.bitrate_stereoMode_Hist[k.bitrate_index][k.mode_ext]++,k.bitrate_stereoMode_Hist[15][k.mode_ext]++);for(f=0;f<k.mode_gr;++f)for(c=0;c<k.channels_out;++c)m=k.l3_side.tt[f][c].block_type|0,0!=k.l3_side.tt[f][c].mixed_block_flag&&(m=4),k.bitrate_blockType_Hist[k.bitrate_index][m]++,k.bitrate_blockType_Hist[k.bitrate_index][5]++,k.bitrate_blockType_Hist[15][m]++,k.bitrate_blockType_Hist[15][5]++;return a}}function Hc(){this.size=this.pos=this.want=this.seen=this.sum=0;this.bag=null;
this.TotalFrameSize=this.nBytesWritten=this.nVbrNumFrames=0}function Ic(){this.tt=[[null,null],[null,null]];this.resvDrain_post=this.resvDrain_pre=this.private_bits=this.main_data_begin=0;this.scfsi=[P(4),P(4)];for(var d=0;2>d;d++)for(var l=0;2>l;l++)this.tt[d][l]=new rb}function Wb(){this.l=G(d.SBMAX_l);this.s=V([d.SBMAX_s,3]);var w=this;this.assign=function(l){U.arraycopy(l.l,0,w.l,0,d.SBMAX_l);for(var t=0;t<d.SBMAX_s;t++)for(var v=0;3>v;v++)w.s[t][v]=l.s[t][v]}}function Jc(){this.last_en_subshort=
V([4,9]);this.lastAttacks=P(4);this.pefirbuf=G(19);this.longfact=G(d.SBMAX_l);this.shortfact=G(d.SBMAX_s);this.attackthre_s=this.attackthre=0}function Y(){function w(){this.ptr=this.write_timing=0;this.buf=new Int8Array(40)}this.fill_buffer_resample_init=this.iteration_init_init=this.lame_encode_frame_init=this.Class_ID=0;this.mfbuf=V([2,Y.MFSIZE]);this.full_outer_loop=this.use_best_huffman=this.subblock_gain=this.noise_shaping_stop=this.psymodel=this.substep_shaping=this.noise_shaping_amp=this.noise_shaping=
this.highpass2=this.highpass1=this.lowpass2=this.lowpass1=this.mode_ext=this.samplerate_index=this.bitrate_index=this.VBR_max_bitrate=this.VBR_min_bitrate=this.mf_size=this.mf_samples_to_encode=this.resample_ratio=this.channels_out=this.channels_in=this.mode_gr=0;this.l3_side=new Ic;this.ms_ratio=G(2);this.slot_lag=this.frac_SpF=this.padding=0;this.tag_spec=null;this.nMusicCRC=0;this.OldValue=P(2);this.CurrentStep=P(2);this.masking_lower=0;this.bv_scf=P(576);this.pseudohalf=P(ta.SFBMAX);this.sfb21_extra=
!1;this.inbuf_old=Array(2);this.blackfilt=Array(2*Y.BPC+1);this.itime=new Float64Array(2);this.sideinfo_len=0;this.sb_sample=V([2,2,18,d.SBLIMIT]);this.amp_filter=G(32);this.header=Array(Y.MAX_HEADER_BUF);this.ResvMax=this.ResvSize=this.ancillary_flag=this.w_ptr=this.h_ptr=0;this.scalefac_band=new sa;this.minval_l=G(d.CBANDS);this.minval_s=G(d.CBANDS);this.nb_1=V([4,d.CBANDS]);this.nb_2=V([4,d.CBANDS]);this.nb_s1=V([4,d.CBANDS]);this.nb_s2=V([4,d.CBANDS]);this.s3_ll=this.s3_ss=null;this.decay=0;this.thm=
Array(4);this.en=Array(4);this.tot_ener=G(4);this.loudness_sq=V([2,2]);this.loudness_sq_save=G(2);this.mld_l=G(d.SBMAX_l);this.mld_s=G(d.SBMAX_s);this.bm_l=P(d.SBMAX_l);this.bo_l=P(d.SBMAX_l);this.bm_s=P(d.SBMAX_s);this.bo_s=P(d.SBMAX_s);this.npart_s=this.npart_l=0;this.s3ind=Ba([d.CBANDS,2]);this.s3ind_s=Ba([d.CBANDS,2]);this.numlines_s=P(d.CBANDS);this.numlines_l=P(d.CBANDS);this.rnumlines_l=G(d.CBANDS);this.mld_cb_l=G(d.CBANDS);this.mld_cb_s=G(d.CBANDS);this.numlines_l_num1=this.numlines_s_num1=
0;this.pe=G(4);this.ms_ener_ratio_old=this.ms_ratio_l_old=this.ms_ratio_s_old=0;this.blocktype_old=P(2);this.nsPsy=new Jc;this.VBR_seek_table=new Hc;this.PSY=this.ATH=null;this.nogap_current=this.nogap_total=0;this.findPeakSample=this.findReplayGain=this.decode_on_the_fly=!0;this.AudiophileGain=this.RadioGain=this.PeakSample=0;this.rgdata=null;this.noclipScale=this.noclipGainChange=0;this.bitrate_stereoMode_Hist=Ba([16,5]);this.bitrate_blockType_Hist=Ba([16,6]);this.hip=this.pinfo=null;this.in_buffer_nsamples=
0;this.iteration_loop=this.in_buffer_1=this.in_buffer_0=null;for(var l=0;l<this.en.length;l++)this.en[l]=new Wb;for(l=0;l<this.thm.length;l++)this.thm[l]=new Wb;for(l=0;l<this.header.length;l++)this.header[l]=new w}function Kc(){function w(d,l,f){var b=0;f<<=1;var q=l+f;var a=4;do{var m;var t=a>>1;var e=a;var h=a<<1;var c=h+e;a=h<<1;var k=l;var r=k+t;do{var w=d[k+0]-d[k+e];var n=d[k+0]+d[k+e];var p=d[k+h]-d[k+c];var x=d[k+h]+d[k+c];d[k+h]=n-x;d[k+0]=n+x;d[k+c]=w-p;d[k+e]=w+p;w=d[r+0]-d[r+e];n=d[r+
0]+d[r+e];p=ba.SQRT2*d[r+c];x=ba.SQRT2*d[r+h];d[r+h]=n-x;d[r+0]=n+x;d[r+c]=w-p;d[r+e]=w+p;r+=a;k+=a}while(k<q);var v=C[b+0];var g=C[b+1];for(m=1;m<t;m++){var u=1-2*g*g;var y=2*g*v;k=l+m;r=l+e-m;do{var A=y*d[k+e]-u*d[r+e];x=u*d[k+e]+y*d[r+e];w=d[k+0]-x;n=d[k+0]+x;var B=d[r+0]-A;var F=d[r+0]+A;A=y*d[k+c]-u*d[r+c];x=u*d[k+c]+y*d[r+c];p=d[k+h]-x;x=d[k+h]+x;var S=d[r+h]-A;var G=d[r+h]+A;A=g*x-v*S;x=v*x+g*S;d[k+h]=n-x;d[k+0]=n+x;d[r+c]=B-A;d[r+e]=B+A;A=v*G-g*p;x=g*G+v*p;d[r+h]=F-x;d[r+0]=F+x;d[k+c]=w-A;
d[k+e]=w+A;r+=a;k+=a}while(k<q);u=v;v=u*C[b+0]-g*C[b+1];g=u*C[b+1]+g*C[b+0]}b+=2}while(a<f)}var l=G(d.BLKSIZE),t=G(d.BLKSIZE_s/2),C=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475],F=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,
124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(l,v,f,b,q){for(l=0;3>l;l++){var a=d.BLKSIZE_s/2,m=65535&192*(l+1),B=d.BLKSIZE_s/8-1;do{var e=F[B<<2]&255;var h=t[e]*b[f][q+e+m];var c=t[127-e]*b[f][q+e+m+128];var k=h-c;h+=c;var r=t[e+64]*b[f][q+e+m+64];c=t[63-e]*b[f][q+e+m+192];var G=r-c;
r+=c;a-=4;v[l][a+0]=h+r;v[l][a+2]=h-r;v[l][a+1]=k+G;v[l][a+3]=k-G;h=t[e+1]*b[f][q+e+m+1];c=t[126-e]*b[f][q+e+m+129];k=h-c;h+=c;r=t[e+65]*b[f][q+e+m+65];c=t[62-e]*b[f][q+e+m+193];G=r-c;r+=c;v[l][a+d.BLKSIZE_s/2+0]=h+r;v[l][a+d.BLKSIZE_s/2+2]=h-r;v[l][a+d.BLKSIZE_s/2+1]=k+G;v[l][a+d.BLKSIZE_s/2+3]=k-G}while(0<=--B);w(v[l],a,d.BLKSIZE_s/2)}};this.fft_long=function(t,v,f,b,q){t=d.BLKSIZE/8-1;var a=d.BLKSIZE/2;do{var m=F[t]&255;var B=l[m]*b[f][q+m];var e=l[m+512]*b[f][q+m+512];var h=B-e;B+=e;var c=l[m+
256]*b[f][q+m+256];e=l[m+768]*b[f][q+m+768];var k=c-e;c+=e;a-=4;v[a+0]=B+c;v[a+2]=B-c;v[a+1]=h+k;v[a+3]=h-k;B=l[m+1]*b[f][q+m+1];e=l[m+513]*b[f][q+m+513];h=B-e;B+=e;c=l[m+257]*b[f][q+m+257];e=l[m+769]*b[f][q+m+769];k=c-e;c+=e;v[a+d.BLKSIZE/2+0]=B+c;v[a+d.BLKSIZE/2+2]=B-c;v[a+d.BLKSIZE/2+1]=h+k;v[a+d.BLKSIZE/2+3]=h-k}while(0<=--t);w(v,a,d.BLKSIZE/2)};this.init_fft=function(v){for(v=0;v<d.BLKSIZE;v++)l[v]=.42-.5*Math.cos(2*Math.PI*(v+.5)/d.BLKSIZE)+.08*Math.cos(4*Math.PI*(v+.5)/d.BLKSIZE);for(v=0;v<
d.BLKSIZE_s/2;v++)t[v]=.5*(1-Math.cos(2*Math.PI*(v+.5)/d.BLKSIZE_s))}}function Pb(){function v(a,c){for(var b=0,g=0;g<d.BLKSIZE/2;++g)b+=a[g]*c.ATH.eql_w[g];return b*=E}function l(a,b,c,d,f,e){if(b>a)if(b<a*p)var h=b/a;else return a+b;else{if(a>=b*p)return a+b;h=a/b}a+=b;if(6>=d+3){if(h>=n)return a;d=0|ba.FAST_LOG10_X(h,16);return a*u[d]}d=0|ba.FAST_LOG10_X(h,16);b=0!=e?f.ATH.cb_s[c]*f.ATH.adjust:f.ATH.cb_l[c]*f.ATH.adjust;return a<x*b?a>b?(c=1,13>=d&&(c=y[d]),b=ba.FAST_LOG10_X(a/b,10/15),a*((g[d]-
c)*b+c)):13<d?a:a*y[d]:a*g[d]}function t(a,b,c){0>a&&(a=0);0>b&&(b=0);if(0>=a)return b;if(0>=b)return a;var d=b>a?b/a:a/b;if(-2<=c&&2>=c){if(d>=n)return a+b;c=0|ba.FAST_LOG10_X(d,16);return(a+b)*A[c]}if(d<p)return a+b;a<b&&(a=b);return a}function w(a,b,c,g,f){var e,h,k=0,l=0;for(e=h=0;e<d.SBMAX_s;++h,++e){var m=a.bo_s[e],y=a.npart_s;for(m=m<y?m:y;h<m;)k+=b[h],l+=c[h],h++;a.en[g].s[e][f]=k;a.thm[g].s[e][f]=l;if(h>=y){++e;break}l=a.PSY.bo_s_weight[e];y=1-l;k=l*b[h];l*=c[h];a.en[g].s[e][f]+=k;a.thm[g].s[e][f]+=
l;k=y*b[h];l=y*c[h]}for(;e<d.SBMAX_s;++e)a.en[g].s[e][f]=0,a.thm[g].s[e][f]=0}function F(a,b,c,g){var f,e,h=0,k=0;for(f=e=0;f<d.SBMAX_l;++e,++f){var l=a.bo_l[f],y=a.npart_l;for(l=l<y?l:y;e<l;)h+=b[e],k+=c[e],e++;a.en[g].l[f]=h;a.thm[g].l[f]=k;if(e>=y){++f;break}k=a.PSY.bo_l_weight[f];y=1-k;h=k*b[e];k*=c[e];a.en[g].l[f]+=h;a.thm[g].l[f]+=k;h=y*b[e];k=y*c[e]}for(;f<d.SBMAX_l;++f)a.en[g].l[f]=0,a.thm[g].l[f]=0}function B(a,b,c){return 1<=c?a:0>=c?b:0<b?Math.pow(a/b,c)*b:0}function X(a,b){for(var c=309.07,
g=0;g<d.SBMAX_s-1;g++)for(var f=0;3>f;f++){var e=a.thm.s[g][f];if(0<e){e*=b;var h=a.en.s[g][f];h>e&&(c=h>1E10*e?c+23.02585092994046*T[g]:c+T[g]*ba.FAST_LOG10(h/e))}}return c}function f(a,b){for(var c=281.0575,g=0;g<d.SBMAX_l-1;g++){var f=a.thm.l[g];if(0<f){f*=b;var e=a.en.l[g];e>f&&(c=e>1E10*f?c+23.02585092994046*L[g]:c+L[g]*ba.FAST_LOG10(e/f))}}return c}function b(a,b,c,d,g){var f,e;for(f=e=0;f<a.npart_l;++f){var h=0,k=0,l;for(l=0;l<a.numlines_l[f];++l,++e){var y=b[e];h+=y;k<y&&(k=y)}c[f]=h;d[f]=
k;g[f]=h*a.rnumlines_l[f]}}function q(a,b,c,d){var g=I.length-1,f=0,e=c[f]+c[f+1];if(0<e){var h=b[f];h<b[f+1]&&(h=b[f+1]);e=20*(2*h-e)/(e*(a.numlines_l[f]+a.numlines_l[f+1]-1));e|=0;e>g&&(e=g);d[f]=e}else d[f]=0;for(f=1;f<a.npart_l-1;f++)e=c[f-1]+c[f]+c[f+1],0<e?(h=b[f-1],h<b[f]&&(h=b[f]),h<b[f+1]&&(h=b[f+1]),e=20*(3*h-e)/(e*(a.numlines_l[f-1]+a.numlines_l[f]+a.numlines_l[f+1]-1)),e|=0,e>g&&(e=g),d[f]=e):d[f]=0;e=c[f-1]+c[f];0<e?(h=b[f-1],h<b[f]&&(h=b[f]),e=20*(2*h-e)/(e*(a.numlines_l[f-1]+a.numlines_l[f]-
1)),e|=0,e>g&&(e=g),d[f]=e):d[f]=0}function a(a,b,c,d,g,f,e){var h=2*f;g=0<f?Math.pow(10,g):1;for(var k,l,y=0;y<e;++y){var m=a[2][y],p=a[3][y],n=b[0][y],r=b[1][y],u=b[2][y],q=b[3][y];n<=1.58*r&&r<=1.58*n?(k=c[y]*m,l=Math.max(u,Math.min(q,c[y]*p)),k=Math.max(q,Math.min(u,k))):(l=u,k=q);0<f&&(q=d[y]*g,n=Math.min(Math.max(n,q),Math.max(r,q)),u=Math.max(l,q),q=Math.max(k,q),r=u+q,0<r&&n*h<r&&(n=n*h/r,u*=n,q*=n),l=Math.min(u,l),k=Math.min(q,k));l>m&&(l=m);k>p&&(k=p);b[2][y]=l;b[3][y]=k}}function m(a,b){var c=
0<=a?27*-a:a*b;return-72>=c?0:Math.exp(.2302585093*c)}function z(a){0>a&&(a=0);a*=.001;return 13*Math.atan(.76*a)+3.5*Math.atan(a*a/56.25)}function e(a,b,c,g,f,e,h,k,l,y,m,p){var n=G(d.CBANDS+1),r=k/(15<p?1152:384),q=P(d.HBLKSIZE),u;k/=l;var t=0,v=0;for(u=0;u<d.CBANDS;u++){var x;var w=z(k*t);n[u]=k*t;for(x=t;.34>z(k*x)-w&&x<=l/2;x++);a[u]=x-t;for(v=u+1;t<x;)q[t++]=u;if(t>l/2){t=l/2;++u;break}}n[u]=k*t;for(t=0;t<p;t++)u=y[t],w=y[t+1],u=0|Math.floor(.5+m*(u-.5)),0>u&&(u=0),x=0|Math.floor(.5+m*(w-.5)),
x>l/2&&(x=l/2),c[t]=(q[u]+q[x])/2,b[t]=q[x],h[t]=(r*w-n[b[t]])/(n[b[t]+1]-n[b[t]]),0>h[t]?h[t]=0:1<h[t]&&(h[t]=1),w=z(k*y[t]*m),w=Math.min(w,15.5)/15.5,e[t]=Math.pow(10,1.25*(1-Math.cos(Math.PI*w))-2.5);for(b=t=0;b<v;b++)c=a[b],w=z(k*t),e=z(k*(t+c-1)),g[b]=.5*(w+e),w=z(k*(t-.5)),e=z(k*(t+c-.5)),f[b]=e-w,t+=c;return v}function h(a,b,c,g,f,e){var h=V([d.CBANDS,d.CBANDS]),k=0;if(e)for(var l=0;l<b;l++)for(e=0;e<b;e++){var y=c[l]-c[e];y=0<=y?3*y:1.5*y;if(.5<=y&&2.5>=y){var n=y-.5;n=8*(n*n-2*n)}else n=
0;y+=.474;y=15.811389+7.5*y-17.5*Math.sqrt(1+y*y);-60>=y?n=0:(y=Math.exp(.2302585093*(n+y)),n=y/.6609193);y=n*g[e];h[l][e]=y*f[l]}else for(e=0;e<b;e++){n=15+Math.min(21/c[e],12);var p;var r;l=n;for(p=0;1E-20<m(p,l);--p);var u=p;for(r=0;1E-12<Math.abs(r-u);)p=(r+u)/2,0<m(p,l)?r=p:u=p;y=u;for(p=0;1E-20<m(p,l);p+=1);u=0;for(r=p;1E-12<Math.abs(r-u);)p=(r+u)/2,0<m(p,l)?u=p:r=p;u=r;var q=0;for(r=0;1E3>=r;++r)p=y+r*(u-y)/1E3,p=m(p,l),q+=p;p=1001/(q*(u-y));for(l=0;l<b;l++)y=p*m(c[l]-c[e],n)*g[e],h[l][e]=
y*f[l]}for(l=0;l<b;l++){for(e=0;e<b&&!(0<h[l][e]);e++);a[l][0]=e;for(e=b-1;0<e&&!(0<h[l][e]);e--);a[l][1]=e;k+=a[l][1]-a[l][0]+1}c=G(k);for(l=g=0;l<b;l++)for(e=a[l][0];e<=a[l][1];e++)c[g++]=h[l][e];return c}function c(a){a=z(a);a=Math.min(a,15.5)/15.5;return Math.pow(10,1.25*(1-Math.cos(Math.PI*a))-2.5)}function k(a,b){-.3>a&&(a=3410);a=Math.max(.1,a/1E3);return 3.64*Math.pow(a,-.8)-6.8*Math.exp(-.6*Math.pow(a-3.4,2))+6*Math.exp(-.15*Math.pow(a-8.7,2))+.001*(.6+.04*b)*Math.pow(a,4)}var r=new Kc,E=
1/217621504/(d.BLKSIZE/2),n,p,x,I=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],g=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],u=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,
1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],y=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276],A=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],T=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130],L=[6.8,5.8,5.8,
6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1],S=[-1.730326E-17,-.01703172,-1.349528E-17,.0418072,-6.73278E-17,-.0876324,-3.0835E-17,.1863476,-1.104424E-16,-.627638];this.L3psycho_anal_ns=function(a,c,g,e,h,k,y,p,n,m){var u=a.internal_flags,t=V([2,d.BLKSIZE]),x=V([2,3,d.BLKSIZE_s]),A=G(d.CBANDS+1),H=G(d.CBANDS+1),D=G(d.CBANDS+2),M=P(2),Q=P(2),z,E,R,T,ja,L,J,aa=V([2,576]),W=P(d.CBANDS+2),O=P(d.CBANDS+2);La.fill(O,0);var na=u.channels_out;a.mode==da.JOINT_STEREO&&
(na=4);var K=a.VBR==C.vbr_off?0==u.ResvMax?0:u.ResvSize/u.ResvMax*.5:a.VBR==C.vbr_rh||a.VBR==C.vbr_mtrh||a.VBR==C.vbr_mt?.6:1;for(z=0;z<u.channels_out;z++){var U=c[z],ca=g+576-350-21+192;for(R=0;576>R;R++){var fa;var Z=U[ca+R+10];for(T=fa=0;9>T;T+=2)Z+=S[T]*(U[ca+R+T]+U[ca+R+21-T]),fa+=S[T+1]*(U[ca+R+T+1]+U[ca+R+21-T-1]);aa[z][R]=Z+fa}h[e][z].en.assign(u.en[z]);h[e][z].thm.assign(u.thm[z]);2<na&&(k[e][z].en.assign(u.en[z+2]),k[e][z].thm.assign(u.thm[z+2]))}for(z=0;z<na;z++){var Y=G(12),za=[0,0,0,
0],ra=G(12),oa=1,ma=G(d.CBANDS),ta=G(d.CBANDS),ua=[0,0,0,0],Aa=G(d.HBLKSIZE),Ba=V([3,d.HBLKSIZE_s]);for(R=0;3>R;R++)Y[R]=u.nsPsy.last_en_subshort[z][R+6],ra[R]=Y[R]/u.nsPsy.last_en_subshort[z][R+4],za[0]+=Y[R];if(2==z)for(R=0;576>R;R++){var sc=aa[0][R];var sa=aa[1][R];aa[0][R]=sc+sa;aa[1][R]=sc-sa}var Vb=aa[z&1],cc=0;for(R=0;9>R;R++){for(var Wa=cc+64,Ha=1;cc<Wa;cc++)Ha<Math.abs(Vb[cc])&&(Ha=Math.abs(Vb[cc]));u.nsPsy.last_en_subshort[z][R]=Y[R+3]=Ha;za[1+R/3]+=Ha;Ha=Ha>Y[R+3-2]?Ha/Y[R+3-2]:Y[R+3-2]>
10*Ha?Y[R+3-2]/(10*Ha):0;ra[R+3]=Ha}if(a.analysis){var Ma=ra[0];for(R=1;12>R;R++)Ma<ra[R]&&(Ma=ra[R]);u.pinfo.ers[e][z]=u.pinfo.ers_save[z];u.pinfo.ers_save[z]=Ma}var lc=3==z?u.nsPsy.attackthre_s:u.nsPsy.attackthre;for(R=0;12>R;R++)0==ua[R/3]&&ra[R]>lc&&(ua[R/3]=R%3+1);for(R=1;4>R;R++)1.7>(za[R-1]>za[R]?za[R-1]/za[R]:za[R]/za[R-1])&&(ua[R]=0,1==R&&(ua[0]=0));0!=ua[0]&&0!=u.nsPsy.lastAttacks[z]&&(ua[0]=0);if(3==u.nsPsy.lastAttacks[z]||0!=ua[0]+ua[1]+ua[2]+ua[3])oa=0,0!=ua[1]&&0!=ua[0]&&(ua[1]=0),0!=
ua[2]&&0!=ua[1]&&(ua[2]=0),0!=ua[3]&&0!=ua[2]&&(ua[3]=0);2>z?Q[z]=oa:0==oa&&(Q[0]=Q[1]=0);n[z]=u.tot_ener[z];var N=a,Ia=Aa,Fb=Ba,Na=t,lb=z&1,Ra=x,Oa=z&1,db=e,Ca=z,wa=c,Ya=g,Va=N.internal_flags;if(2>Ca)r.fft_long(Va,Na[lb],Ca,wa,Ya),r.fft_short(Va,Ra[Oa],Ca,wa,Ya);else if(2==Ca){for(var ka=d.BLKSIZE-1;0<=ka;--ka){var Gb=Na[lb+0][ka],Hb=Na[lb+1][ka];Na[lb+0][ka]=(Gb+Hb)*ba.SQRT2*.5;Na[lb+1][ka]=(Gb-Hb)*ba.SQRT2*.5}for(var Da=2;0<=Da;--Da)for(ka=d.BLKSIZE_s-1;0<=ka;--ka)Gb=Ra[Oa+0][Da][ka],Hb=Ra[Oa+
1][Da][ka],Ra[Oa+0][Da][ka]=(Gb+Hb)*ba.SQRT2*.5,Ra[Oa+1][Da][ka]=(Gb-Hb)*ba.SQRT2*.5}Ia[0]=Na[lb+0][0];Ia[0]*=Ia[0];for(ka=d.BLKSIZE/2-1;0<=ka;--ka){var dc=Na[lb+0][d.BLKSIZE/2-ka],tb=Na[lb+0][d.BLKSIZE/2+ka];Ia[d.BLKSIZE/2-ka]=.5*(dc*dc+tb*tb)}for(Da=2;0<=Da;--Da)for(Fb[Da][0]=Ra[Oa+0][Da][0],Fb[Da][0]*=Fb[Da][0],ka=d.BLKSIZE_s/2-1;0<=ka;--ka)dc=Ra[Oa+0][Da][d.BLKSIZE_s/2-ka],tb=Ra[Oa+0][Da][d.BLKSIZE_s/2+ka],Fb[Da][d.BLKSIZE_s/2-ka]=.5*(dc*dc+tb*tb);var pa=0;for(ka=11;ka<d.HBLKSIZE;ka++)pa+=Ia[ka];
Va.tot_ener[Ca]=pa;if(N.analysis){for(ka=0;ka<d.HBLKSIZE;ka++)Va.pinfo.energy[db][Ca][ka]=Va.pinfo.energy_save[Ca][ka],Va.pinfo.energy_save[Ca][ka]=Ia[ka];Va.pinfo.pe[db][Ca]=Va.pe[Ca]}2==N.athaa_loudapprox&&2>Ca&&(Va.loudness_sq[db][Ca]=Va.loudness_sq_save[Ca],Va.loudness_sq_save[Ca]=v(Ia,Va));b(u,Aa,A,ma,ta);q(u,ma,ta,W);for(J=0;3>J;J++){var ha=void 0,zb=void 0,Ab=Ba,Sa=H,Za=D,ub=z,cb=J,Ja=a.internal_flags;for(ha=zb=0;ha<Ja.npart_s;++ha){for(var Qb=0,sb=0,eb=Ja.numlines_s[ha],rb=0;rb<eb;++rb,++zb){var Bb=
Ab[cb][zb];Qb+=Bb;sb<Bb&&(sb=Bb)}Sa[ha]=Qb}for(zb=ha=0;ha<Ja.npart_s;ha++){var Cb=Ja.s3ind_s[ha][0],$a=Ja.s3_ss[zb++]*Sa[Cb];for(++Cb;Cb<=Ja.s3ind_s[ha][1];)$a+=Ja.s3_ss[zb]*Sa[Cb],++zb,++Cb;var vb=2*Ja.nb_s1[ub][ha];Za[ha]=Math.min($a,vb);Ja.blocktype_old[ub&1]==d.SHORT_TYPE&&(vb=16*Ja.nb_s2[ub][ha],Za[ha]=Math.min(vb,Za[ha]));Ja.nb_s2[ub][ha]=Ja.nb_s1[ub][ha];Ja.nb_s1[ub][ha]=$a}for(;ha<=d.CBANDS;++ha)Sa[ha]=0,Za[ha]=0;w(u,H,D,z,J);for(L=0;L<d.SBMAX_s;L++){var Ta=u.thm[z].s[L][J];Ta*=.8;if(2<=ua[J]||
1==ua[J+1]){var wb=0!=J?J-1:2;Ha=B(u.thm[z].s[L][wb],Ta,.6*K);Ta=Math.min(Ta,Ha)}if(1==ua[J])wb=0!=J?J-1:2,Ha=B(u.thm[z].s[L][wb],Ta,.3*K),Ta=Math.min(Ta,Ha);else if(0!=J&&3==ua[J-1]||0==J&&3==u.nsPsy.lastAttacks[z])wb=2!=J?J+1:0,Ha=B(u.thm[z].s[L][wb],Ta,.3*K),Ta=Math.min(Ta,Ha);var Xb=Y[3*J+3]+Y[3*J+4]+Y[3*J+5];6*Y[3*J+5]<Xb&&(Ta*=.5,6*Y[3*J+4]<Xb&&(Ta*=.5));u.thm[z].s[L][J]=Ta}}u.nsPsy.lastAttacks[z]=ua[2];for(E=ja=0;E<u.npart_l;E++){for(var fb=u.s3ind[E][0],Ib=A[fb]*I[W[fb]],mb=u.s3_ll[ja++]*
Ib;++fb<=u.s3ind[E][1];)Ib=A[fb]*I[W[fb]],mb=l(mb,u.s3_ll[ja++]*Ib,fb,fb-E,u,0);mb*=.158489319246111;D[E]=u.blocktype_old[z&1]==d.SHORT_TYPE?mb:B(Math.min(mb,Math.min(2*u.nb_1[z][E],16*u.nb_2[z][E])),mb,K);u.nb_2[z][E]=u.nb_1[z][E];u.nb_1[z][E]=mb}for(;E<=d.CBANDS;++E)A[E]=0,D[E]=0;F(u,A,D,z)}if((a.mode==da.STEREO||a.mode==da.JOINT_STEREO)&&0<a.interChRatio){var xb=a.interChRatio,ia=a.internal_flags;if(1<ia.channels_out){for(var Ea=0;Ea<d.SBMAX_l;Ea++){var Rb=ia.thm[0].l[Ea],Db=ia.thm[1].l[Ea];ia.thm[0].l[Ea]+=
Db*xb;ia.thm[1].l[Ea]+=Rb*xb}for(Ea=0;Ea<d.SBMAX_s;Ea++)for(var gb=0;3>gb;gb++)Rb=ia.thm[0].s[Ea][gb],Db=ia.thm[1].s[Ea][gb],ia.thm[0].s[Ea][gb]+=Db*xb,ia.thm[1].s[Ea][gb]+=Rb*xb}}if(a.mode==da.JOINT_STEREO){for(var Pa,la=0;la<d.SBMAX_l;la++)if(!(u.thm[0].l[la]>1.58*u.thm[1].l[la]||u.thm[1].l[la]>1.58*u.thm[0].l[la])){var Ua=u.mld_l[la]*u.en[3].l[la],hb=Math.max(u.thm[2].l[la],Math.min(u.thm[3].l[la],Ua));Ua=u.mld_l[la]*u.en[2].l[la];var ec=Math.max(u.thm[3].l[la],Math.min(u.thm[2].l[la],Ua));u.thm[2].l[la]=
hb;u.thm[3].l[la]=ec}for(la=0;la<d.SBMAX_s;la++)for(var va=0;3>va;va++)u.thm[0].s[la][va]>1.58*u.thm[1].s[la][va]||u.thm[1].s[la][va]>1.58*u.thm[0].s[la][va]||(Ua=u.mld_s[la]*u.en[3].s[la][va],hb=Math.max(u.thm[2].s[la][va],Math.min(u.thm[3].s[la][va],Ua)),Ua=u.mld_s[la]*u.en[2].s[la][va],ec=Math.max(u.thm[3].s[la][va],Math.min(u.thm[2].s[la][va],Ua)),u.thm[2].s[la][va]=hb,u.thm[3].s[la][va]=ec);Pa=a.msfix;if(0<Math.abs(Pa)){var Jb=Pa,fc=Jb,Yb=Math.pow(10,a.ATHlower*u.ATH.adjust);Jb*=2;fc*=2;for(var xa=
0;xa<d.SBMAX_l;xa++){var ea=u.ATH.cb_l[u.bm_l[xa]]*Yb;var Xa=Math.min(Math.max(u.thm[0].l[xa],ea),Math.max(u.thm[1].l[xa],ea));var ab=Math.max(u.thm[2].l[xa],ea);var nb=Math.max(u.thm[3].l[xa],ea);if(Xa*Jb<ab+nb){var ib=Xa*fc/(ab+nb);ab*=ib;nb*=ib}u.thm[2].l[xa]=Math.min(ab,u.thm[2].l[xa]);u.thm[3].l[xa]=Math.min(nb,u.thm[3].l[xa])}Yb*=d.BLKSIZE_s/d.BLKSIZE;for(xa=0;xa<d.SBMAX_s;xa++)for(var Fa=0;3>Fa;Fa++)ea=u.ATH.cb_s[u.bm_s[xa]]*Yb,Xa=Math.min(Math.max(u.thm[0].s[xa][Fa],ea),Math.max(u.thm[1].s[xa][Fa],
ea)),ab=Math.max(u.thm[2].s[xa][Fa],ea),nb=Math.max(u.thm[3].s[xa][Fa],ea),Xa*Jb<ab+nb&&(ib=Xa*Jb/(ab+nb),ab*=ib,nb*=ib),u.thm[2].s[xa][Fa]=Math.min(u.thm[2].s[xa][Fa],ab),u.thm[3].s[xa][Fa]=Math.min(u.thm[3].s[xa][Fa],nb)}}var jb=a.internal_flags;a.short_blocks!=ya.short_block_coupled||0!=Q[0]&&0!=Q[1]||(Q[0]=Q[1]=0);for(var Ka=0;Ka<jb.channels_out;Ka++)M[Ka]=d.NORM_TYPE,a.short_blocks==ya.short_block_dispensed&&(Q[Ka]=1),a.short_blocks==ya.short_block_forced&&(Q[Ka]=0),0!=Q[Ka]?jb.blocktype_old[Ka]==
d.SHORT_TYPE&&(M[Ka]=d.STOP_TYPE):(M[Ka]=d.SHORT_TYPE,jb.blocktype_old[Ka]==d.NORM_TYPE&&(jb.blocktype_old[Ka]=d.START_TYPE),jb.blocktype_old[Ka]==d.STOP_TYPE&&(jb.blocktype_old[Ka]=d.SHORT_TYPE)),m[Ka]=jb.blocktype_old[Ka],jb.blocktype_old[Ka]=M[Ka];for(z=0;z<na;z++){var Ga=0;if(1<z){var Kb=p;Ga=-2;var Sb=d.NORM_TYPE;if(m[0]==d.SHORT_TYPE||m[1]==d.SHORT_TYPE)Sb=d.SHORT_TYPE;var Eb=k[e][z-2]}else Kb=y,Ga=0,Sb=m[z],Eb=h[e][z];Kb[Ga+z]=Sb==d.SHORT_TYPE?X(Eb,u.masking_lower):f(Eb,u.masking_lower);a.analysis&&
(u.pinfo.pe[e][z]=Kb[Ga+z])}return 0};var ja=[-1.730326E-17,-.01703172,-1.349528E-17,.0418072,-6.73278E-17,-.0876324,-3.0835E-17,.1863476,-1.104424E-16,-.627638];this.L3psycho_anal_vbr=function(c,g,e,h,k,l,u,y,p,n){for(var m=c.internal_flags,x,A,H=G(d.HBLKSIZE),M=V([3,d.HBLKSIZE_s]),z=V([2,d.BLKSIZE]),D=V([2,3,d.BLKSIZE_s]),Q=V([4,d.CBANDS]),E=V([4,d.CBANDS]),S=V([4,3]),J=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],T=P(2),L=c.mode==da.JOINT_STEREO?4:m.channels_out,C=V([2,576]),aa=c.internal_flags,W=
aa.channels_out,na=c.mode==da.JOINT_STEREO?4:W,O=0;O<W;O++){firbuf=g[O];for(var U=e+576-350-21+192,K=0;576>K;K++){var Y;var ca=firbuf[U+K+10];for(var fa=Y=0;9>fa;fa+=2)ca+=ja[fa]*(firbuf[U+K+fa]+firbuf[U+K+21-fa]),Y+=ja[fa+1]*(firbuf[U+K+fa+1]+firbuf[U+K+21-fa-1]);C[O][K]=ca+Y}k[h][O].en.assign(aa.en[O]);k[h][O].thm.assign(aa.thm[O]);2<na&&(l[h][O].en.assign(aa.en[O+2]),l[h][O].thm.assign(aa.thm[O+2]))}for(O=0;O<na;O++){var Z=G(12),za=G(12),ra=[0,0,0,0],oa=C[O&1],ma=0,ta=3==O?aa.nsPsy.attackthre_s:
aa.nsPsy.attackthre,Aa=1;if(2==O)for(K=0,fa=576;0<fa;++K,--fa){var ua=C[0][K],Ba=C[1][K];C[0][K]=ua+Ba;C[1][K]=ua-Ba}for(K=0;3>K;K++)za[K]=aa.nsPsy.last_en_subshort[O][K+6],Z[K]=za[K]/aa.nsPsy.last_en_subshort[O][K+4],ra[0]+=za[K];for(K=0;9>K;K++){for(var La=ma+64,sa=1;ma<La;ma++)sa<Math.abs(oa[ma])&&(sa=Math.abs(oa[ma]));aa.nsPsy.last_en_subshort[O][K]=za[K+3]=sa;ra[1+K/3]+=sa;sa=sa>za[K+3-2]?sa/za[K+3-2]:za[K+3-2]>10*sa?za[K+3-2]/(10*sa):0;Z[K+3]=sa}for(K=0;3>K;++K){var Ma=za[3*K+3]+za[3*K+4]+za[3*
K+5],Vb=1;6*za[3*K+5]<Ma&&(Vb*=.5,6*za[3*K+4]<Ma&&(Vb*=.5));S[O][K]=Vb}if(c.analysis){var Wa=Z[0];for(K=1;12>K;K++)Wa<Z[K]&&(Wa=Z[K]);aa.pinfo.ers[h][O]=aa.pinfo.ers_save[O];aa.pinfo.ers_save[O]=Wa}for(K=0;12>K;K++)0==J[O][K/3]&&Z[K]>ta&&(J[O][K/3]=K%3+1);for(K=1;4>K;K++){var Ya=ra[K-1],Ha=ra[K];4E4>Math.max(Ya,Ha)&&Ya<1.7*Ha&&Ha<1.7*Ya&&(1==K&&J[O][0]<=J[O][K]&&(J[O][0]=0),J[O][K]=0)}J[O][0]<=aa.nsPsy.lastAttacks[O]&&(J[O][0]=0);if(3==aa.nsPsy.lastAttacks[O]||0!=J[O][0]+J[O][1]+J[O][2]+J[O][3])Aa=
0,0!=J[O][1]&&0!=J[O][0]&&(J[O][1]=0),0!=J[O][2]&&0!=J[O][1]&&(J[O][2]=0),0!=J[O][3]&&0!=J[O][2]&&(J[O][3]=0);2>O?T[O]=Aa:0==Aa&&(T[0]=T[1]=0);p[O]=aa.tot_ener[O]}var sb=c.internal_flags;c.short_blocks!=ya.short_block_coupled||0!=T[0]&&0!=T[1]||(T[0]=T[1]=0);for(var cb=0;cb<sb.channels_out;cb++)c.short_blocks==ya.short_block_dispensed&&(T[cb]=1),c.short_blocks==ya.short_block_forced&&(T[cb]=0);for(var N=0;N<L;N++){var Ia=N&1;x=z;var Fb=c,Na=N,lb=h,Ra=H,Oa=x,db=Ia,Ca=Fb.internal_flags;if(2>Na)r.fft_long(Ca,
Oa[db],Na,g,e);else if(2==Na)for(var wa=d.BLKSIZE-1;0<=wa;--wa){var rb=Oa[db+0][wa],Va=Oa[db+1][wa];Oa[db+0][wa]=(rb+Va)*ba.SQRT2*.5;Oa[db+1][wa]=(rb-Va)*ba.SQRT2*.5}Ra[0]=Oa[db+0][0];Ra[0]*=Ra[0];for(wa=d.BLKSIZE/2-1;0<=wa;--wa){var ka=Oa[db+0][d.BLKSIZE/2-wa],Gb=Oa[db+0][d.BLKSIZE/2+wa];Ra[d.BLKSIZE/2-wa]=.5*(ka*ka+Gb*Gb)}var Hb=0;for(wa=11;wa<d.HBLKSIZE;wa++)Hb+=Ra[wa];Ca.tot_ener[Na]=Hb;if(Fb.analysis){for(wa=0;wa<d.HBLKSIZE;wa++)Ca.pinfo.energy[lb][Na][wa]=Ca.pinfo.energy_save[Na][wa],Ca.pinfo.energy_save[Na][wa]=
Ra[wa];Ca.pinfo.pe[lb][Na]=Ca.pe[Na]}var Da=N,lc=H,tb=c.internal_flags;2==c.athaa_loudapprox&&2>Da&&(tb.loudness_sq[h][Da]=tb.loudness_sq_save[Da],tb.loudness_sq_save[Da]=v(lc,tb));if(0!=T[Ia]){var pa=void 0,ha=m,zb=H,Ab=Q[N],Sa=E[N],Za=N,ub=G(d.CBANDS),Ob=G(d.CBANDS),Ja=P(d.CBANDS+2);b(ha,zb,Ab,ub,Ob);q(ha,ub,Ob,Ja);var Qb=0;for(pa=0;pa<ha.npart_l;pa++){var Wb,eb=ha.s3ind[pa][0],bc=ha.s3ind[pa][1],Bb=0,Cb=0;Bb=Ja[eb];Cb+=1;var $a=ha.s3_ll[Qb]*Ab[eb]*I[Ja[eb]];++Qb;for(++eb;eb<=bc;){Bb+=Ja[eb];Cb+=
1;var vb=ha.s3_ll[Qb]*Ab[eb]*I[Ja[eb]];$a=Wb=t($a,vb,eb-pa);++Qb;++eb}Bb=(1+2*Bb)/(2*Cb);var Ta=.5*I[Bb];$a*=Ta;if(ha.blocktype_old[Za&1]==d.SHORT_TYPE){var wb=2*ha.nb_1[Za][pa];Sa[pa]=0<wb?Math.min($a,wb):Math.min($a,.3*Ab[pa])}else{var Xb=16*ha.nb_2[Za][pa],fb=2*ha.nb_1[Za][pa];0>=Xb&&(Xb=$a);0>=fb&&(fb=$a);wb=ha.blocktype_old[Za&1]==d.NORM_TYPE?Math.min(fb,Xb):fb;Sa[pa]=Math.min($a,wb)}ha.nb_2[Za][pa]=ha.nb_1[Za][pa];ha.nb_1[Za][pa]=$a;vb=ub[pa];vb*=ha.minval_l[pa];vb*=Ta;Sa[pa]>vb&&(Sa[pa]=vb);
1<ha.masking_lower&&(Sa[pa]*=ha.masking_lower);Sa[pa]>Ab[pa]&&(Sa[pa]=Ab[pa]);1>ha.masking_lower&&(Sa[pa]*=ha.masking_lower)}for(;pa<d.CBANDS;++pa)Ab[pa]=0,Sa[pa]=0}else for(var Ib=m,mb=N,xb=0;xb<Ib.npart_l;xb++)Ib.nb_2[mb][xb]=Ib.nb_1[mb][xb],Ib.nb_1[mb][xb]=0}2==T[0]+T[1]&&c.mode==da.JOINT_STEREO&&a(Q,E,m.mld_cb_l,m.ATH.cb_l,c.ATHlower*m.ATH.adjust,c.msfix,m.npart_l);for(N=0;N<L;N++)Ia=N&1,0!=T[Ia]&&F(m,Q[N],E[N],N);for(var ia=0;3>ia;ia++){for(N=0;N<L;++N)if(Ia=N&1,0!=T[Ia]){var Ea=m,Rb=N;if(0==
ia)for(var Db=0;Db<Ea.npart_s;Db++)Ea.nb_s2[Rb][Db]=Ea.nb_s1[Rb][Db],Ea.nb_s1[Rb][Db]=0}else{A=D;var gb=N,Pa=ia,la=M,Ua=A,hb=Ia,ec=c.internal_flags;0==Pa&&2>gb&&r.fft_short(ec,Ua[hb],gb,g,e);if(2==gb)for(var va=d.BLKSIZE_s-1;0<=va;--va){var Jb=Ua[hb+0][Pa][va],fc=Ua[hb+1][Pa][va];Ua[hb+0][Pa][va]=(Jb+fc)*ba.SQRT2*.5;Ua[hb+1][Pa][va]=(Jb-fc)*ba.SQRT2*.5}la[Pa][0]=Ua[hb+0][Pa][0];la[Pa][0]*=la[Pa][0];for(va=d.BLKSIZE_s/2-1;0<=va;--va){var Yb=Ua[hb+0][Pa][d.BLKSIZE_s/2-va],xa=Ua[hb+0][Pa][d.BLKSIZE_s/
2+va];la[Pa][d.BLKSIZE_s/2-va]=.5*(Yb*Yb+xa*xa)}var ea=void 0,Xa=void 0,ab=void 0,nb=M,ib=Q[N],Fa=E[N],jb=N,Ka=ia,Ga=c.internal_flags,Kb=new float[d.CBANDS],Sb=G(d.CBANDS),Eb=new int[d.CBANDS];for(ea=Xa=0;ea<Ga.npart_s;++ea){var Nb=0,Pb=0,tc=Ga.numlines_s[ea];for(ab=0;ab<tc;++ab,++Xa){var mc=nb[Ka][Xa];Nb+=mc;Pb<mc&&(Pb=mc)}ib[ea]=Nb;Kb[ea]=Pb;Sb[ea]=Nb/tc}for(;ea<d.CBANDS;++ea)Kb[ea]=0,Sb[ea]=0;var Lb=Ga,ob=Kb,Tb=Sb,Zb=Eb,$b=I.length-1,qa=0,Qa=Tb[qa]+Tb[qa+1];if(0<Qa){var bb=ob[qa];bb<ob[qa+1]&&
(bb=ob[qa+1]);Qa=20*(2*bb-Qa)/(Qa*(Lb.numlines_s[qa]+Lb.numlines_s[qa+1]-1));var pb=0|Qa;pb>$b&&(pb=$b);Zb[qa]=pb}else Zb[qa]=0;for(qa=1;qa<Lb.npart_s-1;qa++)Qa=Tb[qa-1]+Tb[qa]+Tb[qa+1],0<Qa?(bb=ob[qa-1],bb<ob[qa]&&(bb=ob[qa]),bb<ob[qa+1]&&(bb=ob[qa+1]),Qa=20*(3*bb-Qa)/(Qa*(Lb.numlines_s[qa-1]+Lb.numlines_s[qa]+Lb.numlines_s[qa+1]-1)),pb=0|Qa,pb>$b&&(pb=$b),Zb[qa]=pb):Zb[qa]=0;Qa=Tb[qa-1]+Tb[qa];0<Qa?(bb=ob[qa-1],bb<ob[qa]&&(bb=ob[qa]),Qa=20*(2*bb-Qa)/(Qa*(Lb.numlines_s[qa-1]+Lb.numlines_s[qa]-1)),
pb=0|Qa,pb>$b&&(pb=$b),Zb[qa]=pb):Zb[qa]=0;for(Xa=ea=0;ea<Ga.npart_s;ea++){var yb=Ga.s3ind_s[ea][0],kc=Ga.s3ind_s[ea][1];var jc=Eb[yb];var uc=1;var gc=Ga.s3_ss[Xa]*ib[yb]*I[Eb[yb]];++Xa;for(++yb;yb<=kc;){jc+=Eb[yb];uc+=1;var ac=Ga.s3_ss[Xa]*ib[yb]*I[Eb[yb]];gc=t(gc,ac,yb-ea);++Xa;++yb}jc=(1+2*jc)/(2*uc);var vc=.5*I[jc];gc*=vc;Fa[ea]=gc;Ga.nb_s2[jb][ea]=Ga.nb_s1[jb][ea];Ga.nb_s1[jb][ea]=gc;ac=Kb[ea];ac*=Ga.minval_s[ea];ac*=vc;Fa[ea]>ac&&(Fa[ea]=ac);1<Ga.masking_lower&&(Fa[ea]*=Ga.masking_lower);Fa[ea]>
ib[ea]&&(Fa[ea]=ib[ea]);1>Ga.masking_lower&&(Fa[ea]*=Ga.masking_lower)}for(;ea<d.CBANDS;++ea)ib[ea]=0,Fa[ea]=0}0==T[0]+T[1]&&c.mode==da.JOINT_STEREO&&a(Q,E,m.mld_cb_s,m.ATH.cb_s,c.ATHlower*m.ATH.adjust,c.msfix,m.npart_s);for(N=0;N<L;++N)Ia=N&1,0==T[Ia]&&w(m,Q[N],E[N],N,ia)}for(N=0;N<L;N++)if(Ia=N&1,0==T[Ia])for(var Ub=0;Ub<d.SBMAX_s;Ub++){var wc=G(3);for(ia=0;3>ia;ia++){var kb=m.thm[N].s[Ub][ia];kb*=.8;if(2<=J[N][ia]||1==J[N][ia+1]){var hc=0!=ia?ia-1:2,ic=B(m.thm[N].s[Ub][hc],kb,.36);kb=Math.min(kb,
ic)}else if(1==J[N][ia])hc=0!=ia?ia-1:2,ic=B(m.thm[N].s[Ub][hc],kb,.18),kb=Math.min(kb,ic);else if(0!=ia&&3==J[N][ia-1]||0==ia&&3==m.nsPsy.lastAttacks[N])hc=2!=ia?ia+1:0,ic=B(m.thm[N].s[Ub][hc],kb,.18),kb=Math.min(kb,ic);kb*=S[N][ia];wc[ia]=kb}for(ia=0;3>ia;ia++)m.thm[N].s[Ub][ia]=wc[ia]}for(N=0;N<L;N++)m.nsPsy.lastAttacks[N]=J[N][2];for(var Mb=c.internal_flags,qb=0;qb<Mb.channels_out;qb++){var nc=d.NORM_TYPE;0!=T[qb]?Mb.blocktype_old[qb]==d.SHORT_TYPE&&(nc=d.STOP_TYPE):(nc=d.SHORT_TYPE,Mb.blocktype_old[qb]==
d.NORM_TYPE&&(Mb.blocktype_old[qb]=d.START_TYPE),Mb.blocktype_old[qb]==d.STOP_TYPE&&(Mb.blocktype_old[qb]=d.SHORT_TYPE));n[qb]=Mb.blocktype_old[qb];Mb.blocktype_old[qb]=nc}for(N=0;N<L;N++){if(1<N){var oc=y;var pc=-2;var qc=d.NORM_TYPE;if(n[0]==d.SHORT_TYPE||n[1]==d.SHORT_TYPE)qc=d.SHORT_TYPE;var rc=l[h][N-2]}else oc=u,pc=0,qc=n[N],rc=k[h][N];oc[pc+N]=qc==d.SHORT_TYPE?X(rc,m.masking_lower):f(rc,m.masking_lower);c.analysis&&(m.pinfo.pe[h][N]=oc[pc+N])}return 0};this.psymodel_init=function(a){var b=
a.internal_flags,g,f=!0,k=13,l=0,u=0,y=-8.25,m=-4.5,q=G(d.CBANDS),t=G(d.CBANDS),v=G(d.CBANDS),w=a.out_samplerate;switch(a.experimentalZ){default:case 0:f=!0;break;case 1:f=a.VBR==C.vbr_mtrh||a.VBR==C.vbr_mt?!1:!0;break;case 2:f=!1;break;case 3:k=8,l=-1.75,u=-.0125,y=-8.25,m=-2.25}b.ms_ener_ratio_old=.25;b.blocktype_old[0]=b.blocktype_old[1]=d.NORM_TYPE;for(g=0;4>g;++g){for(var A=0;A<d.CBANDS;++A)b.nb_1[g][A]=1E20,b.nb_2[g][A]=1E20,b.nb_s1[g][A]=b.nb_s2[g][A]=1;for(var z=0;z<d.SBMAX_l;z++)b.en[g].l[z]=
1E20,b.thm[g].l[z]=1E20;for(A=0;3>A;++A){for(z=0;z<d.SBMAX_s;z++)b.en[g].s[z][A]=1E20,b.thm[g].s[z][A]=1E20;b.nsPsy.lastAttacks[g]=0}for(A=0;9>A;A++)b.nsPsy.last_en_subshort[g][A]=10}b.loudness_sq_save[0]=b.loudness_sq_save[1]=0;b.npart_l=e(b.numlines_l,b.bo_l,b.bm_l,q,t,b.mld_l,b.PSY.bo_l_weight,w,d.BLKSIZE,b.scalefac_band.l,d.BLKSIZE/1152,d.SBMAX_l);for(g=0;g<b.npart_l;g++)z=l,q[g]>=k&&(z=u*(q[g]-k)/(24-k)+l*(24-q[g])/(24-k)),v[g]=Math.pow(10,z/10),b.rnumlines_l[g]=0<b.numlines_l[g]?1/b.numlines_l[g]:
0;b.s3_ll=h(b.s3ind,b.npart_l,q,t,v,f);for(g=A=0;g<b.npart_l;g++){u=Ya.MAX_VALUE;for(z=0;z<b.numlines_l[g];z++,A++)l=w*A/(1E3*d.BLKSIZE),l=this.ATHformula(1E3*l,a)-20,l=Math.pow(10,.1*l),l*=b.numlines_l[g],u>l&&(u=l);b.ATH.cb_l[g]=u;u=-20+20*q[g]/10;6<u&&(u=100);-15>u&&(u=-15);u-=8;b.minval_l[g]=Math.pow(10,u/10)*b.numlines_l[g]}b.npart_s=e(b.numlines_s,b.bo_s,b.bm_s,q,t,b.mld_s,b.PSY.bo_s_weight,w,d.BLKSIZE_s,b.scalefac_band.s,d.BLKSIZE_s/384,d.SBMAX_s);for(g=A=0;g<b.npart_s;g++){z=y;q[g]>=k&&(z=
m*(q[g]-k)/(24-k)+y*(24-q[g])/(24-k));v[g]=Math.pow(10,z/10);u=Ya.MAX_VALUE;for(z=0;z<b.numlines_s[g];z++,A++)l=w*A/(1E3*d.BLKSIZE_s),l=this.ATHformula(1E3*l,a)-20,l=Math.pow(10,.1*l),l*=b.numlines_s[g],u>l&&(u=l);b.ATH.cb_s[g]=u;u=-7+7*q[g]/12;12<q[g]&&(u*=1+3.1*Math.log(1+u));12>q[g]&&(u*=1+2.3*Math.log(1-u));-15>u&&(u=-15);u-=8;b.minval_s[g]=Math.pow(10,u/10)*b.numlines_s[g]}b.s3_ss=h(b.s3ind_s,b.npart_s,q,t,v,f);n=Math.pow(10,.5625);p=Math.pow(10,1.5);x=Math.pow(10,1.5);r.init_fft(b);b.decay=
Math.exp(-2.302585092994046/(.01*w/192));g=3.5;0!=(a.exp_nspsytune&2)&&(g=1);0<Math.abs(a.msfix)&&(g=a.msfix);a.msfix=g;for(f=0;f<b.npart_l;f++)b.s3ind[f][1]>b.npart_l-1&&(b.s3ind[f][1]=b.npart_l-1);b.ATH.decay=Math.pow(10,576*b.mode_gr/w*-1.2);b.ATH.adjust=.01;b.ATH.adjustLimit=1;if(-1!=a.ATHtype){A=a.out_samplerate/d.BLKSIZE;for(g=l=f=0;g<d.BLKSIZE/2;++g)l+=A,b.ATH.eql_w[g]=1/Math.pow(10,this.ATHformula(l,a)/10),f+=b.ATH.eql_w[g];f=1/f;for(g=d.BLKSIZE/2;0<=--g;)b.ATH.eql_w[g]*=f}for(f=A=0;f<b.npart_s;++f)for(g=
0;g<b.numlines_s[f];++g)++A;for(f=A=0;f<b.npart_l;++f)for(g=0;g<b.numlines_l[f];++g)++A;for(g=A=0;g<b.npart_l;g++)l=w*(A+b.numlines_l[g]/2)/(1*d.BLKSIZE),b.mld_cb_l[g]=c(l),A+=b.numlines_l[g];for(;g<d.CBANDS;++g)b.mld_cb_l[g]=1;for(g=A=0;g<b.npart_s;g++)l=w*(A+b.numlines_s[g]/2)/(1*d.BLKSIZE_s),b.mld_cb_s[g]=c(l),A+=b.numlines_s[g];for(;g<d.CBANDS;++g)b.mld_cb_s[g]=1;return 0};this.ATHformula=function(a,b){switch(b.ATHtype){case 0:var c=k(a,9);break;case 1:c=k(a,-1);break;case 2:c=k(a,0);break;case 3:c=
k(a,1)+6;break;case 4:c=k(a,b.ATHcurve);break;default:c=k(a,0)}return c}}function X(){function v(){this.mask_adjust_short=this.mask_adjust=0;this.bo_l_weight=G(d.SBMAX_l);this.bo_s_weight=G(d.SBMAX_s)}function l(){this.lowerlimit=0}function t(a,b){this.lowpass=b}function W(a){return 1<a?0:0>=a?1:Math.cos(Math.PI/2*a)}function F(a,b){switch(a){case 44100:return b.version=1,0;case 48E3:return b.version=1;case 32E3:return b.version=1,2;case 22050:return b.version=0;case 24E3:return b.version=0,1;case 16E3:return b.version=
0,2;case 11025:return b.version=0;case 12E3:return b.version=0,1;case 8E3:return b.version=0,2;default:return b.version=0,-1}}function B(a,b,c){16E3>c&&(b=2);c=w.bitrate_table[b][1];for(var d=2;14>=d;d++)0<w.bitrate_table[b][d]&&Math.abs(w.bitrate_table[b][d]-a)<Math.abs(c-a)&&(c=w.bitrate_table[b][d]);return c}function P(a,b,c){16E3>c&&(b=2);for(c=0;14>=c;c++)if(0<w.bitrate_table[b][c]&&w.bitrate_table[b][c]==a)return c;return-1}function f(a,b){var c=[new t(8,2E3),new t(16,3700),new t(24,3900),new t(32,
5500),new t(40,7E3),new t(48,7500),new t(56,1E4),new t(64,11E3),new t(80,13500),new t(96,15100),new t(112,15600),new t(128,17E3),new t(160,17500),new t(192,18600),new t(224,19400),new t(256,19700),new t(320,20500)],d=e.nearestBitrateFullIndex(b);a.lowerlimit=c[d].lowpass}function b(a){var b=d.BLKSIZE+a.framesize-d.FFTOFFSET;return b=Math.max(b,512+a.framesize-32)}function q(g,f,k,l,p,n,r){var u=g.internal_flags,y=0,q=[null,null],t=[null,null];if(4294479419!=u.Class_ID)return-3;if(0==l)return 0;var v=
c.copy_buffer(u,p,n,r,0);if(0>v)return v;n+=v;y+=v;t[0]=f;t[1]=k;if(ra.NEQ(g.scale,0)&&ra.NEQ(g.scale,1))for(v=0;v<l;++v)t[0][v]*=g.scale,2==u.channels_out&&(t[1][v]*=g.scale);if(ra.NEQ(g.scale_left,0)&&ra.NEQ(g.scale_left,1))for(v=0;v<l;++v)t[0][v]*=g.scale_left;if(ra.NEQ(g.scale_right,0)&&ra.NEQ(g.scale_right,1))for(v=0;v<l;++v)t[1][v]*=g.scale_right;if(2==g.num_channels&&1==u.channels_out)for(v=0;v<l;++v)t[0][v]=.5*(t[0][v]+t[1][v]),t[1][v]=0;f=b(g);q[0]=u.mfbuf[0];q[1]=u.mfbuf[1];for(k=0;0<l;){var w=
[null,null];w[0]=t[0];w[1]=t[1];v=new a;var x=g;var A=q;var B=k,F=l,T=v,E=x.internal_flags;if(.9999>E.resample_ratio||1.0001<E.resample_ratio)for(var S=0;S<E.channels_out;S++){var L=new m,I=T,C,W=A[S],P=E.mf_size,U=x.framesize,X=w[S],fa=B,R=F,Z=L,ba=S,V=x.internal_flags,da=0,sa=x.out_samplerate/z(x.out_samplerate,x.in_samplerate);sa>Y.BPC&&(sa=Y.BPC);var oa=1E-4>Math.abs(V.resample_ratio-Math.floor(.5+V.resample_ratio))?1:0;var O=1/V.resample_ratio;1<O&&(O=1);var ma=31;0==ma%2&&--ma;ma+=oa;oa=ma+
1;if(0==V.fill_buffer_resample_init){V.inbuf_old[0]=G(oa);V.inbuf_old[1]=G(oa);for(C=0;C<=2*sa;++C)V.blackfilt[C]=G(oa);V.itime[0]=0;for(da=V.itime[1]=0;da<=2*sa;da++){var K=0,ya=(da-sa)/(2*sa);for(C=0;C<=ma;C++){var Aa=V.blackfilt[da],Ba=C,ta=C-ya,La=Math.PI*O;ta/=ma;0>ta&&(ta=0);1<ta&&(ta=1);var Ma=ta-.5;ta=.42-.5*Math.cos(2*ta*Math.PI)+.08*Math.cos(4*ta*Math.PI);K+=Aa[Ba]=1E-9>Math.abs(Ma)?La/Math.PI:ta*Math.sin(ma*La*Ma)/(Math.PI*ma*Ma)}for(C=0;C<=ma;C++)V.blackfilt[da][C]/=K}V.fill_buffer_resample_init=
1}K=V.inbuf_old[ba];for(O=0;O<U;O++){C=O*V.resample_ratio;da=0|Math.floor(C-V.itime[ba]);if(ma+da-ma/2>=R)break;ya=C-V.itime[ba]-(da+ma%2*.5);ya=0|Math.floor(2*ya*sa+sa+.5);for(C=Aa=0;C<=ma;++C)Ba=C+da-ma/2,Aa+=(0>Ba?K[oa+Ba]:X[fa+Ba])*V.blackfilt[ya][C];W[P+O]=Aa}Z.num_used=Math.min(R,ma+da-ma/2);V.itime[ba]+=Z.num_used-O*V.resample_ratio;if(Z.num_used>=oa)for(C=0;C<oa;C++)K[C]=X[fa+Z.num_used+C-oa];else{W=oa-Z.num_used;for(C=0;C<W;++C)K[C]=K[C+Z.num_used];for(da=0;C<oa;++C,++da)K[C]=X[fa+da]}I.n_out=
O;T.n_in=L.num_used}else for(T.n_out=Math.min(x.framesize,F),T.n_in=T.n_out,x=0;x<T.n_out;++x)A[0][E.mf_size+x]=w[0][B+x],2==E.channels_out&&(A[1][E.mf_size+x]=w[1][B+x]);A=v.n_in;v=v.n_out;if(u.findReplayGain&&!u.decode_on_the_fly&&h.AnalyzeSamples(u.rgdata,q[0],u.mf_size,q[1],u.mf_size,v,u.channels_out)==ca.GAIN_ANALYSIS_ERROR)return-6;l-=A;k+=A;u.mf_size+=v;1>u.mf_samples_to_encode&&(u.mf_samples_to_encode=d.ENCDELAY+d.POSTDELAY);u.mf_samples_to_encode+=v;if(u.mf_size>=f){A=r-y;0==r&&(A=0);v=g;
A=e.enc.lame_encode_mp3_frame(v,q[0],q[1],p,n,A);v.frameNum++;v=A;if(0>v)return v;n+=v;y+=v;u.mf_size-=g.framesize;u.mf_samples_to_encode-=g.framesize;for(A=0;A<u.channels_out;A++)for(v=0;v<u.mf_size;v++)q[A][v]=q[A][v+g.framesize]}}return y}function a(){this.n_out=this.n_in=0}function m(){this.num_used=0}function z(a,b){return 0!=b?z(b,a%b):a}var e=this;X.V9=410;X.V8=420;X.V7=430;X.V6=440;X.V5=450;X.V4=460;X.V3=470;X.V2=480;X.V1=490;X.V0=500;X.R3MIX=1E3;X.STANDARD=1001;X.EXTREME=1002;X.INSANE=1003;
X.STANDARD_FAST=1004;X.EXTREME_FAST=1005;X.MEDIUM=1006;X.MEDIUM_FAST=1007;X.LAME_MAXMP3BUFFER=147456;var h,c,k,r,E,n=new Pb,p,x,I;this.enc=new d;this.setModules=function(a,b,d,f,e,l,m,q,t){h=a;c=b;k=d;r=f;E=e;p=l;x=q;I=t;this.enc.setModules(c,n,r,p)};this.lame_init=function(){var a=new Bc;a.class_id=4294479419;var b=a.internal_flags=new Y;a.mode=da.NOT_SET;a.original=1;a.in_samplerate=44100;a.num_channels=2;a.num_samples=-1;a.bWriteVbrTag=!0;a.quality=-1;a.short_blocks=null;b.subblock_gain=-1;a.lowpassfreq=
0;a.highpassfreq=0;a.lowpasswidth=-1;a.highpasswidth=-1;a.VBR=C.vbr_off;a.VBR_q=4;a.ATHcurve=-1;a.VBR_mean_bitrate_kbps=128;a.VBR_min_bitrate_kbps=0;a.VBR_max_bitrate_kbps=0;a.VBR_hard_min=0;b.VBR_min_bitrate=1;b.VBR_max_bitrate=13;a.quant_comp=-1;a.quant_comp_short=-1;a.msfix=-1;b.resample_ratio=1;b.OldValue[0]=180;b.OldValue[1]=180;b.CurrentStep[0]=4;b.CurrentStep[1]=4;b.masking_lower=1;b.nsPsy.attackthre=-1;b.nsPsy.attackthre_s=-1;a.scale=-1;a.athaa_type=-1;a.ATHtype=-1;a.athaa_loudapprox=-1;a.athaa_sensitivity=
0;a.useTemporal=null;a.interChRatio=-1;b.mf_samples_to_encode=d.ENCDELAY+d.POSTDELAY;a.encoder_padding=0;b.mf_size=d.ENCDELAY-d.MDCTDELAY;a.findReplayGain=!1;a.decode_on_the_fly=!1;b.decode_on_the_fly=!1;b.findReplayGain=!1;b.findPeakSample=!1;b.RadioGain=0;b.AudiophileGain=0;b.noclipGainChange=0;b.noclipScale=-1;a.preset=0;a.write_id3tag_automatic=!0;a.lame_allocated_gfp=1;return a};this.nearestBitrateFullIndex=function(a){var b=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320];var c=b[16];
var d=16;var g=b[16];var f=16;for(var e=0;16>e;e++)if(Math.max(a,b[e+1])!=a){c=b[e+1];d=e+1;g=b[e];f=e;break}return c-a>a-g?f:d};this.lame_init_params=function(a){var b=a.internal_flags;b.Class_ID=0;null==b.ATH&&(b.ATH=new Ac);null==b.PSY&&(b.PSY=new v);null==b.rgdata&&(b.rgdata=new Dc);b.channels_in=a.num_channels;1==b.channels_in&&(a.mode=da.MONO);b.channels_out=a.mode==da.MONO?1:2;b.mode_ext=d.MPG_MD_MS_LR;a.mode==da.MONO&&(a.force_ms=!1);a.VBR==C.vbr_off&&128!=a.VBR_mean_bitrate_kbps&&0==a.brate&&
(a.brate=a.VBR_mean_bitrate_kbps);a.VBR!=C.vbr_off&&a.VBR!=C.vbr_mtrh&&a.VBR!=C.vbr_mt&&(a.free_format=!1);a.VBR==C.vbr_off&&0==a.brate&&ra.EQ(a.compression_ratio,0)&&(a.compression_ratio=11.025);a.VBR==C.vbr_off&&0<a.compression_ratio&&(0==a.out_samplerate&&(a.out_samplerate=map2MP3Frequency(int(.97*a.in_samplerate))),a.brate=0|16*a.out_samplerate*b.channels_out/(1E3*a.compression_ratio),b.samplerate_index=F(a.out_samplerate,a),a.free_format||(a.brate=B(a.brate,a.version,a.out_samplerate)));0!=a.out_samplerate&&
(16E3>a.out_samplerate?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,64)):32E3>a.out_samplerate?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,160)):(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,32),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,320)));if(0==a.lowpassfreq){switch(a.VBR){case C.vbr_off:var e=new l;f(e,a.brate);e=e.lowerlimit;
break;case C.vbr_abr:e=new l;f(e,a.VBR_mean_bitrate_kbps);e=e.lowerlimit;break;case C.vbr_rh:var g=[19500,19E3,18600,18E3,17500,16E3,15600,14900,12500,1E4,3950];if(0<=a.VBR_q&&9>=a.VBR_q){e=g[a.VBR_q];g=g[a.VBR_q+1];var m=a.VBR_q_frac;e=linear_int(e,g,m)}else e=19500;break;default:g=[19500,19E3,18500,18E3,17500,16500,15500,14500,12500,9500,3950],0<=a.VBR_q&&9>=a.VBR_q?(e=g[a.VBR_q],g=g[a.VBR_q+1],m=a.VBR_q_frac,e=linear_int(e,g,m)):e=19500}a.mode!=da.MONO||a.VBR!=C.vbr_off&&a.VBR!=C.vbr_abr||(e*=
1.5);a.lowpassfreq=e|0}0==a.out_samplerate&&(2*a.lowpassfreq>a.in_samplerate&&(a.lowpassfreq=a.in_samplerate/2),e=a.lowpassfreq|0,g=a.in_samplerate,m=44100,48E3<=g?m=48E3:44100<=g?m=44100:32E3<=g?m=32E3:24E3<=g?m=24E3:22050<=g?m=22050:16E3<=g?m=16E3:12E3<=g?m=12E3:11025<=g?m=11025:8E3<=g&&(m=8E3),-1==e?e=m:(15960>=e&&(m=44100),15250>=e&&(m=32E3),11220>=e&&(m=24E3),9970>=e&&(m=22050),7230>=e&&(m=16E3),5420>=e&&(m=12E3),4510>=e&&(m=11025),3970>=e&&(m=8E3),e=g<m?44100<g?48E3:32E3<g?44100:24E3<g?32E3:
22050<g?24E3:16E3<g?22050:12E3<g?16E3:11025<g?12E3:8E3<g?11025:8E3:m),a.out_samplerate=e);a.lowpassfreq=Math.min(20500,a.lowpassfreq);a.lowpassfreq=Math.min(a.out_samplerate/2,a.lowpassfreq);a.VBR==C.vbr_off&&(a.compression_ratio=16*a.out_samplerate*b.channels_out/(1E3*a.brate));a.VBR==C.vbr_abr&&(a.compression_ratio=16*a.out_samplerate*b.channels_out/(1E3*a.VBR_mean_bitrate_kbps));a.bWriteVbrTag||(a.findReplayGain=!1,a.decode_on_the_fly=!1,b.findPeakSample=!1);b.findReplayGain=a.findReplayGain;b.decode_on_the_fly=
a.decode_on_the_fly;b.decode_on_the_fly&&(b.findPeakSample=!0);if(b.findReplayGain&&h.InitGainAnalysis(b.rgdata,a.out_samplerate)==ca.INIT_GAIN_ANALYSIS_ERROR)return a.internal_flags=null,-6;b.decode_on_the_fly&&!a.decode_only&&(null!=b.hip&&I.hip_decode_exit(b.hip),b.hip=I.hip_decode_init());b.mode_gr=24E3>=a.out_samplerate?1:2;a.framesize=576*b.mode_gr;a.encoder_delay=d.ENCDELAY;b.resample_ratio=a.in_samplerate/a.out_samplerate;switch(a.VBR){case C.vbr_mt:case C.vbr_rh:case C.vbr_mtrh:a.compression_ratio=
[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][a.VBR_q];break;case C.vbr_abr:a.compression_ratio=16*a.out_samplerate*b.channels_out/(1E3*a.VBR_mean_bitrate_kbps);break;default:a.compression_ratio=16*a.out_samplerate*b.channels_out/(1E3*a.brate)}a.mode==da.NOT_SET&&(a.mode=da.JOINT_STEREO);0<a.highpassfreq?(b.highpass1=2*a.highpassfreq,b.highpass2=0<=a.highpasswidth?2*(a.highpassfreq+a.highpasswidth):2*a.highpassfreq,b.highpass1/=a.out_samplerate,b.highpass2/=a.out_samplerate):(b.highpass1=0,b.highpass2=
0);0<a.lowpassfreq?(b.lowpass2=2*a.lowpassfreq,0<=a.lowpasswidth?(b.lowpass1=2*(a.lowpassfreq-a.lowpasswidth),0>b.lowpass1&&(b.lowpass1=0)):b.lowpass1=2*a.lowpassfreq,b.lowpass1/=a.out_samplerate,b.lowpass2/=a.out_samplerate):(b.lowpass1=0,b.lowpass2=0);e=a.internal_flags;var q=32,t=-1;if(0<e.lowpass1){var z=999;for(g=0;31>=g;g++)m=g/31,m>=e.lowpass2&&(q=Math.min(q,g)),e.lowpass1<m&&m<e.lowpass2&&(z=Math.min(z,g));e.lowpass1=999==z?(q-.75)/31:(z-.75)/31;e.lowpass2=q/31}0<e.highpass2&&e.highpass2<
.75/31*.9&&(e.highpass1=0,e.highpass2=0,U.err.println("Warning: highpass filter disabled.  highpass frequency too small\n"));if(0<e.highpass2){q=-1;for(g=0;31>=g;g++)m=g/31,m<=e.highpass1&&(t=Math.max(t,g)),e.highpass1<m&&m<e.highpass2&&(q=Math.max(q,g));e.highpass1=t/31;e.highpass2=-1==q?(t+.75)/31:(q+.75)/31}for(g=0;32>g;g++)m=g/31,t=e.highpass2>e.highpass1?W((e.highpass2-m)/(e.highpass2-e.highpass1+1E-20)):1,m=e.lowpass2>e.lowpass1?W((m-e.lowpass1)/(e.lowpass2-e.lowpass1+1E-20)):1,e.amp_filter[g]=
t*m;b.samplerate_index=F(a.out_samplerate,a);if(0>b.samplerate_index)return a.internal_flags=null,-1;if(a.VBR==C.vbr_off)if(a.free_format)b.bitrate_index=0;else{if(a.brate=B(a.brate,a.version,a.out_samplerate),b.bitrate_index=P(a.brate,a.version,a.out_samplerate),0>=b.bitrate_index)return a.internal_flags=null,-1}else b.bitrate_index=1;a.analysis&&(a.bWriteVbrTag=!1);null!=b.pinfo&&(a.bWriteVbrTag=!1);c.init_bit_stream_w(b);e=b.samplerate_index+3*a.version+6*(16E3>a.out_samplerate?1:0);for(g=0;g<
d.SBMAX_l+1;g++)b.scalefac_band.l[g]=r.sfBandIndex[e].l[g];for(g=0;g<d.PSFB21+1;g++)m=(b.scalefac_band.l[22]-b.scalefac_band.l[21])/d.PSFB21,m=b.scalefac_band.l[21]+g*m,b.scalefac_band.psfb21[g]=m;b.scalefac_band.psfb21[d.PSFB21]=576;for(g=0;g<d.SBMAX_s+1;g++)b.scalefac_band.s[g]=r.sfBandIndex[e].s[g];for(g=0;g<d.PSFB12+1;g++)m=(b.scalefac_band.s[13]-b.scalefac_band.s[12])/d.PSFB12,m=b.scalefac_band.s[12]+g*m,b.scalefac_band.psfb12[g]=m;b.scalefac_band.psfb12[d.PSFB12]=192;b.sideinfo_len=1==a.version?
1==b.channels_out?21:36:1==b.channels_out?13:21;a.error_protection&&(b.sideinfo_len+=2);e=a.internal_flags;a.frameNum=0;a.write_id3tag_automatic&&x.id3tag_write_v2(a);e.bitrate_stereoMode_Hist=Ba([16,5]);e.bitrate_blockType_Hist=Ba([16,6]);e.PeakSample=0;a.bWriteVbrTag&&p.InitVbrTag(a);b.Class_ID=4294479419;for(e=0;19>e;e++)b.nsPsy.pefirbuf[e]=700*b.mode_gr*b.channels_out;-1==a.ATHtype&&(a.ATHtype=4);switch(a.VBR){case C.vbr_mt:a.VBR=C.vbr_mtrh;case C.vbr_mtrh:null==a.useTemporal&&(a.useTemporal=
!1);k.apply_preset(a,500-10*a.VBR_q,0);0>a.quality&&(a.quality=LAME_DEFAULT_QUALITY);5>a.quality&&(a.quality=0);5<a.quality&&(a.quality=5);b.PSY.mask_adjust=a.maskingadjust;b.PSY.mask_adjust_short=a.maskingadjust_short;b.sfb21_extra=a.experimentalY?!1:44E3<a.out_samplerate;b.iteration_loop=new VBRNewIterationLoop(E);break;case C.vbr_rh:k.apply_preset(a,500-10*a.VBR_q,0);b.PSY.mask_adjust=a.maskingadjust;b.PSY.mask_adjust_short=a.maskingadjust_short;b.sfb21_extra=a.experimentalY?!1:44E3<a.out_samplerate;
6<a.quality&&(a.quality=6);0>a.quality&&(a.quality=LAME_DEFAULT_QUALITY);b.iteration_loop=new VBROldIterationLoop(E);break;default:b.sfb21_extra=!1,0>a.quality&&(a.quality=LAME_DEFAULT_QUALITY),e=a.VBR,e==C.vbr_off&&(a.VBR_mean_bitrate_kbps=a.brate),k.apply_preset(a,a.VBR_mean_bitrate_kbps,0),a.VBR=e,b.PSY.mask_adjust=a.maskingadjust,b.PSY.mask_adjust_short=a.maskingadjust_short,b.iteration_loop=e==C.vbr_off?new Cc(E):new ABRIterationLoop(E)}if(a.VBR!=C.vbr_off){b.VBR_min_bitrate=1;b.VBR_max_bitrate=
14;16E3>a.out_samplerate&&(b.VBR_max_bitrate=8);if(0!=a.VBR_min_bitrate_kbps&&(a.VBR_min_bitrate_kbps=B(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),b.VBR_min_bitrate=P(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),0>b.VBR_min_bitrate)||0!=a.VBR_max_bitrate_kbps&&(a.VBR_max_bitrate_kbps=B(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),b.VBR_max_bitrate=P(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),0>b.VBR_max_bitrate))return-1;a.VBR_min_bitrate_kbps=w.bitrate_table[a.version][b.VBR_min_bitrate];
a.VBR_max_bitrate_kbps=w.bitrate_table[a.version][b.VBR_max_bitrate];a.VBR_mean_bitrate_kbps=Math.min(w.bitrate_table[a.version][b.VBR_max_bitrate],a.VBR_mean_bitrate_kbps);a.VBR_mean_bitrate_kbps=Math.max(w.bitrate_table[a.version][b.VBR_min_bitrate],a.VBR_mean_bitrate_kbps)}a.tune&&(b.PSY.mask_adjust+=a.tune_value_a,b.PSY.mask_adjust_short+=a.tune_value_a);e=a.internal_flags;switch(a.quality){default:case 9:e.psymodel=0;e.noise_shaping=0;e.noise_shaping_amp=0;e.noise_shaping_stop=0;e.use_best_huffman=
0;e.full_outer_loop=0;break;case 8:a.quality=7;case 7:e.psymodel=1;e.noise_shaping=0;e.noise_shaping_amp=0;e.noise_shaping_stop=0;e.use_best_huffman=0;e.full_outer_loop=0;break;case 6:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);e.noise_shaping_amp=0;e.noise_shaping_stop=0;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=0;e.full_outer_loop=0;break;case 5:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);e.noise_shaping_amp=0;e.noise_shaping_stop=0;-1==e.subblock_gain&&(e.subblock_gain=
1);e.use_best_huffman=0;e.full_outer_loop=0;break;case 4:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);e.noise_shaping_amp=0;e.noise_shaping_stop=0;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=1;e.full_outer_loop=0;break;case 3:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);e.noise_shaping_amp=1;e.noise_shaping_stop=1;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=1;e.full_outer_loop=0;break;case 2:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);0==e.substep_shaping&&
(e.substep_shaping=2);e.noise_shaping_amp=1;e.noise_shaping_stop=1;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=1;e.full_outer_loop=0;break;case 1:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);0==e.substep_shaping&&(e.substep_shaping=2);e.noise_shaping_amp=2;e.noise_shaping_stop=1;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=1;e.full_outer_loop=0;break;case 0:e.psymodel=1,0==e.noise_shaping&&(e.noise_shaping=1),0==e.substep_shaping&&(e.substep_shaping=2),e.noise_shaping_amp=
2,e.noise_shaping_stop=1,-1==e.subblock_gain&&(e.subblock_gain=1),e.use_best_huffman=1,e.full_outer_loop=0}b.ATH.useAdjust=0>a.athaa_type?3:a.athaa_type;b.ATH.aaSensitivityP=Math.pow(10,a.athaa_sensitivity/-10);null==a.short_blocks&&(a.short_blocks=ya.short_block_allowed);a.short_blocks!=ya.short_block_allowed||a.mode!=da.JOINT_STEREO&&a.mode!=da.STEREO||(a.short_blocks=ya.short_block_coupled);0>a.quant_comp&&(a.quant_comp=1);0>a.quant_comp_short&&(a.quant_comp_short=0);0>a.msfix&&(a.msfix=0);a.exp_nspsytune|=
1;0>a.internal_flags.nsPsy.attackthre&&(a.internal_flags.nsPsy.attackthre=Pb.NSATTACKTHRE);0>a.internal_flags.nsPsy.attackthre_s&&(a.internal_flags.nsPsy.attackthre_s=Pb.NSATTACKTHRE_S);0>a.scale&&(a.scale=1);0>a.ATHtype&&(a.ATHtype=4);0>a.ATHcurve&&(a.ATHcurve=4);0>a.athaa_loudapprox&&(a.athaa_loudapprox=2);0>a.interChRatio&&(a.interChRatio=0);null==a.useTemporal&&(a.useTemporal=!0);b.slot_lag=b.frac_SpF=0;a.VBR==C.vbr_off&&(b.slot_lag=b.frac_SpF=72E3*(a.version+1)*a.brate%a.out_samplerate|0);r.iteration_init(a);
n.psymodel_init(a);return 0};this.lame_encode_flush=function(a,e,f,h){var g=a.internal_flags,k=ma([2,1152]),l=0,m=g.mf_samples_to_encode-d.POSTDELAY,p=b(a);if(1>g.mf_samples_to_encode)return 0;var n=0;a.in_samplerate!=a.out_samplerate&&(m+=16*a.out_samplerate/a.in_samplerate);var q=a.framesize-m%a.framesize;576>q&&(q+=a.framesize);a.encoder_padding=q;for(q=(m+q)/a.framesize;0<q&&0<=l;){var r=p-g.mf_size;m=a.frameNum;r*=a.in_samplerate;r/=a.out_samplerate;1152<r&&(r=1152);1>r&&(r=1);l=h-n;0==h&&(l=
0);l=this.lame_encode_buffer(a,k[0],k[1],r,e,f,l);f+=l;n+=l;q-=m!=a.frameNum?1:0}g.mf_samples_to_encode=0;if(0>l)return l;l=h-n;0==h&&(l=0);c.flush_bitstream(a);l=c.copy_buffer(g,e,f,l,1);if(0>l)return l;f+=l;n+=l;l=h-n;0==h&&(l=0);if(a.write_id3tag_automatic){x.id3tag_write_v1(a);l=c.copy_buffer(g,e,f,l,0);if(0>l)return l;n+=l}return n};this.lame_encode_buffer=function(a,b,c,e,d,f,h){var g=a.internal_flags,k=[null,null];if(4294479419!=g.Class_ID)return-3;if(0==e)return 0;if(null==g.in_buffer_0||
g.in_buffer_nsamples<e)g.in_buffer_0=G(e),g.in_buffer_1=G(e),g.in_buffer_nsamples=e;k[0]=g.in_buffer_0;k[1]=g.in_buffer_1;for(var l=0;l<e;l++)k[0][l]=b[l],1<g.channels_in&&(k[1][l]=c[l]);return q(a,k[0],k[1],e,d,f,h)}}function Lc(){this.setModules=function(d,l){}}function Mc(){this.setModules=function(d,l,t){}}function Nc(){}function Oc(){this.setModules=function(d,l){}}function Aa(){this.sampleRate=this.channels=this.dataLen=this.dataOffset=0}function bc(d){return d.charCodeAt(0)<<24|d.charCodeAt(1)<<
16|d.charCodeAt(2)<<8|d.charCodeAt(3)}var La={fill:function(d,l,t,w){if(2==arguments.length)for(var v=0;v<d.length;v++)d[v]=arguments[1];else for(v=l;v<t;v++)d[v]=w}},U={arraycopy:function(d,l,t,w,F){for(F=l+F;l<F;)t[w++]=d[l++]}},ba={SQRT2:1.4142135623730951,FAST_LOG10:function(d){return Math.log10(d)},FAST_LOG10_X:function(d,l){return Math.log10(d)*l}};ya.short_block_allowed=new ya(0);ya.short_block_coupled=new ya(1);ya.short_block_dispensed=new ya(2);ya.short_block_forced=new ya(3);var Ya={MAX_VALUE:3.4028235E38};
C.vbr_off=new C(0);C.vbr_mt=new C(1);C.vbr_rh=new C(2);C.vbr_abr=new C(3);C.vbr_mtrh=new C(4);C.vbr_default=C.vbr_mtrh;da.STEREO=new da(0);da.JOINT_STEREO=new da(1);da.DUAL_CHANNEL=new da(2);da.MONO=new da(3);da.NOT_SET=new da(4);ca.STEPS_per_dB=100;ca.MAX_dB=120;ca.GAIN_NOT_ENOUGH_SAMPLES=-24601;ca.GAIN_ANALYSIS_ERROR=0;ca.GAIN_ANALYSIS_OK=1;ca.INIT_GAIN_ANALYSIS_ERROR=0;ca.INIT_GAIN_ANALYSIS_OK=1;ca.YULE_ORDER=10;ca.MAX_ORDER=ca.YULE_ORDER;ca.MAX_SAMP_FREQ=48E3;ca.RMS_WINDOW_TIME_NUMERATOR=1;ca.RMS_WINDOW_TIME_DENOMINATOR=
20;ca.MAX_SAMPLES_PER_WINDOW=ca.MAX_SAMP_FREQ*ca.RMS_WINDOW_TIME_NUMERATOR/ca.RMS_WINDOW_TIME_DENOMINATOR+1;sb.NUMTOCENTRIES=100;sb.MAXFRAMESIZE=2880;ra.EQ=function(d,l){return Math.abs(d)>Math.abs(l)?Math.abs(d-l)<=1E-6*Math.abs(d):Math.abs(d-l)<=1E-6*Math.abs(l)};ra.NEQ=function(d,l){return!ra.EQ(d,l)};var w={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,
8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,
58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,
50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,
1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,
109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,
75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,
386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,
285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,
364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,
10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,
12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,
16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,
10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,
12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,
13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,
10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,
12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,
12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,
7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};w.ht=[new Z(0,0,null,null),new Z(2,0,w.t1HB,w.t1l),new Z(3,0,w.t2HB,w.t2l),new Z(3,0,w.t3HB,w.t3l),new Z(0,0,null,null),new Z(4,0,w.t5HB,w.t5l),new Z(4,0,w.t6HB,w.t6l),new Z(6,0,w.t7HB,w.t7l),new Z(6,0,w.t8HB,w.t8l),new Z(6,0,w.t9HB,w.t9l),new Z(8,0,w.t10HB,w.t10l),new Z(8,0,w.t11HB,w.t11l),new Z(8,0,w.t12HB,w.t12l),new Z(16,0,w.t13HB,w.t13l),new Z(0,0,null,w.t16_5l),new Z(16,0,w.t15HB,w.t15l),new Z(1,1,w.t16HB,w.t16l),new Z(2,3,w.t16HB,w.t16l),
new Z(3,7,w.t16HB,w.t16l),new Z(4,15,w.t16HB,w.t16l),new Z(6,63,w.t16HB,w.t16l),new Z(8,255,w.t16HB,w.t16l),new Z(10,1023,w.t16HB,w.t16l),new Z(13,8191,w.t16HB,w.t16l),new Z(4,15,w.t24HB,w.t24l),new Z(5,31,w.t24HB,w.t24l),new Z(6,63,w.t24HB,w.t24l),new Z(7,127,w.t24HB,w.t24l),new Z(8,255,w.t24HB,w.t24l),new Z(9,511,w.t24HB,w.t24l),new Z(11,2047,w.t24HB,w.t24l),new Z(13,8191,w.t24HB,w.t24l),new Z(0,0,w.t32HB,w.t32l),new Z(0,0,w.t33HB,w.t33l)];w.largetbl=[65540,327685,458759,589832,655369,655370,720906,
720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,
720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,
917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,
1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];w.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];w.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];w.bitrate_table=[[0,8,
16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];w.samplerate_table=[[22050,24E3,16E3,-1],[44100,48E3,32E3,-1],[11025,12E3,8E3,-1]];w.scfsi_band=[0,6,11,16,21];oa.Q_MAX=257;oa.Q_MAX2=116;oa.LARGE_BITS=1E5;oa.IXMAX_VAL=8206;var ta={};ta.SFBMAX=3*d.SBMAX_s;d.ENCDELAY=576;d.POSTDELAY=1152;d.MDCTDELAY=48;d.FFTOFFSET=224+d.MDCTDELAY;d.DECDELAY=528;d.SBLIMIT=32;d.CBANDS=64;d.SBPSY_l=21;d.SBPSY_s=12;d.SBMAX_l=
22;d.SBMAX_s=13;d.PSFB21=6;d.PSFB12=6;d.BLKSIZE=1024;d.HBLKSIZE=d.BLKSIZE/2+1;d.BLKSIZE_s=256;d.HBLKSIZE_s=d.BLKSIZE_s/2+1;d.NORM_TYPE=0;d.START_TYPE=1;d.SHORT_TYPE=2;d.STOP_TYPE=3;d.MPG_MD_LR_LR=0;d.MPG_MD_LR_I=1;d.MPG_MD_MS_LR=2;d.MPG_MD_MS_I=3;d.fircoef=[-.1039435,-.1892065,-.0432472*5,-.155915,3.898045E-17,.0467745*5,.50455,.756825,.187098*5];Y.MFSIZE=3456+d.ENCDELAY-d.MDCTDELAY;Y.MAX_HEADER_BUF=256;Y.MAX_BITS_PER_CHANNEL=4095;Y.MAX_BITS_PER_GRANULE=7680;Y.BPC=320;Aa.RIFF=bc("RIFF");Aa.WAVE=bc("WAVE");
Aa.fmt_=bc("fmt ");Aa.data=bc("data");Aa.readHeader=function(d){var l=new Aa,t=d.getUint32(0,!1);if(Aa.RIFF==t&&(d.getUint32(4,!0),Aa.WAVE==d.getUint32(8,!1)&&Aa.fmt_==d.getUint32(12,!1))){var v=d.getUint32(16,!0),w=20;switch(v){case 16:case 18:l.channels=d.getUint16(w+2,!0);l.sampleRate=d.getUint32(w+4,!0);break;default:throw"extended fmt chunk not implemented";}w+=v;v=Aa.data;for(var B=0;v!=t;){t=d.getUint32(w,!1);B=d.getUint32(w+4,!0);if(v==t)break;w+=B+8}l.dataLen=B;l.dataOffset=w+8;return l}};
ta.SFBMAX=3*d.SBMAX_s;lamejs.Mp3Encoder=function(d,l,t){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),d=1,l=44100,t=128);var v=new X,w=new Lc,B=new ca,C=new ra,f=new xc,b=new oa,q=new Fc,a=new sb,m=new kc,z=new Oc,e=new yc,h=new cb,c=new Mc,k=new Nc;v.setModules(B,C,f,b,q,a,m,z,k);C.setModules(B,k,m,a);z.setModules(C,m);f.setModules(v);q.setModules(C,e,b,h);b.setModules(h,e,v.enc.psy);e.setModules(C);h.setModules(b);a.setModules(v,C,m);w.setModules(c,
k);c.setModules(m,z,f);var r=v.lame_init();r.num_channels=d;r.in_samplerate=l;r.brate=t;r.mode=da.STEREO;r.quality=3;r.bWriteVbrTag=!1;r.disable_reservoir=!0;r.write_id3tag_automatic=!1;v.lame_init_params(r);var E=1152,n=0|1.25*E+7200,p=new Int8Array(n);this.encodeBuffer=function(a,b){1==d&&(b=a);a.length>E&&(E=a.length,n=0|1.25*E+7200,p=new Int8Array(n));var c=v.lame_encode_buffer(r,a,b,a.length,p,0,n);return new Int8Array(p.subarray(0,c))};this.flush=function(){var a=v.lame_encode_flush(r,p,0,n);
return new Int8Array(p.subarray(0,a))}};lamejs.WavHeader=Aa}lamejs();var sample_rate=44100,kbps=128,channels=1,mp3encoder=null,samples_left=null,samples_right=null,first_buffer=!0;
onmessage=function(P){if(P.data)if(P.data.sample_rate)sample_rate=P.data.sample_rate/1,kbps=P.data.kbps/1,channels=P.data.channels/1;else{if(first_buffer&&(samples_left=new Int16Array(P.data),first_buffer=!1,1<channels))return;P.data&&1<channels&&(samples_right=new Int16Array(P.data));mp3encoder||(mp3encoder=new lamejs.Mp3Encoder(channels,sample_rate,kbps));P=[];for(var G=0,V,Ba=null,ma=0;ma<samples_left.length;ma+=2304)V=samples_left.subarray(ma,ma+2304),samples_right&&(Ba=samples_right.subarray(ma,
ma+2304)),V=mp3encoder.encodeBuffer(V,Ba),ma/samples_left.length*100>>0>G&&(G=ma/samples_left.length*100>>0,postMessage({percentage:G})),0<V.length&&P.push(V);V=mp3encoder.flush();0<V.length&&P.push(V);postMessage(P)}};