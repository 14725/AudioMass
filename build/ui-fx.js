(function(p,u,r){function t(){var b={};this.Set=function(f,e){var a=b[f];a||(a=[],b[f]=a);a.push(e);localStorage.setItem("pk_presetfx",JSON.stringify(b));return a};this.Save=function(){localStorage.setItem("pk_presetfx",JSON.stringify(b))};this.Get=function(f){return f?b[f]:b};this.GetSingle=function(f,e){if(!f||!e)return!1;for(var a=b[f],c=a.length,d=null;0<c--;)if(a[c].id===e){d=a[c];break}return d?d:!1};this.Del=function(f,e){if(!f)return b;for(var a=b[f],c=a.length,d=!1;0<c--;)if(a[c].id===e){a.splice(c,
1);d=!0;break}d&&localStorage.setItem("pk_presetfx",JSON.stringify(b));return a};if(p.localStorage){var l=p.localStorage.getItem("pk_presetfx"),h=null;if(l){try{h=JSON.parse(l)}catch(f){}h&&(b=h)}}else this.Set=function(){}}r._deps.uifx=function(b){var l=b.ui,h=null,f=new t;b.listenFor("DidCloseFX_UI",function(){h=null});b.listenFor("DidOpenFX_UI",function(a){h=a});b.listenFor("RequestFXUI_Gain",function(){b.fireEvent("RequestSelect",1);(new PKAudioFXModal({id:"gain",title:"Apply Gain to selected range",
presets:[{name:"Silence",val:0},{name:"-50%",val:.5},{name:"-25%",val:.75},{name:"+25%",val:1.25},{name:"+50%",val:1.5},{name:"+100%",val:2}],custom_pres:f.Get("gain"),ondestroy:function(a){b.ui.InteractionHandler.on=!1;b.ui.KeyHandler.removeCallback("modalfxesc")},preview:function(a){a=a.el_body.getElementsByTagName("input")[0].value.trim()/1;b.fireEvent("RequestActionFX_PREVIEW_GAIN",a)},buttons:[{title:"Apply Gain",clss:"pk_modal_a_accpt",callback:function(a){var c=a.el_body.getElementsByTagName("input")[0].value.trim()/
1;1!=c&&b.fireEvent("RequestActionFX_GAIN",c);a.Destroy()}}],body:'<div class="pk_row" style="border:none"><label>Gain percentage</label><input type="range" class="pk_horiz" min="0.0" max="2.5" step="0.01" value="1.0" /><span class="pk_val">100%</span></div>',setup:function(a){var c=a.el_body.getElementsByTagName("input")[0],d=a.el_body.getElementsByTagName("span")[0];c.oninput=function(){d.innerHTML=(100*c.value>>0)+"%";b.fireEvent("RequestActionFX_UPDATE_PREVIEW",c.value/1)};b.fireEvent("RequestPause");
b.ui.InteractionHandler.checkAndSet("modalfx");b.ui.KeyHandler.addCallback("modalfxesc",function(c){b.ui.InteractionHandler.check("modalfx")&&a.Destroy()},[27])}},b)).Show()});b.listenFor("RequestActionFXUI_Speed",function(){b.fireEvent("RequestSelect",1);(new PKAudioFXModal({id:"speed",title:"Change Speed",presets:[{name:"-1/4",val:.25},{name:"-1/2",val:.5},{name:"Slightly slower",val:.85},{name:"Slightly faster%",val:1.1},{name:"+1/4",val:1.25},{name:"+1/2",val:1.5}],custom_pres:f.Get("speed"),
ondestroy:function(a){b.ui.InteractionHandler.on=!1;b.ui.KeyHandler.removeCallback("modalfxesc")},preview:function(a){a=a.el_body.getElementsByTagName("input")[0].value.trim()/1;b.fireEvent("RequestActionFX_PREVIEW_SPEED",a)},buttons:[{title:"Apply Rate",clss:"pk_modal_a_accpt",callback:function(a){var c=a.el_body.getElementsByTagName("input")[0].value.trim()/1;1!=c&&b.fireEvent("RequestActionFX_SPEED",c);a.Destroy()}}],body:'<div class="pk_row" style="border:none"><label>Playback Rate</label><input type="range" class="pk_horiz" min="0.2" max="2.0" step="0.05" value="1.0" /><span class="pk_val">1.0</span></div>',
setup:function(a){var c=a.el_body.getElementsByTagName("input")[0],d=a.el_body.getElementsByTagName("span")[0];c.oninput=function(){d.innerHTML=c.value;b.fireEvent("RequestActionFX_UPDATE_PREVIEW",c.value/1)};b.fireEvent("RequestPause");b.ui.InteractionHandler.checkAndSet("modalfx");b.ui.KeyHandler.addCallback("modalfxesc",function(c){b.ui.InteractionHandler.check("modalfx")&&a.Destroy()},[27])}},b)).Show()});b.listenFor("RequestFXUI_Silence",function(){(new PKSimpleModal({title:"Insert Silence",
ondestroy:function(a){l.InteractionHandler.on=!1;l.KeyHandler.removeCallback("modalTemp")},buttons:[{title:"Insert Silence",clss:"pk_modal_a_accpt",callback:function(a){var b=a.el_body.getElementsByClassName("pk_horiz")[0].value.trim()/1,d=0;a.el_body.getElementsByClassName("pk_check")[1].checked&&(d=PKAudioEditor.engine.wavesurfer.getCurrentTime().toFixed(2)/1);.001<b&&l.fireEvent("RequestActionSilence",d,b);a.Destroy()}}],body:'<div class="pk_row"><input type="radio" class="pk_check" id="ifeq" name="rdslnc" value="beginning"><label  for="ifeq">Insert silence at beginning</label><br/><input type="radio" class="pk_check"  id="vgdja" name="rdslnc" checked value="cursor"><label for="vgdja">Insert silence at current cursor (<span class="pkcdpk"></span>)</label></div><div class="pk_row"><label>Silence in seconds</label><input type="range" min="0.0" max="30.0" class="pk_horiz" step="0.01" value="5.0" /><span class="pk_val">5s</span></div>',
setup:function(a){a.el_body.getElementsByClassName("pkcdpk")[0].innerHTML=PKAudioEditor.engine.wavesurfer.getCurrentTime().toFixed(2)+"s";var b=a.el_body.getElementsByClassName("pk_horiz")[0],d=a.el_body.getElementsByClassName("pk_val")[0];b.oninput=function(){d.innerHTML=(b.value/1).toFixed(2)+"s"};l.fireEvent("RequestPause");l.InteractionHandler.checkAndSet("modal");l.KeyHandler.addCallback("modalTemp",function(b){a.Destroy()},[27])}})).Show()});b.listenFor("RequestActionFXUI_Compressor",function(){b.fireEvent("RequestSelect",
1);(new PKAudioFXModal({id:"compressor",title:"Apply Compression to selected range",clss:"pk_bigger",ondestroy:function(a){b.ui.InteractionHandler.on=!1;b.ui.KeyHandler.removeCallback("modalfxesc")},presets:[{name:"Classic",val:"-40,5,7,0.002,0.1"},{name:"Light",val:"-6,2,2.5,0.002,0.05"},{name:"Dashed Distortion",val:"-45,26,2.05,0.233,0.0"},{name:"Chaotic Distortion",val:"-60,14,11.07,0.036,0.00"}],custom_pres:f.Get("compressor"),preview:function(a){a=a.el_body.getElementsByTagName("input");b.fireEvent("RequestActionFX_PREVIEW_COMPRESSOR",
{threshold:a[0].value/1,knee:a[1].value/1,ratio:a[2].value/1,attack:a[3].value/1,release:a[4].value/1})},buttons:[{title:"Apply",clss:"pk_modal_a_accpt",callback:function(a){var c=a.el_body.getElementsByTagName("input");b.fireEvent("RequestActionFX_Compressor",{threshold:c[0].value/1,knee:c[1].value/1,ratio:c[2].value/1,attack:c[3].value/1,release:c[4].value/1});a.Destroy()}}],body:'<div class="pk_row"><label class="pk_line">Threshold</label><input class="pk_horiz" type="range" min="-100" max="0" step="0.1" value="-24.0" /><span class="pk_val">-24.0</span></div><div class="pk_row"><label class="pk_line">Knee</label><input class="pk_horiz" type="range" min="0.0" max="40.0" step="0.01" value="30.0" /><span class="pk_val">30.0</span></div><div class="pk_row"><label class="pk_line">Ratio</label><input class="pk_horiz" type="range" min="1.0" max="20.0" step="0.01" value="12.0" /><span class="pk_val">12.0</span></div><div class="pk_row"><label class="pk_line">Attack</label><input class="pk_horiz" type="range" min="0.0" max="1.0" step="0.001" value="0.003" /><span class="pk_val">0.003</span></div><div class="pk_row" style="border:none"><label class="pk_line">Release</label><input class="pk_horiz" type="range" min="0.0" max="1.0" step="0.001" value="0.25" /><span class="pk_val">0.25</span></div>',
setup:function(a){for(var c=a.el_body.getElementsByTagName("input"),d=0;d<c.length;++d)c[d].oninput=function(){this.parentNode.getElementsByTagName("span")[0].innerHTML=(this.value/1).toFixed(3);var c=a.el_body.getElementsByTagName("input");b.fireEvent("RequestActionFX_UPDATE_PREVIEW",{threshold:c[0].value/1,knee:c[1].value/1,ratio:c[2].value/1,attack:c[3].value/1,release:c[4].value/1})};b.fireEvent("RequestPause");b.ui.InteractionHandler.checkAndSet("modalfx");b.ui.KeyHandler.addCallback("modalfxesc",
function(c){b.ui.InteractionHandler.check("modalfx")&&a.Destroy()},[27])}},b)).Show()});b.listenFor("RequestActionFXUI_Normalize",function(){b.fireEvent("RequestSelect",1);(new PKSimpleModal({title:"Normalize",ondestroy:function(a){b.ui.InteractionHandler.on=!1;b.ui.KeyHandler.removeCallback("modalTemp")},buttons:[{title:"Normalize Audio",clss:"pk_modal_a_accpt",callback:function(a){var c=a.el_body.getElementsByClassName("pk_horiz")[0].value/1,d=a.el_body.getElementsByClassName("pk_check")[0].checked;
b.fireEvent("RequestActionFX_Normalize",[d,c]);a.Destroy()}}],body:'<div class="pk_row"><input type="checkbox" id="vhcjgs" class="pk_check" name="normEqually"><label for="vhcjgs">Normalize L/R Equally</label></div><div class="pk_row" style="border:none"><label>Normalize to</label><input type="range" min="0.0" max="2.0" class="pk_horiz" step="0.01" value="1.0" /><span class="pk_val">100%</span></div>',setup:function(a){var c=a.el_body.getElementsByClassName("pk_horiz")[0],d=a.el_body.getElementsByClassName("pk_val")[0];
c.oninput=function(){d.innerHTML=(c.value/1*100>>0)+"%"};b.fireEvent("RequestPause");b.ui.InteractionHandler.checkAndSet("modal");b.ui.KeyHandler.addCallback("modalTemp",function(b){a.Destroy()},[27])}})).Show()});b.listenFor("RequestActionFXUI_ParaGraphicEQ",function(){PKAudioEditor._deps.FxEQ(b,f)});b.listenFor("RequestActionFXUI_GraphicEQ",function(a){b.fireEvent("RequestSelect",1);var c="graph_eq",d='<div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="32" data-type="lowshelf" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">< 32hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="64" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">64hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="125" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">125hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="250" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">250hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="500" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">500hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="1000" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">1000hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="2000" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">2000hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="4000" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">4000hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="8000" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">8000hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="16000" data-type="highshelf" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm"> >16000hz</span></div>',
e=[{name:"Reset",val:"0,0,0,0,0,0,0,0,0,0"},{name:"Old Radio",val:"-25,-22,-20,-18,-9,0,8,10,-8,-25"},{name:"Lo Fi",val:"-18,-12,0,2,0,4,4,-1,-6,-8"}],g=1.1;20===a&&(c+="_2",e=null,g=4,d='<div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="31" data-type="lowshelf" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">< 31hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="44" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">44hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="63" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">63hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="88" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">88hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="125" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">125hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="180" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">180hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="250" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">250hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="335" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">335hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="500" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">500hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="710" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">710hz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="1000" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">1khz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="1400" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">1.4khz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="2000" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">2khz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="2800" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">2.8khz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="4000" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">4khz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="5600" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">5.6khz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="8000" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">8khz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="11300" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">11.3khz</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="16000" data-type="peaking" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm">16k</span></div><div class="pk_col"><span class="pk_val">0 db</span><input class="pk_vert" data-freq="22000" data-type="highshelf" type="range" min="-25.0" max="25.0" step="0.01" value="0.0" /><span class="pk_btm"> >22khz</span></div>');
(new PKAudioFXModal({id:c,title:"Graphic EQ",clss:20===a?"pk_dens":"",custom_pres:f.Get(c),ondestroy:function(a){b.ui.InteractionHandler.on=!1;b.ui.KeyHandler.removeCallback("modalfxesc")},preview:function(a){var c=a.el_body.getElementsByTagName("input"),d=c.length;b.fireEvent("RequestActionFX_PREVIEW_PARAMEQ",function(){for(var a=[],b=0;b<d;++b){var m=c[b];a.push({type:m.getAttribute("data-type"),freq:m.getAttribute("data-freq")/1,val:m.value/1,q:g})}return a}())},buttons:[{title:"Apply EQ",clss:"pk_modal_a_accpt",
callback:function(a){var c=a.el_body.getElementsByTagName("input"),d=c.length;b.fireEvent("RequestActionFX_PARAMEQ",function(){for(var a=[],b=0;b<d;++b){var m=c[b];a.push({type:m.getAttribute("data-type"),freq:m.getAttribute("data-freq")/1,val:m.value/1,q:g})}return a}());a.Destroy()}}],presets:e,body:'<div class="pk_h200">'+d+'<div style="clear:both;"></div></div>',setup:function(a){for(var c=a.el_body.getElementsByTagName("input"),d=c.length,e=function(){for(var a=[],b=0;b<d;++b){var e=c[b];a.push({type:e.getAttribute("data-type"),
freq:e.getAttribute("data-freq")/1,val:e.value/1,q:g})}return a},f=0;f<d;++f)c[f].oninput=function(){this.parentNode.getElementsByTagName("span")[0].innerHTML=(this.value>>0)+" db";b.fireEvent("RequestActionFX_UPDATE_PREVIEW",e())};b.fireEvent("RequestPause");b.ui.InteractionHandler.checkAndSet("modalfx");b.ui.KeyHandler.addCallback("modalfxesc",function(c){b.ui.InteractionHandler.check("modalfx")&&a.Destroy()},[27])}},b)).Show()});b.listenFor("RequestActionFXUI_HardLimiter",function(){b.fireEvent("RequestSelect",
1);(new PKAudioFXModal({title:"Hard Limiting",ondestroy:function(a){b.ui.InteractionHandler.on=!1;b.ui.KeyHandler.removeCallback("modalTemp")},buttons:[{title:"Hard Limiting",clss:"pk_modal_a_accpt",callback:function(a){b.fireEvent("RequestActionFX_HardLimit",a.updateFilter(a));a.Destroy()}}],preview:function(a){b.fireEvent("RequestActionFX_PREVIEW_HardLimit",a.updateFilter(a))},body:'<div class="pk_row"><input type="checkbox" class="pk_check" id="xighs" name="normEqually"><label for="xighs">Hard Limiting</label></div><div class="pk_row"><label>Limit to</label><input type="range" min="0.1" max="1.0" class="pk_horiz pk_w180" step="0.01" value="0.99" /><span class="pk_val">99%</span></div><div class="pk_row"><label>Ratio between lows and highs</label><input type="range" min="0.0" max="1.0" class="pk_horiz pk_w180" step="0.01" value="0.0" /><span class="pk_val">Ratio 0%</span></div><div class="pk_row"><label>Look Ahead (ms)</label><input type="range" min="1.0" max="500.0" class="pk_horiz pk_w180" step="0.01" value="10.0" /><span class="pk_val">10 ms</span></div>',
updateFilter:function(a){var b=[a.el_body.getElementsByClassName("pk_check")[0].checked];a=a.el_body.getElementsByClassName("pk_horiz");for(var d=0;d<a.length;++d)b.push(a[d].value/1);return b},setup:function(a){var c=a.el_body.getElementsByClassName("pk_horiz");c[0].oninput=function(){this.parentNode.getElementsByTagName("span")[0].innerHTML=(this.value/1*100>>0)+"%";b.fireEvent("RequestActionFX_UPDATE_PREVIEW",a.updateFilter(a))};c[1].oninput=function(){this.parentNode.getElementsByTagName("span")[0].innerHTML=
"Ratio "+(this.value/1*100>>0)+"%";b.fireEvent("RequestActionFX_UPDATE_PREVIEW",a.updateFilter(a))};c[2].oninput=function(){this.parentNode.getElementsByTagName("span")[0].innerHTML=this.value/1+"ms";b.fireEvent("RequestActionFX_UPDATE_PREVIEW",a.updateFilter(a))};b.fireEvent("RequestPause");b.ui.InteractionHandler.checkAndSet("modal");b.ui.KeyHandler.addCallback("modalTemp",function(b){a.Destroy()},[27])}},b)).Show()});b.listenFor("RequestActionFXUI_Delay",function(){b.fireEvent("RequestSelect",
1);(new PKAudioFXModal({id:"delay",title:"Apply Delay to selected range",clss:"pk_bigger",ondestroy:function(a){b.ui.InteractionHandler.on=!1;b.ui.KeyHandler.removeCallback("modalfxesc")},presets:[{name:"Classic",val:"0.3,0.4,0.4"},{name:"Spacey",val:"3.0,0.6,0.3"}],custom_pres:f.Get("delay"),preview:function(a){a=a.el_body.getElementsByTagName("input");b.fireEvent("RequestActionFX_PREVIEW_DELAY",{delay:a[0].value/1,feedback:a[1].value/1,mix:a[2].value/1})},buttons:[{title:"Apply",clss:"pk_modal_a_accpt",
callback:function(a){var c=a.el_body.getElementsByTagName("input");b.fireEvent("RequestActionFX_DELAY",{delay:c[0].value/1,feedback:c[1].value/1,mix:c[2].value/1});a.Destroy()}}],body:'<div class="pk_row"><label class="pk_line">Delay Time</label><input class="pk_horiz" type="range" min="0.0" max="6.0" step="0.01" value="0.28" /><span class="pk_val">0.28</span></div><div class="pk_row"><label class="pk_line">Feedback</label><input class="pk_horiz" type="range" min="0.0" max="1.0" step="0.01" value="0.5" /><span class="pk_val">0.5</span></div><div class="pk_row"><label class="pk_line">Wet</label><input class="pk_horiz" type="range" min="0.0" max="1.0" step="0.01" value="0.4" /><span class="pk_val">0.4</span></div>',
setup:function(a){for(var c=a.el_body.getElementsByTagName("input"),d=0;d<c.length;++d)c[d].oninput=function(){this.parentNode.getElementsByTagName("span")[0].innerHTML=(this.value/1).toFixed(3);var c=a.el_body.getElementsByTagName("input");b.fireEvent("RequestActionFX_UPDATE_PREVIEW",{delay:c[0].value/1,feedback:c[1].value/1,mix:c[2].value/1})};b.fireEvent("RequestPause");b.ui.InteractionHandler.checkAndSet("modalfx");b.ui.KeyHandler.addCallback("modalfxesc",function(c){b.ui.InteractionHandler.check("modalfx")&&
a.Destroy()},[27])}},b)).Show()});b.listenFor("RequestActionFXUI_Distortion",function(){b.fireEvent("RequestSelect",1);(new PKAudioFXModal({id:"dist",title:"Apply Distortion to selected range",clss:"pk_bigger",ondestroy:function(a){b.ui.InteractionHandler.on=!1;b.ui.KeyHandler.removeCallback("modalfxesc")},preview:function(a){a=a.el_body.getElementsByTagName("input")[0].value/1;b.fireEvent("RequestActionFX_PREVIEW_DISTORT",a)},buttons:[{title:"Apply",clss:"pk_modal_a_accpt",callback:function(a){var c=
a.el_body.getElementsByTagName("input")[0].value/1;b.fireEvent("RequestActionFX_DISTORT",c);a.Destroy()}}],body:'<div class="pk_row"><label class="pk_line">Gain</label><input class="pk_horiz" type="range" min="0.0" max="2.0" step="0.01" value="0.5" /><span class="pk_val">0.5</span></div>',setup:function(a){for(var c=a.el_body.getElementsByTagName("input"),d=0;d<c.length;++d)c[d].oninput=function(){this.parentNode.getElementsByTagName("span")[0].innerHTML=(this.value/1).toFixed(2);var c=a.el_body.getElementsByTagName("input")[0].value/
1;b.fireEvent("RequestActionFX_UPDATE_PREVIEW",c)};b.fireEvent("RequestPause");b.ui.InteractionHandler.checkAndSet("modalfx");b.ui.KeyHandler.addCallback("modalfxesc",function(c){b.ui.InteractionHandler.check("modalfx")&&a.Destroy()},[27])}},b)).Show()});b.listenFor("RequestActionFXUI_Reverb",function(){b.fireEvent("RequestSelect",1);(new PKAudioFXModal({id:"reverb",title:"Apply Reverb to selected range",clss:"pk_bigger",ondestroy:function(a){b.ui.InteractionHandler.on=!1;b.ui.KeyHandler.removeCallback("modalfxesc")},
presets:[{name:"Classic",val:"0.3,0.4,0.4"},{name:"Spacey",val:"3.0,0.6,0.3"}],custom_pres:f.Get("reverb"),preview:function(a){a=a.el_body.getElementsByTagName("input");b.fireEvent("RequestActionFX_PREVIEW_REVERB",{time:a[0].value/1,decay:a[1].value/1,mix:a[2].value/1})},buttons:[{title:"Apply",clss:"pk_modal_a_accpt",callback:function(a){var c=a.el_body.getElementsByTagName("input");b.fireEvent("RequestActionFX_REVERB",{time:c[0].value/1,decay:c[1].value/1,mix:c[2].value/1});a.Destroy()}}],body:'<div class="pk_row"><label class="pk_line">Time</label><input class="pk_horiz" type="range" min="0.0" max="3.0" step="0.01" value="0.3" /><span class="pk_val">0.3</span></div><div class="pk_row"><label class="pk_line">Decay</label><input class="pk_horiz" type="range" min="0.0" max="3.0" step="0.01" value="0.05" /><span class="pk_val">0.05</span></div><div class="pk_row"><label class="pk_line">Wet</label><input class="pk_horiz" type="range" min="0.0" max="1.0" step="0.01" value="0.6" /><span class="pk_val">0.6</span></div>',
setup:function(a){for(var c=a.el_body.getElementsByTagName("input"),d=0;d<c.length;++d)c[d].oninput=function(){this.parentNode.getElementsByTagName("span")[0].innerHTML=(this.value/1).toFixed(3);var c=a.el_body.getElementsByTagName("input");b.fireEvent("RequestActionFX_UPDATE_PREVIEW",{time:c[0].value/1,decay:c[1].value/1,mix:c[2].value/1})};b.fireEvent("RequestPause");b.ui.InteractionHandler.checkAndSet("modalfx");b.ui.KeyHandler.addCallback("modalfxesc",function(c){b.ui.InteractionHandler.check("modalfx")&&
a.Destroy()},[27])}},b)).Show()});b.listenFor("RequestSavePreset",function(){if(h){var a=h.el_body;if(a){var c=function(b){var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return b.replace(/[&<>"']/g,function(b){return a[b]})},d=!0,e=null,g=h.el_presets;g=g.options[g.selectedIndex];a=a.querySelectorAll("select, input");var k={target:h.id,name:"My Preset",id:h.id+"_"+(99*Math.random()>>0),date:Date.now(),val:""};g&&g.getAttribute("data-custom")&&(d=!1,e=g.getAttribute("data-custom"));
for(g=0;g<a.length;++g)k.val="checkbox"===a[g].type?k.val+((a[g].checked?"1":"0")+","):k.val+(a[g].value+",");if(0<k.val.length){k.val=k.val.substring(0,k.val.length-1);a="";g={};var q={},n=null;d||(n=f.GetSingle(k.target,e),a='value="'+n.name+'"',g={title:"Delete",clss:"pk_modal_a_red",callback:function(a){OneUp("Successfully deleted preset!",1400);var c=f.Del(k.target,e);b.fireEvent("DidSetPresets",k.target,c);a.Destroy()}},q={title:"Update",callback:function(a){if(n){var d=a.el_body.getElementsByTagName("input")[0].value.trim();
d=c(d);0<d.length?(OneUp("Successfully updated preset!",1400),n.name=d,n.val=k.val,f.Save(),d=f.Get(k.target),b.fireEvent("DidSetPresets",k.target,d),a.Destroy()):OneUp("Name is too short...",1200)}}});var l='Save Custom Preset for filter "'+h.id+'"';d||(l='Edit Custom Preset "'+n.name+'", for filter "'+h.id+'"');(new PKSimpleModal({title:l,ondestroy:function(a){b.ui.InteractionHandler.forceUnset("_ctPr");b.ui.KeyHandler.removeCallback("_ctPresc");b.ui.KeyHandler.removeCallback("_ctPrent")},buttons:[{title:d?
"Save":"Save As New",clss:"pk_modal_a_accpt",callback:function(a){var d=a.el_body.getElementsByTagName("input")[0].value.trim();d=c(d);0<d.length?(OneUp("Successfully saved preset!",1400),k.name=d,d=f.Set(k.target,k),b.fireEvent("DidSetPresets",k.target,d),b.fireEvent("RequestSetPresetActive",k.target,k.id),a.Destroy()):OneUp("Name is too short...",1200)}},q,g],body:'<label for="k07">Preset Name</label><input style="min-width:340px" maxlength="16" placeholder="Please type a name, eg: My Preset" '+
a+' class="pk_txt" type="text" id="k07" />',setup:function(a){b.ui.InteractionHandler.forceSet("_ctPr");b.ui.KeyHandler.addCallback("_ctPresc",function(c){b.ui.InteractionHandler.check("_ctPr")&&a.Destroy()},[27]);b.ui.KeyHandler.addCallback("_ctPren",function(c){b.ui.InteractionHandler.check("_ctPr")&&a.els.bottom[0].click()},[13]);setTimeout(function(){if(a.el){var b=a.el.getElementsByTagName("input")[0];b.focus();0<b.value.length&&(b.selectionStart=b.selectionEnd=b.value.length)}},20)}})).Show()}}}});
var e=null;b.listenFor("WillUnload",function(){e&&!e.type&&e.destroy&&e.destroy()});b.listenFor("RequestShowFreqAn",function(a,c){if(b.isMobile)alert("unsupported on mobile");else{var d=!1;if(e&&a){d=!1;e.type===c&&(d=!0);e.destroy();e=null;if(d)return;d=!0}var f=function(a,b){e&&e.win&&e.win.update&&e.win.update(b)},g=function(a){e.win.destroy=function(){b.engine.wavesurfer.backend.logFrequencies=!1;b.stopListeningFor("DidAudioProcess",f);b.fireEvent("DidToggleFreqAn",null);e&&e.type===a&&(e=null)};
b.listenFor("DidAudioProcess",f);b.fireEvent("DidToggleFreqAn",e);b.engine.wavesurfer.backend.logFrequencies=!0};if(!c){var k=function(){var a=window.open("/eq.html","Frequency Analysis","directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,width=600,height=188");e={type:c,win:a,destroy:function(){a&&a.close&&a.close()}};g()};d?setTimeout(function(){k()},128):k()}else if(1===c){var h=document.createElement("iframe");h.id="pk_frqan";b.ui.BarBtm.el.appendChild(h);
b.ui.BarBtm.Show();e={type:c,win:null,destroy:function(){h.parentNode.removeChild(h);h=null;b.ui.BarBtm.Hide()}};h.onload=function(a){e&&e.type===c&&(e.win=h.contentWindow,g())};h.src="/eq.html?iframe=1"}}})}})(window,document,PKAudioEditor);