var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(k){var b=0;return function(){return b<k.length?{done:!1,value:k[b++]}:{done:!0}}};$jscomp.arrayIterator=function(k){return{next:$jscomp.arrayIteratorImpl(k)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(k,b,e){k!=Array.prototype&&k!=Object.prototype&&(k[b]=e.value)};$jscomp.getGlobal=function(k){return"undefined"!=typeof window&&window===k?k:"undefined"!=typeof global&&null!=global?global:k};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(k,b){this.$jscomp$symbol$id_=k;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function k(e){if(this instanceof k)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(e||"")+"_"+b++,e)}var b=0;return k}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var k=$jscomp.global.Symbol.iterator;k||(k=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[k]&&$jscomp.defineProperty(Array.prototype,k,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var k=$jscomp.global.Symbol.asyncIterator;k||(k=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(k){$jscomp.initSymbolIterator();k={next:k};k[$jscomp.global.Symbol.iterator]=function(){return this};return k};
(function(k,b){"object"===typeof exports&&"object"===typeof module?module.exports=b():"function"===typeof define&&define.amd?define("WaveSurfer",[],b):"object"===typeof exports?exports.WaveSurfer=b():k.WaveSurfer=b()})(window,function(){return function(k){function b(h){if(e[h])return e[h].exports;var u=e[h]={i:h,l:!1,exports:{}};k[h].call(u.exports,u,u.exports,b);u.l=!0;return u.exports}var e={};b.m=k;b.c=e;b.d=function(h,e,t){b.o(h,e)||Object.defineProperty(h,e,{enumerable:!0,get:t})};b.r=function(b){$jscomp.initSymbol();
$jscomp.initSymbol();"undefined"!==typeof Symbol&&Symbol.toStringTag&&($jscomp.initSymbol(),Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}));Object.defineProperty(b,"__esModule",{value:!0})};b.t=function(h,e){e&1&&(h=b(h));if(e&8||e&4&&"object"===typeof h&&h&&h.__esModule)return h;var t=Object.create(null);b.r(t);Object.defineProperty(t,"default",{enumerable:!0,value:h});if(e&2&&"string"!=typeof h)for(var p in h)b.d(t,p,function(b){return h[b]}.bind(null,p));return t};b.n=function(h){var e=
h&&h.__esModule?function(){return h["default"]}:function(){return h};b.d(e,"a",e);return e};b.o=function(b,e){return Object.prototype.hasOwnProperty.call(b,e)};b.p="";return b(b.s="./src/wavesurfer.js")}({"./node_modules/debounce/index.js":function(k,b){k.exports=function(b,h,k){function e(){var g=Date.now()-d;g<h&&0<=g?p=setTimeout(e,h-g):(p=null,k||(a=b.apply(c,q),c=q=null))}var p,q,c,d,a;null==h&&(h=100);var g=function(){c=this;q=arguments;d=Date.now();var g=k&&!p;p||(p=setTimeout(e,h));g&&(a=
b.apply(c,q),c=q=null);return a};g.clear=function(){p&&(clearTimeout(p),p=null)};g.flush=function(){p&&(a=b.apply(c,q),c=q=null,clearTimeout(p),p=null)};return g}},"./src/drawer.js":function(k,b,e){function h(b,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);b.prototype=Object.create(e&&e.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(b,e):b.__proto__=
e)}Object.defineProperty(b,"__esModule",{value:!0});var u=function(){function b(b,c){for(var d=0;d<c.length;d++){var a=c[d];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(b,a.key,a)}}return function(e,c,d){c&&b(e.prototype,c);d&&b(e,d);return e}}(),t=function(b){if(b&&b.__esModule)return b;var e={};if(null!=b)for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(e[c]=b[c]);e["default"]=b;return e}(e("./src/util/index.js"));e=function(b){function e(c,
d){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var a=(e.__proto__||Object.getPrototypeOf(e)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!==typeof a&&"function"!==typeof a?this:a;a.container=c;a.params=d;a.width=0;a.height=d.height*a.params.pixelRatio;a.lastPos=0;a.wrapper=null;return a}h(e,b);u(e,[{key:"style",value:function(c,d){return t.style(c,d)}},{key:"createWrapper",value:function(){this.wrapper=
this.container.appendChild(document.createElement("wave"));this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"});(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"});this.setupWrapperEvents()}},{key:"handleEvent",value:function(c,d){!d&&c.preventDefault();var a=c.targetTouches&&c.targetTouches[0]?c.targetTouches[0].clientX:
c.clientX,g=this.wrapper.getBoundingClientRect(),l=this.width,n=this.getWidth();!this.params.fillParent&&l<n?(a=(a=(a-g.left)*this.params.pixelRatio)||0,1<a&&(a=1)):a=(a-g.left)/this.width||0;return a}},{key:"setupWrapperEvents",value:function(){var c=this;this.wrapper.addEventListener("click",function(d){c.params.interact&&c.fireEvent("click",d,c.handleEvent(d))});this.wrapper.addEventListener("touchstart",function(d){c.params.interact&&c.fireEvent("touchstart",d)});this.wrapper.addEventListener("touchmove",
function(d){c.params.interact&&c.fireEvent("touchmove",d)});this.wrapper.addEventListener("touchend",function(d){c.params.interact&&c.fireEvent("touchend",d)});this.wrapper.addEventListener("scroll",function(d){return c.fireEvent("scroll",d)});this.wrapper.addEventListener("wheel",function(d){return c.fireEvent("wheel",d)})}},{key:"drawPeaks",value:function(c,d,a,g,l,n){var b=this;requestAnimationFrame(function(){b.shift=n;b.setWidth(d)||b.clearWave();b.drawWave(c,0,a,g,l)})}},{key:"resetScroll",
value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(c){this.recenterOnPosition(this.wrapper.scrollWidth*c,!0)}},{key:"recenterOnPosition",value:function(c,d){var a=this.wrapper.scrollLeft,g=~~(this.wrapper.clientWidth/2),l=this.wrapper.scrollWidth-this.wrapper.clientWidth,b=c-g,w=b-a;0!=l&&(!d&&-g<=w&&w<g&&(w=Math.max(-5,Math.min(5,w)),b=a+w),b=Math.max(0,Math.min(l,b)),b!=a&&(this.wrapper.scrollLeft=b))}},{key:"getScrollX",value:function(){var c=this.params.pixelRatio,
d=Math.round(this.wrapper.scrollLeft*c);this.params.scrollParent&&(c=~~(this.wrapper.scrollWidth*c-this.getWidth()),d=Math.min(c,Math.max(0,d)));return d}},{key:"getWidth",value:function(){return this._width}},{key:"setWidth",value:function(c){if(this.width==c)return!1;this.width=c;this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"});this.updateSize();return!0}},{key:"setHeight",value:function(c){if(c==
this.height)return!1;this.height=c;this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"});this.updateSize();return!0}},{key:"progress",value:function(c,d,a){0==c?this.updateProgress(-1):this.updateProgress(1/this.params.pixelRatio*Math.round((c-d)*a*this.width))}},{key:"destroy",value:function(){this.unAll();this.wrapper&&(this.wrapper.parentNode==this.container&&this.container.removeChild(this.wrapper),this.wrapper=null)}},{key:"updateCursor",value:function(){}},{key:"updateSize",
value:function(){}},{key:"drawBars",value:function(c,d,a,g){}},{key:"drawWave",value:function(c,d,a,g){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(c){}}]);return e}(t.Observer);b["default"]=e;k.exports=b["default"]},"./src/drawer.multicanvas.js":function(k,b,e){function h(c,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);c.prototype=Object.create(d&&d.prototype,{constructor:{value:c,enumerable:!1,
writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(c,d):c.__proto__=d)}function u(c,d){var a=c>>0,g=c-a;if(10>a)a="00:0"+a;else if(60>a)a="00:"+a;else{var l=a/60>>0;a%=60;a=(10>l?"0":"")+l+":"+(10>a?"0"+a:a)}return 1===d?a+":"+(g.toFixed(2)+"").substr(2):a}Object.defineProperty(b,"__esModule",{value:!0});var t=function(){function c(c,a){for(var g=0;g<a.length;g++){var l=a[g];l.enumerable=l.enumerable||!1;l.configurable=!0;"value"in l&&(l.writable=!0);Object.defineProperty(c,
l.key,l)}}return function(d,a,g){a&&c(d.prototype,a);g&&c(d,g);return d}}(),p=e("./src/drawer.js");p=p&&p.__esModule?p:{"default":p};var q=function(c){if(c&&c.__esModule)return c;var d={};if(null!=c)for(var a in c)Object.prototype.hasOwnProperty.call(c,a)&&(d[a]=c[a]);d["default"]=c;return d}(e("./src/util/index.js"));e=function(c){function d(a,g){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var c=(d.__proto__||Object.getPrototypeOf(d)).call(this,a,g);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.maxCanvasWidth=g.maxCanvasWidth;c.maxCanvasElementWidth=Math.round(g.maxCanvasWidth/g.pixelRatio);c.hasProgressCanvas=!1;c.halfPixel=.5/g.pixelRatio;c.canvases=[];c.progressWave=null;c.CursorMarker=null;return c}h(d,c);t(d,[{key:"init",value:function(){this.createWrapper();this.createElements()}},{key:"createElements",value:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",
zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"}));this.addCanvas();this.CursorMarker=document.createElement("div");this.CursorMarker.className="pk_wave_cursor";this.wrapper.appendChild(this.CursorMarker);this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){for(var a=
this;1>this.canvases.length;)this.addCanvas();for(;1<this.canvases.length;)this.removeCanvas();this.canvases.forEach(function(c,d){var g=a.maxCanvasWidth+2*Math.ceil(a.params.pixelRatio/2);d==a.canvases.length-1&&(g=a.width-a.maxCanvasWidth*(a.canvases.length-1));a.updateDimensions(c,g,a.height);a.clearWaveForEntry(c)})}},{key:"addCanvas",value:function(){var a={},c=this.maxCanvasElementWidth*this.canvases.length;a.wave=this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",
zIndex:2,left:c+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"}));a.waveCtx=a.wave.getContext("2d",{alpha:!1,antialias:!1});this.hasProgressCanvas&&(a.progress=this.progressWave.appendChild(this.style(document.createElement("canvas"),{position:"absolute",left:c+"px",top:0,bottom:0,height:"100%"})),a.progressCtx=a.progress.getContext("2d",{alpha:!1,antialias:!1}));this.canvases.push(a)}},{key:"removeCanvas",value:function(){var a=this.canvases.pop();a.wave.parentElement.removeChild(a.wave);
this.hasProgressCanvas&&a.progress.parentElement.removeChild(a.progress)}},{key:"updateDimensions",value:function(a,c,d){var g=Math.round(c/this.params.pixelRatio),l=Math.round(this.width/this.params.pixelRatio);a.start=a.waveCtx.canvas.offsetLeft/l||0;a.end=a.start+g/l;a.waveCtx.canvas.width=c;a.waveCtx.canvas.height=d;this.style(a.waveCtx.canvas,{width:g+"px"});this.style(this.progressWave,{display:"block"});this.hasProgressCanvas&&(a.progressCtx.canvas.width=c,a.progressCtx.canvas.height=d,this.style(a.progressCtx.canvas,
{width:g+"px"}))}},{key:"clearWave",value:function(){var a=this;this.canvases.forEach(function(c){return a.clearWaveForEntry(c)})}},{key:"clearWaveForEntry",value:function(a){this.shiftClear=!0;a.waveCtx.fillStyle="#000";a.waveCtx.fillRect(0,0,a.waveCtx.canvas.width,a.waveCtx.canvas.height);a.waveCtx.fillStyle="#99c2c6"}},{key:"drawBars",value:function(a,c,d,b){var g=this;return this.prepareDraw(a,c,d,b,function(a){var f=a.absmax,m=a.hasMinVals,c=a.offsetY,l=a.halfH;a=a.peaks;g.params.timeline&&(c+=
20,l-=10);if(void 0!==d){m=m?2:1;var n=g.params.barWidth*g.params.pixelRatio,e=n+(null===g.params.barGap?Math.max(g.params.pixelRatio,~~(n/2)):Math.max(g.params.pixelRatio,g.params.barGap*g.params.pixelRatio)),w=a.length/m/g.width,v;for(v=d;v<b;v+=e){var h=Math.round((a[Math.floor(v*w*m)]||0)/f*l);g.fillRect(v+g.halfPixel,l-h+c,n+g.halfPixel,2*h)}}})}},{key:"drawWave",value:function(a,c,d,b,e){var g=this;return this.prepareDraw(a,c,d,b,function(a){var f=a.absmax,c=a.hasMinVals,l=a.offsetY,n=a.halfH;
a=a.peaks;g.params.timeline&&(l+=20,n-=10);if(!c){c=[];var e=a.length,w;for(w=0;w<e;w++)c[2*w]=a[w],c[2*w+1]=-a[w];a=c}void 0!==d&&g.drawLine(g.params.limits,g.params.timeline,a,f,n,l,d,b);g.fillRect(0,n+l-g.halfPixel,g.width,g.halfPixel,g.params.timeline?10:0)},e)}},{key:"drawLine",value:function(a,c,d,b,e,v,f,m){var g=this;this.canvases.forEach(function(l){g.drawLineToContext(a,c,l,l.waveCtx,d,b,e,v,f,m)})}},{key:"drawLineToContext",value:function(a,c,d,b,e,v,f,m,y,r){if(b){var g=e.length/2,l=this.params.fillParent&&
this.width!=g?this.width/g:1,n=Math.round(g*d.start);d=Math.round(g*d.end)+1;if(!(n>r||d<y)){y=Math.min(n,y);r=Math.max(d,r);b.beginPath();b.moveTo((y-n)*l+this.halfPixel,f+m);d=0;30<m&&(d=1);b.fillStyle=this.params.ActiveChannels[d]?this.params.waveColor:this.params.waveDisabledColor;d=r;e.length<=2*d&&(d=e.length/2>>0);for(r=y;r<d;++r)g=Math.round(e[2*r]/v*f),g=Math.min(g,f),b.lineTo((r-n)*l+this.halfPixel,f-g+m);for(r=d-1;r>=y;--r)d=Math.round(e[2*r+1]/v*f),d=Math.max(d,-f),b.lineTo((r-n)*l+this.halfPixel,
f-d+m);b.closePath();b.fill();a&&(b.fillStyle="#fff",a=10*f/100>>0,v=1/v*f-f,e=a+m-v,e>m&&b.fillRect(0,e,this.width,.5),e=2*f-a+m+v,e<2*f+m&&b.fillRect(0,e,this.width,.5),b.fillStyle=this.params.waveColor);if(c&&(b.fillStyle="#fff",m=PKAudioEditor.engine.wavesurfer.LeftProgress,c=PKAudioEditor.engine.wavesurfer.getDuration(),f=PKAudioEditor.engine.wavesurfer.drawer.width,1<=PKAudioEditor.engine.wavesurfer.ZoomFactor)){f*=PKAudioEditor.engine.wavesurfer.ZoomFactor;m=m/c*f;a=0;e=f/c;b.font="12px Arial lighter";
b.textAlign="center";b.fillStyle="#111";b.fillRect(0,0,this.width,24);b.fillStyle="#aaa";b.strokeStyle="#aaa";80>e&&(e=80);160<e&&(e/=(e/160>>0)+1);for(r=v=0;r<10*c&&!(a-m>f-2);++r)-2<=a-m&&a-m<f-2&&(l=a/f*c,n=3,v=l-v,1>v?n=1:60>v&&(n=2),v=l,b.fillText(u(l,n),a-m,12)),a+=e;b.beginPath();for(r=a=0;r<10*c&&!(a-m>f-2);++r)-2<=a-m&&a-m<f-2&&(b.moveTo(a-m,16),b.lineTo(a-m,24)),a+=e;a=e/2;for(r=0;r<10*c&&!(a-m>f-2);++r)-2<=a-m&&a-m<f-2&&(b.moveTo(a-m,19),b.lineTo(a-m,24)),a+=e;b.stroke()}b.fillStyle=this.params.waveColor}}}},
{key:"fillRect",value:function(a,c,d,b,e){var g=Math.min(Math.ceil((a+d)/this.maxCanvasWidth)+1,this.canvases.length),f,m=!1;for(f=Math.floor(a/this.maxCanvasWidth);f<g;f++){var l=this.canvases[f],r=f*this.maxCanvasWidth,n=Math.max(a,f*this.maxCanvasWidth),h=c,w=Math.min(a+d,f*this.maxCanvasWidth+l.waveCtx.canvas.width),p=c+b;n<w&&(this.setFillStyles(l),m||(this.fillRectToContext(l.waveCtx,0,this.height/2+e,this.width,.25),m=!0),this.fillRectToContext(l.waveCtx,n-r,h,w-n,p-h))}}},{key:"prepareDraw",
value:function(a,c,d,b,e,v){var f=this;return function(){if(a[0]instanceof Array){var m=a;if(f.params.splitChannels)return f.setHeight(f.params.height*f.params.pixelRatio),m.forEach(function(a,c){return f.prepareDraw(a,c,d,b,e,v)});a=m[0]}m=1/f.params.barHeight;m*=f.params.verticalZoom;if(f.params.normalize){m=q.max(a);var g=q.min(a);m=-g>m?-g:m}g=[].some.call(a,function(a){return 0>a});var l=f.params.height/2*f.params.pixelRatio,n=l*c||0,h=l/2;1===v&&(h=l);return e({absmax:m,hasMinVals:g,height:l,
offsetY:n,halfH:h,peaks:a})}()}},{key:"fillRectToContext",value:function(a,c,d,b,e){a&&a.fillRect(c,d,b,e)}},{key:"setFillStyles",value:function(a){a.waveCtx.fillStyle=this.params.waveColor;this.hasProgressCanvas&&(a.progressCtx.fillStyle=this.params.progressColor)}},{key:"getImage",value:function(a,c){var g=this.canvases.map(function(g){return g.wave.toDataURL(a,c)});return 1<g.length?g:g[0]}},{key:"updateProgress",value:function(a){this.progressWave.style.left=a+"px"}}]);return d}(p["default"]);
b["default"]=e;k.exports=b["default"]},"./src/mediaelement.js":function(k,b,e){function h(c,d){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!d||"object"!==typeof d&&"function"!==typeof d?c:d}function u(c,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);c.prototype=Object.create(d&&d.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?
Object.setPrototypeOf(c,d):c.__proto__=d)}Object.defineProperty(b,"__esModule",{value:!0});var t=function(){function c(c,a){for(var g=0;g<a.length;g++){var d=a[g];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(c,d.key,d)}}return function(d,a,g){a&&c(d.prototype,a);g&&c(d,g);return d}}(),p=function l(d,a,g){null===d&&(d=Function.prototype);var b=Object.getOwnPropertyDescriptor(d,a);if(void 0===b){if(d=Object.getPrototypeOf(d),null!==d)return l(d,
a,g)}else{if("value"in b)return b.value;a=b.get;return void 0===a?void 0:a.call(g)}},q=e("./src/webaudio.js");q=q&&q.__esModule?q:{"default":q};(function(d){if(d&&d.__esModule)return d;var a={};if(null!=d)for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(a[g]=d[g]);a["default"]=d;return a})(e("./src/util/index.js"));e=function(d){function a(g){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");var d=h(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,g));
d.params=g;d.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0};d.mediaType=g.mediaType.toLowerCase();d.elementPosition=g.elementPosition;d.peaks=null;d.playbackRate=1;d.volume=1;d.buffer=null;d.onPlayEnd=null;return d}u(a,d);t(a,[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate);this.createTimer()}},{key:"createTimer",value:function(){var a=this;this.on("play",function n(){a.isPaused()||(a.fireEvent("audioprocess",a.getCurrentTime()),
(window.requestAnimationFrame||window.webkitRequestAnimationFrame)(n))});this.on("pause",function(){a.fireEvent("audioprocess",a.getCurrentTime())})}},{key:"load",value:function(a,d,b,e){var g=document.createElement(this.mediaType);g.controls=this.params.mediaControls;g.autoplay=this.params.autoplay||!1;g.preload=null==e?"auto":e;g.src=a;g.style.width="100%";(a=d.querySelector(this.mediaType))&&d.removeChild(a);d.appendChild(g);this._load(g,b)}},{key:"loadElt",value:function(a,d){a.controls=this.params.mediaControls;
a.autoplay=this.params.autoplay||!1;this._load(a,d)}},{key:"_load",value:function(a,d){var g=this;"function"==typeof a.load&&a.load();a.addEventListener("error",function(){g.fireEvent("error","Error loading media element")});a.addEventListener("canplay",function(){g.fireEvent("canplay")});a.addEventListener("ended",function(){g.fireEvent("finish")});a.addEventListener("play",function(){g.fireEvent("play")});a.addEventListener("pause",function(){g.fireEvent("pause")});this.media=a;this.peaks=d;this.buffer=
this.onPlayEnd=null;this.setPlaybackRate(this.playbackRate);this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration)return this.explicitDuration;var a=(this.buffer||this.media).duration;Infinity<=a&&(a=this.media.seekable.end(0));return a}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/
this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(a){this.playbackRate=a||1;this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(a){null!=a&&(this.media.currentTime=a);this.clearPlayEnd()}},{key:"play",value:function(a,d){this.seekTo(a);var g=this.media.play();d&&this.setPlayEnd(d);return g}},{key:"pause",value:function(){var a=void 0;this.media&&(a=this.media.pause());this.clearPlayEnd();
return a}},{key:"setPlayEnd",value:function(a){var d=this;this._onPlayEnd=function(g){g>=a&&(d.pause(),d.seekTo(a))};this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(d,b,e){return this.buffer?p(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"getPeaks",this).call(this,d,b,e):this.peaks||[]}},{key:"setSinkId",value:function(a){return a?this.media.setSinkId?
this.media.setSinkId(a):Promise.reject(Error("setSinkId is not supported in your browser")):Promise.reject(Error("Invalid deviceId: "+a))}},{key:"getVolume",value:function(){return this.volume||this.media.volume}},{key:"setVolume",value:function(a){this.volume=a;this.media.volume=this.volume}},{key:"destroy",value:function(){this.pause();this.unAll();this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media);this.media=null}}]);return a}(q["default"]);
b["default"]=e;k.exports=b["default"]},"./src/peakcache.js":function(k,b,e){Object.defineProperty(b,"__esModule",{value:!0});var h=function(){function b(b,e){for(var h=0;h<e.length;h++){var c=e[h];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(e,h,k){h&&b(e.prototype,h);k&&b(e,k);return e}}();e=function(){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.clearPeakCache()}
h(b,[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[];this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(b,e,h){b!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=b);b=[];for(var c=0;c<this.peakCacheRanges.length&&this.peakCacheRanges[c]<e;)c++;for(0==c%2&&b.push(e);c<this.peakCacheRanges.length&&this.peakCacheRanges[c]<=h;)b.push(this.peakCacheRanges[c]),c++;0==c%2&&b.push(h);b=b.filter(function(c,a,b){return 0==a?c!=b[a+1]:a==b.length-1?c!=b[a-1]:
c!=b[a-1]&&c!=b[a+1]});this.peakCacheRanges=this.peakCacheRanges.concat(b);this.peakCacheRanges=this.peakCacheRanges.sort(function(c,a){return c-a}).filter(function(c,a,b){return 0==a?c!=b[a+1]:a==b.length-1?c!=b[a-1]:c!=b[a-1]&&c!=b[a+1]});e=[];for(c=0;c<b.length;c+=2)e.push([b[c],b[c+1]]);return e}},{key:"getCacheRanges",value:function(){var b=[],e;for(e=0;e<this.peakCacheRanges.length;e+=2)b.push([this.peakCacheRanges[e],this.peakCacheRanges[e+1]]);return b}}]);return b}();b["default"]=e;k.exports=
b["default"]},"./src/util/ajax.js":function(k,b,e){Object.defineProperty(b,"__esModule",{value:!0});b["default"]=function(b){var e=new h["default"],k=new XMLHttpRequest,q=!1;k.open(b.method||"GET",b.url,!0);k.responseType=b.responseType||"json";b.xhr&&(b.xhr.requestHeaders&&b.xhr.requestHeaders.forEach(function(c){k.setRequestHeader(c.key,c.value)}),b.xhr.withCredentials&&(k.withCredentials=!0));k.addEventListener("progress",function(c){e.fireEvent("progress",c);c.lengthComputable&&c.loaded==c.total&&
(q=!0)});k.addEventListener("load",function(c){q||e.fireEvent("progress",c);e.fireEvent("load",c);200==k.status||206==k.status?e.fireEvent("success",k.response,c):e.fireEvent("error",c)});k.addEventListener("error",function(c){return e.fireEvent("error",c)});k.send();e.xhr=k;return e};var h=(e=e("./src/util/observer.js"))&&e.__esModule?e:{"default":e};k.exports=b["default"]},"./src/util/extend.js":function(k,b,e){Object.defineProperty(b,"__esModule",{value:!0});b["default"]=function(b){for(var e=
arguments.length,h=Array(1<e?e-1:0),k=1;k<e;k++)h[k-1]=arguments[k];h.forEach(function(e){Object.keys(e).forEach(function(c){b[c]=e[c]})});return b};k.exports=b["default"]},"./src/util/frame.js":function(k,b,e){},"./src/util/get-id.js":function(k,b,e){Object.defineProperty(b,"__esModule",{value:!0});b["default"]=function(){return"wavesurfer_"+Math.random().toString(32).substring(2)};k.exports=b["default"]},"./src/util/index.js":function(k,b,e){function h(a){return a&&a.__esModule?a:{"default":a}}
Object.defineProperty(b,"__esModule",{value:!0});var u=e("./src/util/ajax.js");Object.defineProperty(b,"ajax",{enumerable:!0,get:function(){return h(u)["default"]}});var t=e("./src/util/get-id.js");Object.defineProperty(b,"getId",{enumerable:!0,get:function(){return h(t)["default"]}});var p=e("./src/util/max.js");Object.defineProperty(b,"max",{enumerable:!0,get:function(){return h(p)["default"]}});var q=e("./src/util/min.js");Object.defineProperty(b,"min",{enumerable:!0,get:function(){return h(q)["default"]}});
var c=e("./src/util/observer.js");Object.defineProperty(b,"Observer",{enumerable:!0,get:function(){return h(c)["default"]}});var d=e("./src/util/extend.js");Object.defineProperty(b,"extend",{enumerable:!0,get:function(){return h(d)["default"]}});var a=e("./src/util/style.js");Object.defineProperty(b,"style",{enumerable:!0,get:function(){return h(a)["default"]}});var g=e("./src/util/request-animation-frame.js");Object.defineProperty(b,"requestAnimationFrame",{enumerable:!0,get:function(){return h(g)["default"]}});
var l=e("./src/util/frame.js");Object.defineProperty(b,"frame",{enumerable:!0,get:function(){return h(l)["default"]}});var n=e("./node_modules/debounce/index.js");Object.defineProperty(b,"debounce",{enumerable:!0,get:function(){return h(n)["default"]}});var w=e("./src/util/prevent-click.js");Object.defineProperty(b,"preventClick",{enumerable:!0,get:function(){return h(w)["default"]}})},"./src/util/max.js":function(k,b,e){Object.defineProperty(b,"__esModule",{value:!0});b["default"]=function(b){var e=
-Infinity;Object.keys(b).forEach(function(h){b[h]>e&&(e=b[h])});return e};k.exports=b["default"]},"./src/util/min.js":function(k,b,e){Object.defineProperty(b,"__esModule",{value:!0});b["default"]=function(b){var e=Number(Infinity);Object.keys(b).forEach(function(h){b[h]<e&&(e=b[h])});return e};k.exports=b["default"]},"./src/util/observer.js":function(k,b,e){Object.defineProperty(b,"__esModule",{value:!0});var h=function(){function b(b,e){for(var h=0;h<e.length;h++){var c=e[h];c.enumerable=c.enumerable||
!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(e,h,k){h&&b(e.prototype,h);k&&b(e,k);return e}}();e=function(){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.handlers=null}h(b,[{key:"on",value:function(b,e){var h=this;this.handlers||(this.handlers={});var c=this.handlers[b];c||(c=this.handlers[b]=[]);c.push(e);return{name:b,callback:e,un:function(c,a){return h.un(c,a)}}}},{key:"un",value:function(b,
e){if(this.handlers){var h=this.handlers[b],c;if(h)if(e)for(c=h.length-1;0<=c;c--)h[c]==e&&h.splice(c,1);else h.length=0}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(b,e){var h=this;return this.on(b,function d(){for(var a=arguments.length,g=Array(a),l=0;l<a;l++)g[l]=arguments[l];e.apply(h,g);setTimeout(function(){h.un(b,d)},0)})}},{key:"fireEvent",value:function(b){for(var e=arguments.length,h=Array(1<e?e-1:0),c=1;c<e;c++)h[c-1]=arguments[c];this.handlers&&(e=this.handlers[b])&&
e.forEach(function(b){b.apply(void 0,h)})}}]);return b}();b["default"]=e;k.exports=b["default"]},"./src/util/prevent-click.js":function(k,b,e){function h(b){b.stopPropagation();document.body.removeEventListener("click",h,!0)}Object.defineProperty(b,"__esModule",{value:!0});b["default"]=function(b){document.body.addEventListener("click",h,!0)};k.exports=b["default"]},"./src/util/request-animation-frame.js":function(k,b,e){Object.defineProperty(b,"__esModule",{value:!0});b["default"]=(window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b,e){return setTimeout(b,1E3/60)}).bind(window);k.exports=b["default"]},"./src/util/style.js":function(k,b,e){Object.defineProperty(b,"__esModule",{value:!0});b["default"]=function(b,e){Object.keys(e).forEach(function(h){b.style[h]!==e[h]&&(b.style[h]=e[h])});return b};k.exports=b["default"]},"./src/wavesurfer.js":function(k,b,e){function h(a){return a&&a.__esModule?
a:{"default":a}}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function t(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function p(a,
b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}Object.defineProperty(b,"__esModule",{value:!0});var q=function(){function a(a,f){for(var b=0;b<f.length;b++){var c=f[b];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,f,c){f&&a(b.prototype,f);c&&a(b,c);return b}}(),c=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(b[f]=
a[f]);b["default"]=a;return b}(e("./src/util/index.js")),d=e("./src/drawer.multicanvas.js"),a=h(d);d=e("./src/webaudio.js");var g=h(d);d=e("./src/mediaelement.js");var l=h(d);e=e("./src/peakcache.js");var n=h(e);(function(){function a(b,f){p(this,a)}q(a,[{key:"create",value:function(a){}}]);q(a,[{key:"init",value:function(){}},{key:"destroy",value:function(){}}]);return a})();e=function(b){function d(b){p(this,d);var f=u(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));f.defaultParams={audioContext:null,
audioRate:1,autoCenter:!0,backend:"WebAudio",barHeight:1,barGap:null,container:null,cursorColor:"#ff8c35",cursorWidth:1,dragSelection:!0,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4E3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"rgba(201,199,229,0.24)",removeMediaElementOnDestroy:!0,renderer:a["default"],
responsive:!1,scrollParent:!1,skipLength:2,splitChannels:!1,waveColor:"#99c2c6",waveDisabledColor:"#505253",xhr:{},limits:1,timeline:1,verticalZoom:1};f.backends={MediaElement:l["default"],WebAudio:g["default"]};f.util=c;f.params=c.extend({},f.defaultParams,b);f.container="string"==typeof b.container?document.querySelector(f.params.container):f.params.container;if(!f.container)throw Error("Container element not found");f.mediaContainer=null==f.params.mediaContainer?f.container:"string"==typeof f.params.mediaContainer?
document.querySelector(f.params.mediaContainer):f.params.mediaContainer;if(!f.mediaContainer)throw Error("Media Container element not found");if(1>=f.params.maxCanvasWidth)throw Error("maxCanvasWidth must be greater than 1");if(1==f.params.maxCanvasWidth%2)throw Error("maxCanvasWidth must be an even number");f.savedVolume=0;f.isMuted=!1;f.tmpEvents=[];f.currentAjax=null;f.bid={};f.arraybuffer=null;f.drawer=null;f.backend=null;f.peakCache=null;if("function"!==typeof f.params.renderer)throw Error("Renderer parameter is invalid");
f.Drawer=f.params.renderer;f.Backend=f.backends[f.params.backend];f.initialisedPluginList={};f.isDestroyed=!1;f.isReady=!1;var e=0;f._onResize=c.debounce(function(){e==f.drawer.wrapper.clientWidth||f.params.scrollParent||(e=f.drawer.wrapper.clientWidth,f.drawer.fireEvent("redraw"))},"number"===typeof f.params.responsive?f.params.responsive:100);f.ActiveMarker=0;f.FollowCursor=1;f.Interacting=0;f.ActiveChannels=[1,1];f.SelectedChannelsLen=2;f.LeftProgress=0;f.ZoomFactor=1;f.VisibleDuration=0;return u(f,
f)}t(d,b);q(d,null,[{key:"create",value:function(a){return(new d(a)).init()}}]);q(d,[{key:"init",value:function(){this.registerPlugins(this.params.plugins);this.createDrawer();this.createBackend();this.createPeakCache();return this}},{key:"registerPlugins",value:function(a){var f=this;a.forEach(function(a){return f.addPlugin(a)});a.forEach(function(a){a.deferInit||f.initPlugin(a.name)});this.fireEvent("plugins-registered",a);return this}},{key:"addPlugin",value:function(a){var f=this;if(!a.name)throw Error("Plugin does not have a name!");
if(!a.instance)throw Error("Plugin "+a.name+" does not have an instance property!");a.staticProps&&Object.keys(a.staticProps).forEach(function(b){f[b]=a.staticProps[b]});var b=a.instance;Object.getOwnPropertyNames(c.Observer.prototype).forEach(function(a){b.prototype[a]=c.Observer.prototype[a]});this[a.name]=new b(a.params||{},this);this.fireEvent("plugin-added",a.name);return this}},{key:"initPlugin",value:function(a){if(!this[a])throw Error("Plugin "+a+" has not been added yet!");this.initialisedPluginList[a]&&
this.destroyPlugin(a);this[a].init();this.initialisedPluginList[a]=!0;this.fireEvent("plugin-initialised",a);return this}},{key:"destroyPlugin",value:function(a){if(!this[a])throw Error("Plugin "+a+" has not been added yet and cannot be destroyed!");if(!this.initialisedPluginList[a])throw Error("Plugin "+a+" is not active and cannot be destroyed!");if("function"!==typeof this[a].destroy)throw Error("Plugin "+a+" does not have a destroy function!");this[a].destroy();delete this.initialisedPluginList[a];
this.fireEvent("plugin-destroyed",a);return this}},{key:"destroyAllPlugins",value:function(){var a=this;Object.keys(this.initialisedPluginList).forEach(function(f){return a.destroyPlugin(f)})}},{key:"createDrawer",value:function(){var a=this;this.params.ActiveChannels=this.ActiveChannels;this.drawer=new this.Drawer(this.container,this.params);this.drawer.init();this.fireEvent("drawer-created",this.drawer);this.drawer.on("resize",function(){a.drawer._width=Math.round(a.drawer.container.clientWidth*
a.drawer.params.pixelRatio)});this.on("resize",function(){a.drawer.fireEvent("resize")});!1!==this.params.responsive&&(window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0));this.drawer.on("redraw",function(){a.drawBuffer();a.drawer.progress(a.backend.getPlayedPercents(),a.LeftProgress/a.getDuration(),a.ZoomFactor)});if("ontouchstart"in document.documentElement){var b=0,c=0,d=0,e=0;this.drawer.on("touchstart",function(a){a.touches&&1===
a.touches.length&&(b=a.touches[0].pageX,c=a.touches[0].pageY)});this.drawer.on("touchmove",function(a){a.touches&&1===a.touches.length&&(d=a.touches[0].pageX,e=a.touches[0].pageY)});this.drawer.on("touchend",function(f){0!==b&&0!==c&&(0===d&&0===e||20>Math.abs(d-b)&&20>Math.abs(e-c)?setTimeout(function(){var f=a.drawer.wrapper.getBoundingClientRect(),g=a.drawer.width,m=a.drawer.getWidth(),h=b-(window.pageXOffset||document.documentElement.scrollLeft);!a.drawer.params.fillParent&&g<m?(f=(f=(h-f.left)*
a.drawer.params.pixelRatio)||0,1<f&&(f=1)):f=(h-f.left)/g||0;f=(f*a.VisibleDuration+a.LeftProgress)/a.getDuration();0<=f&&1>=f&&a.seekTo(f);e=d=c=b=0;a.regions&&a.regions.clear()},24):e=d=c=b=0)})}this.drawer.on("click",function(b,c){setTimeout(function(){var b=(c*a.VisibleDuration+a.LeftProgress)/a.getDuration();0<=b&&1>=b&&a.seekTo(b)},36)});this.ResetZoom=function(){a.ZoomFactor=1;a.LeftProgress=0;a.params.verticalZoom=1;a.ForceDraw();a.fireEvent("DidZoom")};this.SetZoomVertical=function(b,c){var f=
a.params.verticalZoom;a.params.verticalZoom=.1>a.params.verticalZoom?a.params.verticalZoom+b/24:.3>a.params.verticalZoom?a.params.verticalZoom+b/20:.5>a.params.verticalZoom?a.params.verticalZoom+b/16:.8>a.params.verticalZoom?a.params.verticalZoom+b/12:1>a.params.verticalZoom?a.params.verticalZoom+b/8:a.params.verticalZoom+b/4;.1>=a.params.verticalZoom&&(a.params.verticalZoom=.1);1>f&&1<a.params.verticalZoom?a.params.verticalZoom=1:1<f&&1>a.params.verticalZoom&&(a.params.verticalZoom=1);a.ForceDraw();
a.fireEvent("DidZoom",c)};this.SetZoom=function(b,c,f,d){var e=!1,g=a.VisibleDuration;b||(b=.5);0>c?(a.ZoomFactor=a.ZoomFactor!=a.ZoomFactor>>0?(a.ZoomFactor>>0)+1:a.ZoomFactor+1,a.LeftProgress+=g/a.ZoomFactor*b):1<a.ZoomFactor&&(a.ZoomFactor!=a.ZoomFactor>>0?a.ZoomFactor>>=0:(6<a.ZoomFactor&&(d||(e=!0)),--a.ZoomFactor),a.LeftProgress=1===a.ZoomFactor?0:a.LeftProgress-g/a.ZoomFactor*b);a.ForceDraw();a.fireEvent("DidZoom",f);e&&this.SetZoom(b,c,f,!0)};var g=0;this.drawer.on("wheel",function(b){b.preventDefault();
b.stopPropagation();if(a.isReady&&0!=b.deltaY){var c=window.performance.now();if(!(45>c-g)){g=c;c=a.drawer.width;var f=a.getWaveEl().getBoundingClientRect();a.SetZoom((b.clientX-f.left)/c,b.deltaY,b)}}});this.drawer.on("scroll",function(b){a.params.partialRender&&a.drawBuffer();a.fireEvent("scroll",b)})}},{key:"ZoomifyValue",value:function(a){return(a*this.VisibleDuration+this.LeftProgress)/this.getDuration()}},{key:"UnZoomifyValue",value:function(a){return(a-this.LeftProgress)*this.ZoomFactor}},
{key:"UnzoomifyPixelValue",value:function(a){return(a-this.LeftProgress/this.getDuration()*this.drawer.width)*this.ZoomFactor}},{key:"DrawTemp",value:function(a,b){this.backend.extraPeaks=b;this.backend.extraOffset=a;this.drawBuffer(1);var c=this.backend.getPlayedPercents(),f=this.getDuration();f=this.LeftProgress/f;var d=(this.ActiveMarker-f)*this.ZoomFactor*100,e=d+"%";0===d&&(e="1px");this.drawer.CursorMarker.style.left=e;this.drawer.progress(c,f,this.ZoomFactor)}},{key:"ForceDraw",value:function(){this.drawBuffer();
var a=this.backend.getPlayedPercents(),b=this.getDuration();b=this.LeftProgress/b;var c=(this.ActiveMarker-b)*this.ZoomFactor*100,d=c+"%";0===c&&(d="1px");this.drawer.CursorMarker.style.left=d;this.drawer.progress(a,b,this.ZoomFactor)}},{key:"getWaveEl",value:function(){return this.drawer.canvases[0].wave}},{key:"createBackend",value:function(){var a=this;this.backend&&this.backend.destroy();"AudioElement"==this.params.backend&&(this.params.backend="MediaElement");"WebAudio"!=this.params.backend||
this.Backend.prototype.supportsWebAudio.call(null)||(this.params.backend="MediaElement");this.backend=new this.Backend(this.params);this.backend.init();this.fireEvent("backend-created",this.backend);this.backend.on("finish",function(){return a.fireEvent("finish")});this.backend.on("play",function(){return a.fireEvent("play")});this.backend.on("pause",function(b){"end"===b&&a.stop();return a.fireEvent("pause")});var b=this;this.CursorCenter=function(){var a=b.getDuration(),c=b.backend.getPlayedPercents(),
f=b.drawer.width*b.ZoomFactor,d=~~(b.drawer.width/2),e=c*f,g=e-d,h=b.LeftProgress/a*f+d>>0;g=h+d>e&&h+d<f?50<(c-b.LeftProgress/a)*b.ZoomFactor*100>>0?g-Math.max(0,g-h+d-4*b.ZoomFactor/2):Math.max(0,Math.min(f-2*d,g)):Math.max(0,Math.min(f-2*d,g));c=g/f;b.LeftProgress=c*a;b.fireEvent("cursorcenter",c);document.hidden||b.ForceDraw()};var c=0;b.backend.on("audioprocess",function(a){var f=b.backend.getPlayedPercents();if(1<b.ZoomFactor&&b.FollowCursor&&!b.Interacting){var d=window.performance.now();if(50<
d-c){c=d;d=b.getDuration();var e=b.drawer.width*b.ZoomFactor,g=~~(b.drawer.width/2),h=f*e,l=h-g,m=b.LeftProgress/d*e+g>>0;m<=h&&h<=m+g?(l=m+g>h&&m+g<e?99<(f-b.LeftProgress/d)*b.ZoomFactor*100>>0?l-Math.max(0,l-m+g-4*b.ZoomFactor/2):Math.max(0,Math.min(e-2*g,l)):Math.max(0,Math.min(e-2*g,l)),f=l/e,b.LeftProgress=f*d,b.fireEvent("cursorcenter",f),document.hidden||b.ForceDraw()):b.drawer.progress(f,b.LeftProgress/b.getDuration(),b.ZoomFactor)}}else b.drawer.progress(f,b.LeftProgress/b.getDuration(),
b.ZoomFactor);b.fireEvent("audioprocess",a)})}},{key:"createPeakCache",value:function(){this.params.partialRender&&(this.peakCache=new n["default"])}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(a){a>=this.getDuration()?this.seekTo(1):this.seekTo(a/this.getDuration())}},{key:"play",value:function(a,b){var c=this;this.fireEvent("interaction",function(){return c.play(a,
b)});return this.backend.play(a,b)}},{key:"pause",value:function(){if(!this.backend.isPaused())return this.backend.pause()}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(a){this.skip(-a||-this.params.skipLength)}},{key:"skipForward",value:function(a){this.skip(a||this.params.skipLength)}},{key:"skip",value:function(a){var b=this.getDuration()||1,c=this.getCurrentTime()||
0;c=Math.max(0,Math.min(b,c+(a||0)));this.seekAndCenter(c/b)}},{key:"seekAndCenter",value:function(a){this.seekTo(a);this.drawer.recenter(a)}},{key:"seekTo",value:function(a){var b=this;if("number"!==typeof a||!isFinite(a)||0>a||1<a)return console.error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!");this.ActiveMarker=a;this.fireEvent("interaction",function(){return b.seekTo(a)});var c=this.backend.isPaused();c||this.backend.pause();var d=this.getDuration();if(this.VisibleDuration/
d+this.LeftProgress/d>a&&a>this.LeftProgress/d){var e=this.LeftProgress/d;d=d/this.VisibleDuration*(a-e);this.drawer.CursorMarker.style.left=100*d+"%";this.drawer.progress(a,e,this.ZoomFactor)}else e=this.LeftProgress/d,d=d/this.VisibleDuration*(a-e),this.drawer.CursorMarker.style.left=0==d?"1px":100*d+"%",this.drawer.progress(0);this.backend.seekTo(a*this.getDuration());c||this.backend.play();this.fireEvent("seek",a)}},{key:"stop",value:function(){this.pause();this.seekTo(this.ActiveMarker);this.drawer.progress(this.ActiveMarker,
this.LeftProgress/this.getDuration(),this.ZoomFactor)}},{key:"setSinkId",value:function(a){return this.backend.setSinkId(a)}},{key:"setVolume",value:function(a){this.backend.setVolume(a);this.fireEvent("volume",a)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"getLoudness",value:function(){return this.backend.getLoudness()}},{key:"setPlaybackRate",value:function(a){this.backend.setPlaybackRate(a)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},
{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(a){a!==this.isMuted&&(a?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0,this.fireEvent("volume",0)):(this.backend.setVolume(this.savedVolume),this.isMuted=!1,this.fireEvent("volume",this.savedVolume)));this.fireEvent("mute",this.isMuted)}},{key:"getMute",value:function(){return this.isMuted}},{key:"isReady",value:function(){return this.isReady}},{key:"getFilters",value:function(){return this.backend.filters||
[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent;this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){return this.params.waveColor}},{key:"setWaveColor",value:function(a){this.params.waveColor=a;this.drawBuffer()}},{key:"getProgressColor",value:function(){return this.params.progressColor}},{key:"setProgressColor",value:function(a){this.params.progressColor=a;this.drawBuffer()}},
{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(a){this.params.cursorColor=a;this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(a){this.params.height=a;this.drawer.setHeight(a*this.params.pixelRatio);this.isReady&&this.drawBuffer()}},{key:"drawBuffer",value:function(a){this.VisibleDuration=1===this.ZoomFactor?this.getDuration():this.getDuration()/this.ZoomFactor;var b=
this.drawer.getWidth(),c=b*this.ZoomFactor>>0,d=void 0;d=this.backend.getPeaks(b,this.LeftProgress,c,a);this.drawer.drawPeaks(d,b,0,c,d.length,this.backend.shift);if(0<=this.backend.extraPeakStart){var e=this;requestAnimationFrame(function(){e.drawer.canvases[0].waveCtx.fillStyle="rgba(255,60,40,0.2)";e.drawer.canvases[0].waveCtx.fillRect(e.backend.extraPeakStart,0,e.backend.extraPeakEnd-e.backend.extraPeakStart,e.drawer.canvases[0].wave.height)})}this.fireEvent("redraw",d,b)}},{key:"zoom",value:function(a){}},
{key:"loadArrayBuffer",value:function(a){var b=this;this.decodeArrayBuffer(a,function(a){b.isDestroyed||b.loadDecodedBuffer(a)})}},{key:"loadDecodedBuffer",value:function(a){this.backend.splitPeaks=[];this.backend.mergedPeaks=[];this.createPeakCache();this.backend.load(a);this.drawBuffer(1);this.fireEvent("ready");this.isReady=!0}},{key:"loadBlob",value:function(a){var b=this,c=new FileReader;c.addEventListener("progress",function(a){return b.onProgress(a)});c.addEventListener("load",function(a){return b.loadArrayBuffer(a.target.result)});
c.addEventListener("error",function(){return b.fireEvent("error","Error reading file")});c.readAsArrayBuffer(a);this.empty()}},{key:"load",value:function(a,b,c,d){this.empty();if(c){var e={"Preload is not 'auto', 'none' or 'metadata'":-1===["auto","metadata","none"].indexOf(c),"Peaks are not provided":!b,"Backend is not of type MediaElement":"MediaElement"!==this.params.backend,"Url is not of type string":"string"!==typeof a},f=Object.keys(e).filter(function(a){return e[a]});f.length&&(console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- "+
f.join("\n\t- ")),c=null)}switch(this.params.backend){case "WebAudio":return this.loadBuffer(a,b,d);case "MediaElement":return this.loadMediaElement(a,b,c,d)}}},{key:"loadBuffer",value:function(a,b,c){var d=this,e=function(b){b&&d.tmpEvents.push(d.once("ready",b));return d.getArrayBuffer(a,function(a){return d.loadArrayBuffer(a)})};if(b)this.backend.setPeaks(b,c),this.drawBuffer(1),this.tmpEvents.push(this.once("interaction",e));else return e()}},{key:"loadMediaElement",value:function(a,b,c,d){var e=
this;debugger;var f=a;"string"===typeof a?this.backend.load(f,this.mediaContainer,b,c):(this.backend.loadElt(a,b),f=a.src);this.tmpEvents.push(this.backend.once("canplay",function(){e.drawBuffer(1);e.fireEvent("ready");e.isReady=!0}),this.backend.once("error",function(a){return e.fireEvent("error",a)}));b&&this.backend.setPeaks(b,d);b&&!this.params.forceDecode||!this.backend.supportsWebAudio()||this.getArrayBuffer(f,function(a){e.decodeArrayBuffer(a,function(a){e.backend.buffer=a;e.backend.setPeaks(null);
e.drawBuffer(1);e.fireEvent("waveform-ready")})})}},{key:"decodeArrayBuffer",value:function(a,b){var c=this,d="q"+(999999*Math.random()>>0);this.bid[d]=1;this.bid.curr=d;this.backend.decodeArrayBuffer(a,function(e){!c.isDestroyed&&c.bid[d]&&(b(e),c.arraybuffer=a)},function(){return c.fireEvent("error","Error decoding audiobuffer. Did you make sure to supply a valid audio file? ")})}},{key:"getArrayBuffer",value:function(a,b){var d=this,e=c.ajax({url:a,responseType:"arraybuffer",xhr:this.params.xhr});
this.currentAjax=e;this.tmpEvents.push(e.on("progress",function(a){d.onProgress(a)}),e.on("success",function(a,c){b(a);d.currentAjax=null}),e.on("error",function(a){d.fireEvent("error","Could not load remote URL. Make sure the url exists, is a valid audio file,<br />  or that is supports Cross Origin requests (Access-Control-Allow-Origin header) <br />"+a.target.statusText);d.currentAjax=null}));return e}},{key:"onProgress",value:function(a){this.fireEvent("loading",Math.round(100*(a.lengthComputable?
a.loaded/a.total:a.loaded/(a.loaded+1E6))),a.target)}},{key:"exportPCM",value:function(a,b,c,d){b=b||1E4;c=c||!1;a=this.backend.getPeaks(a||1024,d||0);a=[].map.call(a,function(a){return Math.round(a*b)/b});a=JSON.stringify(a);c||window.open("data:application/json;charset=utf-8,"+encodeURIComponent(a));return a}},{key:"exportImage",value:function(a,b){a||(a="image/png");b||(b=1);return this.drawer.getImage(a,b)}},{key:"cancelBufferLoad",value:function(){return this.bid&&this.bid.curr?(this.bid[this.bid.curr]=
null,!0):!1}},{key:"cancelAjax",value:function(){return this.currentAjax?(this.currentAjax.xhr.abort(),this.currentAjax=null,!0):!1}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach(function(a){return a.un()})}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource());this.cancelAjax();this.clearTmpEvents();this.drawer.progress(0);this.drawer.setWidth(0);this.drawer.drawPeaks({length:this.drawer.getWidth()},0,2)}},{key:"destroy",value:function(){this.destroyAllPlugins();
this.fireEvent("destroy");this.cancelAjax();this.clearTmpEvents();this.unAll();!1!==this.params.responsive&&(window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0));this.backend.destroy();this.drawer.destroy();this.isDestroyed=!0;this.arraybuffer=null}}]);return d}(c.Observer);e.util=c;b["default"]=e;Array.prototype.copyWithin||(Array.prototype.copyWithin=function(a,b,c){if(null==this)throw new TypeError("this is null or not defined");
var d=Object(this),e=d.length>>>0;a>>=0;a=0>a?Math.max(e+a,0):Math.min(a,e);b>>=0;b=0>b?Math.max(e+b,0):Math.min(b,e);c=void 0===c?e:c>>0;e=Math.min((0>c?Math.max(e+c,0):Math.min(c,e))-b,e-a);c=1;b<a&&a<b+e&&(c=-1,b+=e-1,a+=e-1);for(;0<e;)b in d?d[a]=d[b]:delete d[a],b+=c,a+=c,e--;return d});k.exports=b["default"]},"./src/webaudio.js":function(k,b,e){function h(b,d,a){d in b?Object.defineProperty(b,d,{value:a,enumerable:!0,configurable:!0,writable:!0}):b[d]=a;return b}function u(b,d){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!d||"object"!==typeof d&&"function"!==typeof d?b:d}function t(b,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);b.prototype=Object.create(d&&d.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(b,d):b.__proto__=d)}Object.defineProperty(b,"__esModule",{value:!0});var p=function(){function b(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=
d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(c,a,e){a&&b(c.prototype,a);e&&b(c,e);return c}}();e=function(b){if(b&&b.__esModule)return b;var c={};if(null!=b)for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&(c[a]=b[a]);c["default"]=b;return c}(e("./src/util/index.js"));var q=-1<navigator.userAgent.toLowerCase().indexOf("safari/");e=function(b){function c(a){var b,e;if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");
var d=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));d.audioContext=null;d.offlineAudioContext=null;d.stateBehaviors=(b={},h(b,"playing",{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var a=this.getDuration();return this.getCurrentTime()/a||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),h(b,"paused",{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var a=this.getDuration();return this.getCurrentTime()/a||
0},getCurrentTime:function(){return this.startPosition}}),h(b,"finished",{init:function(){this.removeOnAudioProcess();this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),b);d.params=a;d.ac=a.audioContext||d.getAudioContext();d.lastPlay=d.ac.currentTime;d.startPosition=0;d.scheduledPause=null;d.states=(e={},h(e,"playing",Object.create(d.stateBehaviors.playing)),h(e,"paused",Object.create(d.stateBehaviors.paused)),h(e,"finished",Object.create(d.stateBehaviors.finished)),
e);d.analyser=null;d.buffer=null;d.filters=[];d.gainNode1=null;d.gainNode2=null;d.splitterNode=null;d.mergedPeaks=null;d.offlineAc=null;d.peaks=null;d.playbackRate=1;d.analyser=null;d.scriptNode=null;d.source=null;d.splitPeaks=[];d.state=null;d.explicitDuration=null;d.FreqArr=new Uint8Array(512);return d}t(c,b);p(c,[{key:"supportsWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"getAudioContext",value:function(){window.WaveSurferAudioContext||(window.WaveSurferAudioContext=
new (window.AudioContext||window.webkitAudioContext));return window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(a){window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new (window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,a));return window.WaveSurferOfflineAudioContext}}]);p(c,[{key:"init",value:function(){this.createVolumeNode();this.createScriptNode();this.createAnalyserNode();this.setState("paused");this.setPlaybackRate(this.params.audioRate);
this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach(function(a){a&&a.disconnect()}),this.filters=null,this.analyser.connect(this.mergerNode))}},{key:"setState",value:function(a){this.state!==this.states[a]&&(this.state=this.states[a],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.setFilters(b)}},{key:"setFilters",value:function(a){this.disconnectFilters();a&&a.length&&
(this.filters=a,this.analyser.disconnect(),a.reduce(function(a,b){a.connect(b);return b},this.analyser).connect(this.gainNode1))}},{key:"createScriptNode",value:function(){this.scriptNode=this.ac.createScriptProcessor?this.ac.createScriptProcessor(c.scriptBufferSize):this.ac.createJavaScriptNode(c.scriptBufferSize);this.scriptNode.connect(this.ac.destination)}},{key:"addOnAudioProcess",value:function(){var a=this;this.scriptNode.onaudioprocess=function(){if(a.states.playing){for(var b=a.getCurrentTime(),
c=a.buffer,d=b*c.sampleRate>>0,e=[0,0],h,f=0;f<c.numberOfChannels;++f){h=0;for(var k=c.getChannelData(f),p=0;512>p;p+=2){var r=k[d+p];Math.abs(r)>=h&&(h=Math.abs(r))}e[f]=20*Math.log10(h)+.001}a.peak_frequency=e;a.logFrequencies&&a.analyser.getByteFrequencyData(a.FreqArr);b>=a.getDuration()?(a.setState("finished"),a.states.playing=null,a.fireEvent("pause","end")):b>=a.scheduledPause?a.pause():a.state===a.states.playing&&a.fireEvent("audioprocess",b);a.peak_frequency=null}}}},{key:"removeOnAudioProcess",
value:function(){q||(this.scriptNode.onaudioprocess=null)}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser();this.analyser.fftSize=1024;this.analyser.connect(this.splitterNode)}},{key:"SetNumberOfChannels",value:function(a){this.splitterNode.disconnect(0);this.splitterNode.disconnect(1);1===a?(this.splitterNode.connect(this.gainNode1,0),this.splitterNode.connect(this.gainNode2,0)):2===a&&(this.splitterNode.connect(this.gainNode1,1),this.splitterNode.connect(this.gainNode2,
0))}},{key:"createVolumeNode",value:function(){this.splitterNode=this.ac.createChannelSplitter(2);this.mergerNode=this.ac.createChannelMerger(2);this.ac.createGain?(this.gainNode1=this.ac.createGain(),this.gainNode2=this.ac.createGain()):(this.gainNode1=this.ac.createGainNode(),this.gainNode2=this.ac.createGainNode());this.splitterNode.connect(this.gainNode1,1);this.splitterNode.connect(this.gainNode2,0);this.gainNode1.connect(this.mergerNode,0,1);this.gainNode2.connect(this.mergerNode,0,0);this.mergerNode.connect(this.ac.destination)}},
{key:"setSinkId",value:function(a){if(a){var b=new window.Audio;if(!b.setSinkId)return Promise.reject(Error("setSinkId is not supported in your browser"));b.autoplay=!0;var c=this.ac.createMediaStreamDestination();debugger;this.gainNode1.disconnect();this.gainNode1.connect(c);this.gainNode2.disconnect();this.gainNode2.connect(c);this.mergerNode.disconnect();this.mergerNode.connect(c);this.splitterNode.disconnect();this.splitterNode.connect(c);b.src=URL.createObjectURL(c.stream);return b.setSinkId(a)}return Promise.reject(Error("Invalid deviceId: "+
a))}},{key:"setVolume",value:function(a){this.gainNode1.gain.setValueAtTime(a,this.ac.currentTime);this.gainNode2.gain.setValueAtTime(a,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode1.gain.value}},{key:"getLoudness",value:function(){return this.peak_frequency}},{key:"decodeArrayBuffer",value:function(a,b,c){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac?this.ac.sampleRate:44100));(a=this.offlineAc.decodeAudioData(a,function(a){return b(a)},c))&&
a["catch"](function(a){console.log("couldn't load audio")})}},{key:"setPeaks",value:function(a,b){this.explicitDuration=b;this.peaks=a}},{key:"setLength",value:function(a){if(!this.mergedPeaks||2*a!=this.mergedPeaks.length){this.splitPeaks=[];this.mergedPeaks=[];var b=this.buffer?this.buffer.numberOfChannels:1,c;for(c=0;c<b;c++)this.splitPeaks[c]=[],this.splitPeaks[c][2*(a-1)]=0,this.splitPeaks[c][2*(a-1)+1]=0;this.mergedPeaks[2*(a-1)]=0;this.mergedPeaks[2*(a-1)+1]=0}}},{key:"getPeaks",value:function(a,
b,c,d){b*=this.buffer.sampleRate;c=c||a-1;this.setLength(a);this.buffer.length||(this.buffer=this.createBuffer(1,4096,this.sampleRate).buffer);var e=this.buffer.length/c,g=~~(e/10)||1;32<g&&(g=32);6>g&&(g=6);var f=this.buffer.numberOfChannels,h=0;this.shift=0;if(this.splitPeaks&&!d&&c==this.peaksEnd){var k=(this.peaksStart-b)/e;if(0===k)return this.shift=999999999,this.splitPeaks;k=Math.round(k);this.shift=k*=2;for(d=0;d<f;++d){var l=this.splitPeaks[d];if(0>k)this.splitPeaks[d]=l.slice(-k),h=a+k;
else if(0<k)l.copyWithin(k,0,l.length-k),a=k/2>>0;else return this.splitPeaks}}for(d=0;d<f;++d){l=this.splitPeaks[d];var p=this.buffer.getChannelData(d);for(k=h;k<=a;++k){for(var n=b+k*e>>0,q=n+e>>0,t=0,u=0;n<q;n+=g){var x=p[n];x>u?u=x:x<t&&(t=x)}l[2*k]=u;l[2*k+1]=t}}this.extraPeakEnd=this.extraPeakStart=-1;if(this.extraPeaks&&(a=this.extraOffset/e>>0,b<=this.extraOffset&&c>a)){a=(this.extraOffset-b)/e>>0;h=this.extraPeaks.length;p=this.extraPeaks[0].length;var z=a+p*h/e>>0;this.extraPeakStart=a;
this.extraPeakEnd=z;for(d=0;d<f;++d){l=this.splitPeaks[d];this.buffer.getChannelData(d);var A=0;for(k=a;k<=z;++k){n=A*e>>0;q=n+e>>0;u=t=0;for(++A;n<q;n+=g){x=n/p;if(x>=h)break;x=this.extraPeaks[x>>0][n%p];x>u&&(u=x);x<t&&(t=x)}l[2*k]=u;l[2*k+1]=t}}}this.peaksStart=b;this.peaksEnd=c;return this.splitPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroy",value:function(){this.isPaused()||
this.pause();this.unAll();this.buffer=null;this.disconnectFilters();this.disconnectSource();this.gainNode1.disconnect();this.gainNode2.disconnect();this.mergerNode.disconnect();this.splitterNode.disconnect();this.scriptNode.disconnect();this.analyser.disconnect();this.params.closeAudioContext&&("function"===typeof this.ac.close&&"closed"!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=
null)}},{key:"load",value:function(a){this.lastPlay=this.ac.currentTime;this.buffer=a;this.peaks=null;this.createSource();this.source.start(0,0,0);this.source.stop(0);this.createSource()}},{key:"createSource",value:function(){this.disconnectSource();this.source=this.ac.createBufferSource();this.source.start=this.source.start||this.source.noteGrainOn;this.source.stop=this.source.stop||this.source.noteOff;this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime);this.source.buffer=
this.buffer;this.source.connect(this.analyser)}},{key:"isPaused",value:function(){return this.state!==this.states.playing}},{key:"getDuration",value:function(){return this.buffer?this.buffer.duration:this.explicitDuration?this.explicitDuration:0}},{key:"seekTo",value:function(a,b){if(this.buffer)return this.scheduledPause=null,null==a&&(a=this.getCurrentTime(),a>=this.getDuration()&&(a=0)),null==b&&(b=this.getDuration()),this.startPosition=a,this.lastPlay=this.ac.currentTime,this.state===this.states.finished&&
this.setState("paused"),{start:a,end:b}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(a,b){if(this.buffer){this.createSource();var c=this.seekTo(a,b);a=c.start;this.scheduledPause=b=c.end;this.source.start(0,a,b-a);"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume();this.states.playing||h(this.states,"playing",Object.create(this.stateBehaviors.playing));this.setState("playing");this.fireEvent("play")}}},{key:"pause",
value:function(){this.state!==this.states.paused&&(this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState("paused"),this.fireEvent("pause"))}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(a){a=a||1;this.isPaused()?this.playbackRate=a:(this.pause(),this.playbackRate=a,this.play())}}]);return c}(e.Observer);
e.scriptBufferSize=256;b["default"]=e;k.exports=b["default"]}})});